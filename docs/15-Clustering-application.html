<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 15 Clustering : application sur le RP 2018 | DATA MINING</title>
  <meta name="description" content="Titre du cours" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 15 Clustering : application sur le RP 2018 | DATA MINING" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Titre du cours" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 15 Clustering : application sur le RP 2018 | DATA MINING" />
  
  <meta name="twitter:description" content="Titre du cours" />
  

<meta name="author" content="Camille Signoretto, Maîtresse de conférences en économie, Université Paris Cité" />


<meta name="date" content="2023-02-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="14-Clustering-theorique.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


<link rel="stylesheet" href="css/tidyverse.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Mining :  <em>Camille Signoretto</em></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html"><i class="fa fa-check"></i>Présentation</a>
<ul>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#à-propos-de-ce-document"><i class="fa fa-check"></i>À propos de ce document</a></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#prérequis"><i class="fa fa-check"></i>Prérequis</a></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#remerciements"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#licence"><i class="fa fa-check"></i>Licence</a></li>
</ul></li>
<li class="part"><span><b>Séance 1 : Data Wrangling</b></span></li>
<li class="chapter" data-level="1" data-path="01-Jeu-de-donnees.html"><a href="01-Jeu-de-donnees.html"><i class="fa fa-check"></i><b>1</b> Récupération du jeu de données sur une API</a></li>
<li class="chapter" data-level="2" data-path="02-Manipulation-base.html"><a href="02-Manipulation-base.html"><i class="fa fa-check"></i><b>2</b> Manipulation de la base</a>
<ul>
<li class="chapter" data-level="2.1" data-path="02-Manipulation-base.html"><a href="02-Manipulation-base.html#format-des-données---wide-ou-long"><i class="fa fa-check"></i><b>2.1</b> Format des données - WIDE ou LONG</a></li>
<li class="chapter" data-level="2.2" data-path="02-Manipulation-base.html"><a href="02-Manipulation-base.html#séparer-les-variables-séparer-les-données"><i class="fa fa-check"></i><b>2.2</b> Séparer les variables, séparer les données</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html"><i class="fa fa-check"></i><b>3</b> Manipulation des variables</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#manipulation-des-variables-qualitatives"><i class="fa fa-check"></i><b>3.1</b> Manipulation des variables qualitatives</a></li>
<li class="chapter" data-level="3.2" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#manipulation-des-variables-quantitatives"><i class="fa fa-check"></i><b>3.2</b> Manipulation des variables quantitatives</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#détecter-et-visualiser-les-valeurs-manquantes"><i class="fa fa-check"></i><b>3.2.1</b> Détecter et “visualiser” les valeurs manquantes</a></li>
<li class="chapter" data-level="3.2.2" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#gérer-les-valeurs-manquantes"><i class="fa fa-check"></i><b>3.2.2</b> Gérer les valeurs manquantes</a></li>
<li class="chapter" data-level="3.2.3" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#détecter-et-visualiser-les-valeurs-aberrantes"><i class="fa fa-check"></i><b>3.2.3</b> Détecter et “visualiser” les valeurs aberrantes</a></li>
<li class="chapter" data-level="3.2.4" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#découper-en-classes-une-variable-quantitative"><i class="fa fa-check"></i><b>3.2.4</b> Découper en classes une variable quantitative</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-Enregistrement-tables-donnees.html"><a href="04-Enregistrement-tables-donnees.html"><i class="fa fa-check"></i><b>4</b> Enregistrement des tables</a></li>
<li class="part"><span><b>Séance 2 : Data Mining - Analyse descriptive</b></span></li>
<li class="chapter" data-level="5" data-path="05-Questions-fouille-donnees.html"><a href="05-Questions-fouille-donnees.html"><i class="fa fa-check"></i><b>5</b> Quelles questions intéressantes pour une “fouille de données” sur cette base ?</a>
<ul>
<li class="chapter" data-level="5.1" data-path="05-Questions-fouille-donnees.html"><a href="05-Questions-fouille-donnees.html#caractéristiques-de-la-cohorte-des-bacheliers-2014-inscrits-en-première-année-de-licence-en-2014-2015"><i class="fa fa-check"></i><b>5.1</b> Caractéristiques de la cohorte des bacheliers 2014 inscrits en première année de licence en 2014-2015</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06-Fonctions.html"><a href="06-Fonctions.html"><i class="fa fa-check"></i><b>6</b> Systématiser nos procédures : construire une fonction</a></li>
<li class="chapter" data-level="7" data-path="07-Analyse-descriptive.html"><a href="07-Analyse-descriptive.html"><i class="fa fa-check"></i><b>7</b> (reprise de l’)Analyse descriptive</a>
<ul>
<li class="chapter" data-level="7.1" data-path="07-Analyse-descriptive.html"><a href="07-Analyse-descriptive.html#caractéristiques-de-la-cohorte-des-bacheliers-2014-inscrits-en-première-année-de-licence-en-2014-2015-1"><i class="fa fa-check"></i><b>7.1</b> Caractéristiques de la cohorte des bacheliers 2014 inscrits en première année de licence en 2014-2015</a></li>
<li class="chapter" data-level="7.2" data-path="07-Analyse-descriptive.html"><a href="07-Analyse-descriptive.html#profils-des-étudiants-selon-leur-situation-en-fin-de-l1"><i class="fa fa-check"></i><b>7.2</b> Profils des étudiants selon leur situation en fin de L1</a></li>
</ul></li>
<li class="part"><span><b>Séance 3 : Introduction à ShinyApp</b></span></li>
<li class="chapter" data-level="8" data-path="08-Intro-a-Shiny-theorique.html"><a href="08-Intro-a-Shiny-theorique.html"><i class="fa fa-check"></i><b>8</b> Les applications interactives avec Shiny App</a>
<ul>
<li class="chapter" data-level="8.1" data-path="08-Intro-a-Shiny-theorique.html"><a href="08-Intro-a-Shiny-theorique.html#la-structure-générale-dune-application-shiny"><i class="fa fa-check"></i><b>8.1</b> La structure générale d’une application Shiny</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="08-Intro-a-Shiny-theorique.html"><a href="08-Intro-a-Shiny-theorique.html#la-partie-ui"><i class="fa fa-check"></i><b>8.1.1</b> La partie “UI”</a></li>
<li class="chapter" data-level="8.1.2" data-path="08-Intro-a-Shiny-theorique.html"><a href="08-Intro-a-Shiny-theorique.html#la-partie-server"><i class="fa fa-check"></i><b>8.1.2</b> La partie “Server”</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="08-Intro-a-Shiny-theorique.html"><a href="08-Intro-a-Shiny-theorique.html#la-réactivité"><i class="fa fa-check"></i><b>8.2</b> La réactivité</a></li>
<li class="chapter" data-level="8.3" data-path="08-Intro-a-Shiny-theorique.html"><a href="08-Intro-a-Shiny-theorique.html#un-exemple-avec-le-code-du-script-par-défaut"><i class="fa fa-check"></i><b>8.3</b> Un exemple avec le code du script par défaut</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09-Intro-a-Shiny-exemples.html"><a href="09-Intro-a-Shiny-exemples.html"><i class="fa fa-check"></i><b>9</b> La création d’une application Shiny “pas à pas” avec l’une de nos bases de données</a>
<ul>
<li class="chapter" data-level="9.1" data-path="09-Intro-a-Shiny-exemples.html"><a href="09-Intro-a-Shiny-exemples.html#application-vide"><i class="fa fa-check"></i><b>9.1</b> Application vide</a></li>
<li class="chapter" data-level="9.2" data-path="09-Intro-a-Shiny-exemples.html"><a href="09-Intro-a-Shiny-exemples.html#ajout-dun-titre-et-dun-widget"><i class="fa fa-check"></i><b>9.2</b> Ajout d’un titre et d’un widget</a></li>
<li class="chapter" data-level="9.3" data-path="09-Intro-a-Shiny-exemples.html"><a href="09-Intro-a-Shiny-exemples.html#ajout-dun-graphique"><i class="fa fa-check"></i><b>9.3</b> Ajout d’un graphique</a></li>
<li class="chapter" data-level="9.4" data-path="09-Intro-a-Shiny-exemples.html"><a href="09-Intro-a-Shiny-exemples.html#modification-du-graphique-filtrer-selon-une-variable"><i class="fa fa-check"></i><b>9.4</b> Modification du graphique : filtrer selon une variable</a></li>
<li class="chapter" data-level="9.5" data-path="09-Intro-a-Shiny-exemples.html"><a href="09-Intro-a-Shiny-exemples.html#modification-du-graphique-selon-une-variable-au-choix-parmi-deux"><i class="fa fa-check"></i><b>9.5</b> Modification du graphique : selon une variable au choix parmi deux</a></li>
</ul></li>
<li class="part"><span><b>Séances 4 et 5 : Data Visualization</b></span></li>
<li class="chapter" data-level="10" data-path="10-Ggplot-theorique.html"><a href="10-Ggplot-theorique.html"><i class="fa fa-check"></i><b>10</b> Data Visualization et Ggplot2 : aspects théoriques</a>
<ul>
<li class="chapter" data-level="10.1" data-path="10-Ggplot-theorique.html"><a href="10-Ggplot-theorique.html#présentation-générale-de-ggplot2"><i class="fa fa-check"></i><b>10.1</b> Présentation générale de Ggplot2</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="10-Ggplot-theorique.html"><a href="10-Ggplot-theorique.html#les-aesthetics-ou-arguments-esthétiques"><i class="fa fa-check"></i><b>10.1.1</b> Les “aesthetics” ou arguments esthétiques</a></li>
<li class="chapter" data-level="10.1.2" data-path="10-Ggplot-theorique.html"><a href="10-Ggplot-theorique.html#les-géométries"><i class="fa fa-check"></i><b>10.1.2</b> Les géométries</a></li>
<li class="chapter" data-level="10.1.3" data-path="10-Ggplot-theorique.html"><a href="10-Ggplot-theorique.html#les-facettes"><i class="fa fa-check"></i><b>10.1.3</b> Les facettes</a></li>
<li class="chapter" data-level="10.1.4" data-path="10-Ggplot-theorique.html"><a href="10-Ggplot-theorique.html#les-statistiques"><i class="fa fa-check"></i><b>10.1.4</b> Les statistiques</a></li>
<li class="chapter" data-level="10.1.5" data-path="10-Ggplot-theorique.html"><a href="10-Ggplot-theorique.html#les-coordonnées"><i class="fa fa-check"></i><b>10.1.5</b> Les coordonnées</a></li>
<li class="chapter" data-level="10.1.6" data-path="10-Ggplot-theorique.html"><a href="10-Ggplot-theorique.html#les-thèmes"><i class="fa fa-check"></i><b>10.1.6</b> Les thèmes</a></li>
<li class="chapter" data-level="10.1.7" data-path="10-Ggplot-theorique.html"><a href="10-Ggplot-theorique.html#les-autres-options-graphiques-titres-échelles-des-axes-etc."><i class="fa fa-check"></i><b>10.1.7</b> Les autres options graphiques : titres, échelles des axes, etc.</a></li>
<li class="chapter" data-level="10.1.8" data-path="10-Ggplot-theorique.html"><a href="10-Ggplot-theorique.html#code-minimal"><i class="fa fa-check"></i><b>10.1.8</b> Code minimal</a></li>
<li class="chapter" data-level="10.1.9" data-path="10-Ggplot-theorique.html"><a href="10-Ggplot-theorique.html#liens-utiles-pour-aller-plus-loin"><i class="fa fa-check"></i><b>10.1.9</b> Liens utiles pour aller plus loin</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="10-Ggplot-theorique.html"><a href="10-Ggplot-theorique.html#les-grands-principes-de-data-visualization"><i class="fa fa-check"></i><b>10.2</b> Les grands principes de data visualization</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-Ggplot-pratique.html"><a href="11-Ggplot-pratique.html"><i class="fa fa-check"></i><b>11</b> Le package Ggplot en pratiques</a>
<ul>
<li class="chapter" data-level="11.1" data-path="11-Ggplot-pratique.html"><a href="11-Ggplot-pratique.html#exemple-de-la-construction-dun-graphique-pas-à-pas"><i class="fa fa-check"></i><b>11.1</b> Exemple de la construction d’un graphique pas à pas</a></li>
<li class="chapter" data-level="11.2" data-path="11-Ggplot-pratique.html"><a href="11-Ggplot-pratique.html#dautres-exemples-à-travers-des-exercices"><i class="fa fa-check"></i><b>11.2</b> D’autres exemples à travers des exercices</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="11-Ggplot-pratique.html"><a href="11-Ggplot-pratique.html#distribution-du-montant-total-des-aides-financières-par-secteur-dactivité"><i class="fa fa-check"></i><b>11.2.1</b> Distribution du montant total des aides financières, par secteur d’activité</a></li>
<li class="chapter" data-level="11.2.2" data-path="11-Ggplot-pratique.html"><a href="11-Ggplot-pratique.html#comparaison-des-montants-moyen-et-médian-des-aides-financières-par-région"><i class="fa fa-check"></i><b>11.2.2</b> Comparaison des montants moyen et médian des aides financières, par région</a></li>
<li class="chapter" data-level="11.2.3" data-path="11-Ggplot-pratique.html"><a href="11-Ggplot-pratique.html#lien-entre-le-montant-moyen-des-aides-versées-et-le-nombre-moyen-dentreprises-bénéficiaires-par-secteur-dactivité-puis-par-région"><i class="fa fa-check"></i><b>11.2.3</b> Lien entre le montant moyen des aides versées et le nombre moyen d’entreprises bénéficiaires, par secteur d’activité puis par région</a></li>
<li class="chapter" data-level="11.2.4" data-path="11-Ggplot-pratique.html"><a href="11-Ggplot-pratique.html#montant-moyen-des-aides-versées-par-entreprise-dans-chaque-région-ou-chaque-secteur-dactivité"><i class="fa fa-check"></i><b>11.2.4</b> Montant moyen des aides versées par entreprise dans chaque région ou chaque secteur d’activité</a></li>
<li class="chapter" data-level="11.2.5" data-path="11-Ggplot-pratique.html"><a href="11-Ggplot-pratique.html#top-5-des-aides-financières-versées-selon-la-région-ou-le-secteur-dactivité"><i class="fa fa-check"></i><b>11.2.5</b> Top 5 des aides financières versées selon la région ou le secteur d’activité</a></li>
<li class="chapter" data-level="11.2.6" data-path="11-Ggplot-pratique.html"><a href="11-Ggplot-pratique.html#à-vous-de-jouer"><i class="fa fa-check"></i><b>11.2.6</b> À vous de “jouer” !</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-Retour-sur-Shiny.html"><a href="12-Retour-sur-Shiny.html"><i class="fa fa-check"></i><b>12</b> Application sur Shiny</a>
<ul>
<li class="chapter" data-level="12.1" data-path="12-Retour-sur-Shiny.html"><a href="12-Retour-sur-Shiny.html#application-avec-un-tableau-et-un-graphique"><i class="fa fa-check"></i><b>12.1</b> Application avec un tableau et un graphique</a></li>
<li class="chapter" data-level="12.2" data-path="12-Retour-sur-Shiny.html"><a href="12-Retour-sur-Shiny.html#introduction-dune-réactivité-appliquée-à-la-table-de-données"><i class="fa fa-check"></i><b>12.2</b> Introduction d’une réactivité appliquée à la table de données</a></li>
<li class="chapter" data-level="12.3" data-path="12-Retour-sur-Shiny.html"><a href="12-Retour-sur-Shiny.html#introduction-dune-réactivité-sur-les-inputs-sans-changer-les-outputs-contexte-réactif"><i class="fa fa-check"></i><b>12.3</b> Introduction d’une réactivité sur les inputs sans changer les outputs (contexte réactif)</a></li>
<li class="chapter" data-level="12.4" data-path="12-Retour-sur-Shiny.html"><a href="12-Retour-sur-Shiny.html#introduction-dune-réactivité-sur-les-inputs-et-les-outputs"><i class="fa fa-check"></i><b>12.4</b> Introduction d’une réactivité sur les inputs ET les outputs</a></li>
</ul></li>
<li class="part"><span><b>Séances 6 et 7 : Clustering</b></span></li>
<li class="chapter" data-level="13" data-path="13-Base-individus-RP.html"><a href="13-Base-individus-RP.html"><i class="fa fa-check"></i><b>13</b> Nouvelle base de données individuelles à prendre en main : le RP 2018</a>
<ul>
<li class="chapter" data-level="13.1" data-path="13-Base-individus-RP.html"><a href="13-Base-individus-RP.html#les-données-du-recensement-de-la-population-rp"><i class="fa fa-check"></i><b>13.1</b> Les données du Recensement de la Population (RP)</a></li>
<li class="chapter" data-level="13.2" data-path="13-Base-individus-RP.html"><a href="13-Base-individus-RP.html#prise-en-main-rapide"><i class="fa fa-check"></i><b>13.2</b> Prise en main rapide</a></li>
<li class="chapter" data-level="13.3" data-path="13-Base-individus-RP.html"><a href="13-Base-individus-RP.html#tableaux-de-contingence-par-iris-découpage-territorial-infracommunal"><i class="fa fa-check"></i><b>13.3</b> Tableaux de contingence par IRIS (découpage territorial infracommunal)</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="14-Clustering-theorique.html"><a href="14-Clustering-theorique.html"><i class="fa fa-check"></i><b>14</b> Clustering : aspects théoriques</a>
<ul>
<li class="chapter" data-level="14.1" data-path="14-Clustering-theorique.html"><a href="14-Clustering-theorique.html#la-classification-ascendante-hiérarchique-cah"><i class="fa fa-check"></i><b>14.1</b> La classification ascendante hiérarchique (CAH)</a></li>
<li class="chapter" data-level="14.2" data-path="14-Clustering-theorique.html"><a href="14-Clustering-theorique.html#la-méthode-des-centres-mobiles-et-sa-variante-les-k-means"><i class="fa fa-check"></i><b>14.2</b> La méthode des centres mobiles et sa variante, <em>les K-means</em></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="15-Clustering-application.html"><a href="15-Clustering-application.html"><i class="fa fa-check"></i><b>15</b> Clustering : application sur le RP 2018</a>
<ul>
<li class="chapter" data-level="15.1" data-path="15-Clustering-application.html"><a href="15-Clustering-application.html#choix-des-variables-et-préparation-du-tableau-final"><i class="fa fa-check"></i><b>15.1</b> Choix des variables et préparation du tableau final</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="15-Clustering-application.html"><a href="15-Clustering-application.html#variables-socio-professionnelles-caractérisant-les-individushabitants-de-notre-commune"><i class="fa fa-check"></i><b>15.1.1</b> Variables socio-professionnelles caractérisant les individus/habitants de notre commune</a></li>
<li class="chapter" data-level="15.1.2" data-path="15-Clustering-application.html"><a href="15-Clustering-application.html#création-des-différents-tableaux-de-contingence"><i class="fa fa-check"></i><b>15.1.2</b> Création des différents tableaux de contingence</a></li>
<li class="chapter" data-level="15.1.3" data-path="15-Clustering-application.html"><a href="15-Clustering-application.html#création-du-tableau-final"><i class="fa fa-check"></i><b>15.1.3</b> Création du tableau final</a></li>
<li class="chapter" data-level="15.1.4" data-path="15-Clustering-application.html"><a href="15-Clustering-application.html#choix-des-variables-actives-dans-le-clustering"><i class="fa fa-check"></i><b>15.1.4</b> choix des variables actives dans le clustering</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="15-Clustering-application.html"><a href="15-Clustering-application.html#la-méthode-de-la-cah-appliquée-à-nos-données"><i class="fa fa-check"></i><b>15.2</b> La méthode de la CAH appliquée à nos données</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="15-Clustering-application.html"><a href="15-Clustering-application.html#constitution-des-classes"><i class="fa fa-check"></i><b>15.2.1</b> Constitution des classes</a></li>
<li class="chapter" data-level="15.2.2" data-path="15-Clustering-application.html"><a href="15-Clustering-application.html#visualisation-sur-la-carte-de-la-commune"><i class="fa fa-check"></i><b>15.2.2</b> Visualisation sur la carte de la commune</a></li>
<li class="chapter" data-level="15.2.3" data-path="15-Clustering-application.html"><a href="15-Clustering-application.html#interprétation"><i class="fa fa-check"></i><b>15.2.3</b> Interprétation</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DATA MINING</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="c15-Clustering-application" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">Section 15</span> Clustering : application sur le RP 2018<a href="15-Clustering-application.html#c15-Clustering-application" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div align="justify">

<div id="choix-des-variables-et-préparation-du-tableau-final" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Choix des variables et préparation du tableau final<a href="15-Clustering-application.html#choix-des-variables-et-préparation-du-tableau-final" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Notre objectif est ici de décrire une commune ou un groupe de communes, en rassemblant des zones infracommunales (IRIS) qui se ressemblent ou sont relativement homogènes, c’est-à-dire qui ont des caractéristiques proches. Mais, bien sûr, les méthodes de clustering peuvent être appliquées à toutes sortes de problématiques et de données.<br />
Il faut ainsi d’abord réfléchir à quelles caractéristiques on veut s’intéresser, c’est-à-dire quelles variables on veut mettre en entrées/<em>input</em> du clustering.</p>
<p>Pour cela, on doit avoir un tableau avec <strong>n</strong> individus ou observations (lignes) et <strong>p</strong> variables (colonnes), la mesure des variables peut être des effectifs, mais aussi des proportions. L’idée étant de regrouper nos IRIS en classes homogènes (=<em>clusters</em>) en un nombre plus restreint, nos individus sont donc constitués ici par les IRIS. Il faut ensuite choisir sur quelles caractéristiques on va les regrouper et chercher une certaine homogénéité. Cela peut être à partir de plein de choses selon notre base de données : caractéristiques socio-démographiques de la population, caractéristiques d’emploi des seuls actifs occupés habitant la commune, caractéristiques des ménages habitant la commune, caractéristiques des logements, etc.</p>
<div id="variables-socio-professionnelles-caractérisant-les-individushabitants-de-notre-commune" class="section level3 hasAnchor" number="15.1.1">
<h3><span class="header-section-number">15.1.1</span> Variables socio-professionnelles caractérisant les individus/habitants de notre commune<a href="15-Clustering-application.html#variables-socio-professionnelles-caractérisant-les-individushabitants-de-notre-commune" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On va dans cet exemple (communes de l’Est parisien constitué des 11ème, 12ème et 20ème arrondissements de Paris) s’intéresser aux caractéristiques socio-professionnelles de la population : on aura en lignes nos <strong>n</strong> IRIS des 3 arrondissements et en colonnes nos variables d’entrées, soient par exemple le nombre d’habitants, le nombre d’individus qui sont actuellement chômeurs, le nombre de cadres, le nombre d’individus qui ont moins de 15 ans, etc.</p>
<p>On va alors réutiliser les deux fonctions créées précédemment <code>sum_var_IRIS()</code> et <code>tab_cont_n_iris()</code>.</p>
<p>Pour caractériser la population par IRIS à partir de variables socio-professionnnelles, on peut choisir des variables classiques du type : - catégorie socio-professionnelle (<code>CS1</code>) ; - diplôme le plus élevé (<code>DIPL</code>, à recoder pour avoir moins de modalités) ; - type d’activités (<code>TACT</code>) dont nombre d’élèves ou étudiants ; - situation quant à l’immigration (<code>IMMI</code>) ; - sexe (<code>SEXE</code>).<br />
Il faudra néanmoins faire attention à ce que certaines modalités ne se recoupent pas entre elles, notamment quand l’information sur la population de plus de 14 ans est rassemblée dans une modalité spécifique, ou quand l’information est trop proche - par exemple la CS et le diplôme. Mais on pourra le faire dans un second temps en étudiant la corrélation entre les variables finalement obtenues.</p>
<p>Regardons d’abord pour quelles variables un regroupement et recodage des modalités est nécessaire, avant d’appliquer nos fonctions de tableaux de contingence.</p>
<p>Pour la variable de CS, il faudra peut-être ne pas prendre en compte le nombre d’agriculteurs exploitants qui risque d’être très faible dans cette commune (et dans ce département de manière générale).</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="15-Clustering-application.html#cb160-1" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> </span>
<span id="cb160-2"><a href="15-Clustering-application.html#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(COD_VAR, COD_MOD, LIB_MOD) <span class="sc">%&gt;%</span> </span>
<span id="cb160-3"><a href="15-Clustering-application.html#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COD_VAR<span class="sc">==</span><span class="st">&quot;CS1&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 8 x 3
  COD_VAR COD_MOD LIB_MOD                                           
  &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                                             
1 CS1     1       Agriculteurs exploitants                          
2 CS1     2       Artisans, commerÃ§ants et chefs d&#39;entreprise      
3 CS1     3       Cadres et professions intellectuelles supÃ©rieures
4 CS1     4       Professions IntermÃ©diaires                       
5 CS1     5       EmployÃ©s                                         
6 CS1     6       Ouvriers                                          
7 CS1     7       RetraitÃ©s                                        
8 CS1     8       Autres personnes sans activitÃ© professionnelle   </code></pre>
<p>Pour la variable de diplôme :</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="15-Clustering-application.html#cb162-1" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> </span>
<span id="cb162-2"><a href="15-Clustering-application.html#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(COD_VAR, COD_MOD, LIB_MOD) <span class="sc">%&gt;%</span> </span>
<span id="cb162-3"><a href="15-Clustering-application.html#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COD_VAR<span class="sc">==</span><span class="st">&quot;DIPL&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 13 x 3
   COD_VAR COD_MOD LIB_MOD                                                      
   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                                                        
 1 DIPL    01      Pas de scolaritÃ© ou arrÃªt avant la fin du primaire         
 2 DIPL    02      Aucun diplÃ´me et scolaritÃ© interrompue Ã  la fin du primai~
 3 DIPL    03      Aucun diplÃ´me et scolaritÃ© jusquâ€™Ã  la fin du collÃ¨ge o~
 4 DIPL    11      CEP (certificat dâ€™Ã©tudes primaires)                       
 5 DIPL    12      BEPC, brevet Ã©lÃ©mentaire, brevet des collÃ¨ges, DNB        
 6 DIPL    13      CAP, BEP ou diplÃ´me de niveau Ã©quivalent                   
 7 DIPL    14      BaccalaurÃ©at gÃ©nÃ©ral ou technologique, brevet supÃ©rieur,~
 8 DIPL    15      BaccalaurÃ©at professionnel, brevet professionnel, de techni~
 9 DIPL    16      BTS, DUT, Deug, Deust, diplÃ´me de la santÃ© ou du social de~
10 DIPL    17      Licence, licence pro, maÃ®trise, diplÃ´me Ã©quivalent de niv~
11 DIPL    18      Master, DEA, DESS, diplÃ´me grande Ã©cole niveau bac+5, doct~
12 DIPL    19      Doctorat de recherche (hors santÃ©)                          
13 DIPL    ZZ      Hors champ (moins de 14 ans)                                 </code></pre>
<p>Là aussi, il faut regrouper les modalités, par exemple comme ceci : “Peu ou pas diplomés” (en-dessous du Bac), “Bac” (quel que soit le type), “Bac+2”, “Bac+3ou4”, “Bac+5ou+”</p>
<p>Et enfin, pour la variable du type d’activités :</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="15-Clustering-application.html#cb164-1" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> </span>
<span id="cb164-2"><a href="15-Clustering-application.html#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(COD_VAR, COD_MOD, LIB_MOD) <span class="sc">%&gt;%</span> </span>
<span id="cb164-3"><a href="15-Clustering-application.html#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COD_VAR<span class="sc">==</span><span class="st">&quot;TACT&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 7 x 3
  COD_VAR COD_MOD LIB_MOD                                                       
  &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                                                         
1 TACT    11      Actifs ayant un emploi, y compris sous apprentissage ou en st~
2 TACT    12      ChÃ´meurs                                                     
3 TACT    21      RetraitÃ©s ou prÃ©retraitÃ©s                                  
4 TACT    22      Ã‰lÃ¨ves, Ã©tudiants, stagiaires non rÃ©munÃ©rÃ© de 14 ans ou~
5 TACT    23      Moins de 14 ans                                               
6 TACT    24      Femmes ou hommes au foyer                                     
7 TACT    25      Autres inactifs                                               </code></pre>
<p>On pourra regrouper les 3 dernières modalités comme une catégorie large d’inactifs (‘23’,‘24’,‘25’). Par ailleurs, il faudra faire attention à certaines modalités qui peuvent être proches de celles de la variable de CS, par exemple pour les retraités, ou les inactifs.</p>
</div>
<div id="création-des-différents-tableaux-de-contingence" class="section level3 hasAnchor" number="15.1.2">
<h3><span class="header-section-number">15.1.2</span> Création des différents tableaux de contingence<a href="15-Clustering-application.html#création-des-différents-tableaux-de-contingence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On crée maintenant nos différents tableaux de contingence.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="15-Clustering-application.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la variable du nombre d&#39;habitants</span></span>
<span id="cb166-2"><a href="15-Clustering-application.html#cb166-2" aria-hidden="true" tabindex="-1"></a>Nbhab <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span> <span class="fu">sum_var_IRIS</span>(<span class="at">codedept=</span><span class="st">&quot; &quot;</span>, <span class="at">codecom =</span> <span class="fu">c</span>(<span class="st">&quot;75111&quot;</span>, <span class="st">&quot;75112&quot;</span>, <span class="st">&quot;75120&quot;</span>), </span>
<span id="cb166-3"><a href="15-Clustering-application.html#cb166-3" aria-hidden="true" tabindex="-1"></a>                             IRIS, <span class="at">nom_var =</span> nbhab)</span>
<span id="cb166-4"><a href="15-Clustering-application.html#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="15-Clustering-application.html#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la variable d&#39;âge : </span></span>
<span id="cb166-6"><a href="15-Clustering-application.html#cb166-6" aria-hidden="true" tabindex="-1"></a>Age <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span>  </span>
<span id="cb166-7"><a href="15-Clustering-application.html#cb166-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AGE=</span><span class="fu">case_when</span>(AGER20 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;2&quot;</span>,<span class="st">&quot;5&quot;</span>,<span class="st">&quot;10&quot;</span>,<span class="st">&quot;14&quot;</span>,<span class="st">&quot;17&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Moins18ans&quot;</span>, </span>
<span id="cb166-8"><a href="15-Clustering-application.html#cb166-8" aria-hidden="true" tabindex="-1"></a>                       AGER20 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;19&quot;</span>,<span class="st">&quot;24&quot;</span>,<span class="st">&quot;29&quot;</span>) <span class="sc">~</span> <span class="st">&quot;18-29ans&quot;</span>,</span>
<span id="cb166-9"><a href="15-Clustering-application.html#cb166-9" aria-hidden="true" tabindex="-1"></a>                       AGER20 <span class="sc">==</span> <span class="st">&quot;39&quot;</span> <span class="sc">~</span> <span class="st">&quot;30-39ans&quot;</span>,</span>
<span id="cb166-10"><a href="15-Clustering-application.html#cb166-10" aria-hidden="true" tabindex="-1"></a>                       AGER20 <span class="sc">==</span> <span class="st">&quot;54&quot;</span> <span class="sc">~</span> <span class="st">&quot;40-54ans&quot;</span>,</span>
<span id="cb166-11"><a href="15-Clustering-application.html#cb166-11" aria-hidden="true" tabindex="-1"></a>                       AGER20 <span class="sc">==</span> <span class="st">&quot;64&quot;</span> <span class="sc">~</span> <span class="st">&quot;55-64ans&quot;</span>,</span>
<span id="cb166-12"><a href="15-Clustering-application.html#cb166-12" aria-hidden="true" tabindex="-1"></a>                       AGER20 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;79&quot;</span>, <span class="st">&quot;80&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Plus64ans&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb166-13"><a href="15-Clustering-application.html#cb166-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_cont_n_iris</span>(<span class="at">codedept=</span><span class="st">&quot; &quot;</span>, <span class="at">codecom =</span> <span class="fu">c</span>(<span class="st">&quot;75111&quot;</span>, <span class="st">&quot;75112&quot;</span>, <span class="st">&quot;75120&quot;</span>), IRIS, AGE, </span>
<span id="cb166-14"><a href="15-Clustering-application.html#cb166-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nom_var =</span> nbage, <span class="at">var=</span>AGE, <span class="at">prefix_var=</span><span class="st">&quot;nb_&quot;</span>)</span>
<span id="cb166-15"><a href="15-Clustering-application.html#cb166-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-16"><a href="15-Clustering-application.html#cb166-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la variable de sexe : </span></span>
<span id="cb166-17"><a href="15-Clustering-application.html#cb166-17" aria-hidden="true" tabindex="-1"></a>Sexe <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span>  </span>
<span id="cb166-18"><a href="15-Clustering-application.html#cb166-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SEXE =</span> <span class="fu">factor</span>(SEXE, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Homme&quot;</span>, <span class="st">&quot;Femme&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb166-19"><a href="15-Clustering-application.html#cb166-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_cont_n_iris</span>(<span class="at">codedept=</span><span class="st">&quot; &quot;</span>, <span class="at">codecom =</span> <span class="fu">c</span>(<span class="st">&quot;75111&quot;</span>, <span class="st">&quot;75112&quot;</span>, <span class="st">&quot;75120&quot;</span>), IRIS, SEXE,</span>
<span id="cb166-20"><a href="15-Clustering-application.html#cb166-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nom_var =</span> nbsexe, <span class="at">var=</span>SEXE, <span class="at">prefix_var=</span><span class="st">&quot;nb_&quot;</span>)</span>
<span id="cb166-21"><a href="15-Clustering-application.html#cb166-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-22"><a href="15-Clustering-application.html#cb166-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la variable de CS :</span></span>
<span id="cb166-23"><a href="15-Clustering-application.html#cb166-23" aria-hidden="true" tabindex="-1"></a>CS <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span></span>
<span id="cb166-24"><a href="15-Clustering-application.html#cb166-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_cont_n_iris</span>(<span class="at">codedept=</span><span class="st">&quot; &quot;</span>, <span class="at">codecom =</span> <span class="fu">c</span>(<span class="st">&quot;75111&quot;</span>, <span class="st">&quot;75112&quot;</span>, <span class="st">&quot;75120&quot;</span>), IRIS, CS1, </span>
<span id="cb166-25"><a href="15-Clustering-application.html#cb166-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nom_var =</span> nbCS, <span class="at">var=</span>CS1, <span class="at">prefix_var=</span><span class="st">&quot;nbCS_&quot;</span>)</span>
<span id="cb166-26"><a href="15-Clustering-application.html#cb166-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-27"><a href="15-Clustering-application.html#cb166-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la variable de diplôme : </span></span>
<span id="cb166-28"><a href="15-Clustering-application.html#cb166-28" aria-hidden="true" tabindex="-1"></a>Dipl <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span> </span>
<span id="cb166-29"><a href="15-Clustering-application.html#cb166-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dipl=</span><span class="fu">case_when</span>(DIPL <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;01&quot;</span>,<span class="st">&quot;02&quot;</span>,<span class="st">&quot;03&quot;</span>,<span class="st">&quot;11&quot;</span>,<span class="st">&quot;12&quot;</span>,<span class="st">&quot;13&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Peu_pas diplomés&quot;</span>, </span>
<span id="cb166-30"><a href="15-Clustering-application.html#cb166-30" aria-hidden="true" tabindex="-1"></a>                        DIPL <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;14&quot;</span>,<span class="st">&quot;15&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Bac&quot;</span>, DIPL <span class="sc">==</span> <span class="st">&quot;16&quot;</span> <span class="sc">~</span> <span class="st">&quot;Bacplus2&quot;</span>,</span>
<span id="cb166-31"><a href="15-Clustering-application.html#cb166-31" aria-hidden="true" tabindex="-1"></a>                        DIPL <span class="sc">==</span> <span class="st">&quot;17&quot;</span> <span class="sc">~</span> <span class="st">&quot;Bacplus3ou4&quot;</span>, </span>
<span id="cb166-32"><a href="15-Clustering-application.html#cb166-32" aria-hidden="true" tabindex="-1"></a>                        DIPL <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;18&quot;</span>,<span class="st">&quot;19&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Bacplus5ouplus&quot;</span>,</span>
<span id="cb166-33"><a href="15-Clustering-application.html#cb166-33" aria-hidden="true" tabindex="-1"></a>                        DIPL <span class="sc">==</span> <span class="st">&quot;ZZ&quot;</span> <span class="sc">~</span> <span class="st">&quot;Moins14ans&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb166-34"><a href="15-Clustering-application.html#cb166-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_cont_n_iris</span>(<span class="at">codedept=</span><span class="st">&quot; &quot;</span>, <span class="at">codecom =</span> <span class="fu">c</span>(<span class="st">&quot;75111&quot;</span>, <span class="st">&quot;75112&quot;</span>, <span class="st">&quot;75120&quot;</span>), IRIS, Dipl, </span>
<span id="cb166-35"><a href="15-Clustering-application.html#cb166-35" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nom_var =</span> nbdipl, <span class="at">var=</span>Dipl, <span class="at">prefix_var=</span><span class="st">&quot;nb_&quot;</span>)</span>
<span id="cb166-36"><a href="15-Clustering-application.html#cb166-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-37"><a href="15-Clustering-application.html#cb166-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la variable d&#39;activité </span></span>
<span id="cb166-38"><a href="15-Clustering-application.html#cb166-38" aria-hidden="true" tabindex="-1"></a>activite <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span> </span>
<span id="cb166-39"><a href="15-Clustering-application.html#cb166-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">activite =</span> <span class="fu">case_when</span>(TACT <span class="sc">==</span> <span class="st">&quot;11&quot;</span> <span class="sc">~</span> <span class="st">&quot;actifs_occ&quot;</span>,</span>
<span id="cb166-40"><a href="15-Clustering-application.html#cb166-40" aria-hidden="true" tabindex="-1"></a>                              TACT <span class="sc">==</span> <span class="st">&quot;12&quot;</span> <span class="sc">~</span> <span class="st">&quot;chômeurs&quot;</span>,</span>
<span id="cb166-41"><a href="15-Clustering-application.html#cb166-41" aria-hidden="true" tabindex="-1"></a>                              TACT <span class="sc">==</span> <span class="st">&quot;22&quot;</span> <span class="sc">~</span> <span class="st">&quot;eleves_etudiants&quot;</span>,</span>
<span id="cb166-42"><a href="15-Clustering-application.html#cb166-42" aria-hidden="true" tabindex="-1"></a>                              TACT <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;21&quot;</span>,<span class="st">&quot;23&quot;</span>,<span class="st">&quot;24&quot;</span>,<span class="st">&quot;25&quot;</span>) <span class="sc">~</span> <span class="st">&quot;inactifs&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-43"><a href="15-Clustering-application.html#cb166-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_cont_n_iris</span>(<span class="at">codedept=</span><span class="st">&quot; &quot;</span>, <span class="at">codecom =</span> <span class="fu">c</span>(<span class="st">&quot;75111&quot;</span>, <span class="st">&quot;75112&quot;</span>, <span class="st">&quot;75120&quot;</span>), IRIS, activite, </span>
<span id="cb166-44"><a href="15-Clustering-application.html#cb166-44" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nom_var =</span> Nbactivite, <span class="at">var=</span>activite, <span class="at">prefix_var=</span><span class="st">&quot;Nbactivite_&quot;</span>)</span>
<span id="cb166-45"><a href="15-Clustering-application.html#cb166-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-46"><a href="15-Clustering-application.html#cb166-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la variable de statut conjugual :</span></span>
<span id="cb166-47"><a href="15-Clustering-application.html#cb166-47" aria-hidden="true" tabindex="-1"></a>statu_conj <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span>  </span>
<span id="cb166-48"><a href="15-Clustering-application.html#cb166-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">statu_conj=</span><span class="fu">case_when</span>(STAT_CONJ <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>) <span class="sc">~</span> <span class="st">&quot;1et2&quot;</span>, </span>
<span id="cb166-49"><a href="15-Clustering-application.html#cb166-49" aria-hidden="true" tabindex="-1"></a>                              STAT_CONJ <span class="sc">==</span> <span class="st">&quot;3&quot;</span> <span class="sc">~</span> <span class="st">&quot;3&quot;</span>, STAT_CONJ <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;4&quot;</span>,<span class="st">&quot;5&quot;</span>) <span class="sc">~</span> <span class="st">&quot;4&quot;</span>,</span>
<span id="cb166-50"><a href="15-Clustering-application.html#cb166-50" aria-hidden="true" tabindex="-1"></a>                              STAT_CONJ <span class="sc">==</span> <span class="st">&quot;6&quot;</span> <span class="sc">~</span> <span class="st">&quot;6&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-51"><a href="15-Clustering-application.html#cb166-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_cont_n_iris</span>(<span class="at">codedept=</span><span class="st">&quot; &quot;</span>, <span class="at">codecom =</span> <span class="fu">c</span>(<span class="st">&quot;75111&quot;</span>, <span class="st">&quot;75112&quot;</span>, <span class="st">&quot;75120&quot;</span>), IRIS, statu_conj, </span>
<span id="cb166-52"><a href="15-Clustering-application.html#cb166-52" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nom_var =</span> NbStatuconj, <span class="at">var=</span>statu_conj, <span class="at">prefix_var=</span><span class="st">&quot;NbStatuconj_&quot;</span>)</span>
<span id="cb166-53"><a href="15-Clustering-application.html#cb166-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-54"><a href="15-Clustering-application.html#cb166-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la variable d&#39;année d&#39;emménagement:</span></span>
<span id="cb166-55"><a href="15-Clustering-application.html#cb166-55" aria-hidden="true" tabindex="-1"></a>ann_em <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span> </span>
<span id="cb166-56"><a href="15-Clustering-application.html#cb166-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ann_em =</span> <span class="fu">case_when</span>(ANEMR <span class="sc">==</span> <span class="st">&#39;00&#39;</span> <span class="sc">~</span> <span class="st">&quot;Moins de 2 ans&quot;</span>,</span>
<span id="cb166-57"><a href="15-Clustering-application.html#cb166-57" aria-hidden="true" tabindex="-1"></a>                            ANEMR <span class="sc">==</span> <span class="st">&#39;01&#39;</span> <span class="sc">~</span> <span class="st">&quot;De 2 à 4 ans&quot;</span>,</span>
<span id="cb166-58"><a href="15-Clustering-application.html#cb166-58" aria-hidden="true" tabindex="-1"></a>                            ANEMR <span class="sc">==</span> <span class="st">&#39;02&#39;</span> <span class="sc">~</span> <span class="st">&quot;De 5 à 9 ans&quot;</span>,</span>
<span id="cb166-59"><a href="15-Clustering-application.html#cb166-59" aria-hidden="true" tabindex="-1"></a>                            ANEMR <span class="sc">==</span> <span class="st">&#39;03&#39;</span> <span class="sc">~</span> <span class="st">&quot;De 10 à 19 ans&quot;</span>,</span>
<span id="cb166-60"><a href="15-Clustering-application.html#cb166-60" aria-hidden="true" tabindex="-1"></a>                            ANEMR <span class="sc">==</span> <span class="st">&#39;04&#39;</span> <span class="sc">~</span> <span class="st">&quot;De 20 à 29 ans&quot;</span>,</span>
<span id="cb166-61"><a href="15-Clustering-application.html#cb166-61" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;30 ou plus&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-62"><a href="15-Clustering-application.html#cb166-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_cont_n_iris</span>(<span class="at">codedept=</span><span class="st">&quot; &quot;</span>, <span class="at">codecom =</span> <span class="fu">c</span>(<span class="st">&quot;75111&quot;</span>, <span class="st">&quot;75112&quot;</span>, <span class="st">&quot;75120&quot;</span>), IRIS, ann_em, </span>
<span id="cb166-63"><a href="15-Clustering-application.html#cb166-63" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nom_var =</span> Nbann_em, <span class="at">var=</span>ann_em, <span class="at">prefix_var=</span><span class="st">&quot;Nbann_em_&quot;</span>)</span>
<span id="cb166-64"><a href="15-Clustering-application.html#cb166-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-65"><a href="15-Clustering-application.html#cb166-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la variable de lieu de naissance</span></span>
<span id="cb166-66"><a href="15-Clustering-application.html#cb166-66" aria-hidden="true" tabindex="-1"></a>lieu_naiss <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span> </span>
<span id="cb166-67"><a href="15-Clustering-application.html#cb166-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lieu_naiss =</span> <span class="fu">case_when</span>(INAI <span class="sc">==</span> <span class="st">&quot;1&quot;</span> <span class="sc">~</span> <span class="st">&quot;même_dept&quot;</span>,</span>
<span id="cb166-68"><a href="15-Clustering-application.html#cb166-68" aria-hidden="true" tabindex="-1"></a>                                INAI <span class="sc">==</span> <span class="st">&quot;2&quot;</span> <span class="sc">~</span> <span class="st">&quot;autre_dept&quot;</span>,</span>
<span id="cb166-69"><a href="15-Clustering-application.html#cb166-69" aria-hidden="true" tabindex="-1"></a>                                INAI <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>) <span class="sc">~</span> <span class="st">&quot;autre_region&quot;</span>,</span>
<span id="cb166-70"><a href="15-Clustering-application.html#cb166-70" aria-hidden="true" tabindex="-1"></a>                                INAI <span class="sc">==</span> <span class="st">&quot;6&quot;</span> <span class="sc">~</span> <span class="st">&quot;étranger&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-71"><a href="15-Clustering-application.html#cb166-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_cont_n_iris</span>(<span class="at">codedept=</span><span class="st">&quot; &quot;</span>, <span class="at">codecom =</span> <span class="fu">c</span>(<span class="st">&quot;75111&quot;</span>, <span class="st">&quot;75112&quot;</span>, <span class="st">&quot;75120&quot;</span>), IRIS, lieu_naiss, </span>
<span id="cb166-72"><a href="15-Clustering-application.html#cb166-72" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nom_var =</span> Nblieu_naiss, <span class="at">var=</span>lieu_naiss, <span class="at">prefix_var=</span><span class="st">&quot;Nblieu_naiss_&quot;</span>)</span>
<span id="cb166-73"><a href="15-Clustering-application.html#cb166-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-74"><a href="15-Clustering-application.html#cb166-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la variable renseignant du nombre d&#39;immigrés :</span></span>
<span id="cb166-75"><a href="15-Clustering-application.html#cb166-75" aria-hidden="true" tabindex="-1"></a>Immi <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span></span>
<span id="cb166-76"><a href="15-Clustering-application.html#cb166-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(IMMI<span class="sc">==</span><span class="st">&quot;1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-77"><a href="15-Clustering-application.html#cb166-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum_var_IRIS</span>(<span class="at">codedept=</span><span class="st">&quot; &quot;</span>, <span class="at">codecom =</span> <span class="fu">c</span>(<span class="st">&quot;75111&quot;</span>, <span class="st">&quot;75112&quot;</span>, <span class="st">&quot;75120&quot;</span>), IRIS, <span class="at">nom_var =</span> nbimmi)</span></code></pre></div>
</div>
<div id="création-du-tableau-final" class="section level3 hasAnchor" number="15.1.3">
<h3><span class="header-section-number">15.1.3</span> Création du tableau final<a href="15-Clustering-application.html#création-du-tableau-final" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On va rassembler tous ces tableaux et donc ces informations en un seul tableau. Comme on a plus de 2 tableaux à fusionner, on utilise une liste dans laquelle on stocke l’ensemble de nos tableaux, et ensuite on utilise une jointure avec <code>left_join</code>, mais en passant par la fonction <code>reduce()</code> du package <code>purr()</code> qui est inclus dans <code>tidyverse</code> pour l’appliquer à notre liste de tableaux.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="15-Clustering-application.html#cb167-1" aria-hidden="true" tabindex="-1"></a>list_tab <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">data.frame</span>(Nbhab), <span class="fu">data.frame</span>(Age), <span class="fu">data.frame</span>(Sexe), <span class="fu">data.frame</span>(CS), </span>
<span id="cb167-2"><a href="15-Clustering-application.html#cb167-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">data.frame</span>(Dipl), <span class="fu">data.frame</span>(activite), <span class="fu">data.frame</span>(statu_conj), </span>
<span id="cb167-3"><a href="15-Clustering-application.html#cb167-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">data.frame</span>(ann_em), <span class="fu">data.frame</span>(lieu_naiss), <span class="fu">data.frame</span>(Immi)) </span>
<span id="cb167-4"><a href="15-Clustering-application.html#cb167-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-5"><a href="15-Clustering-application.html#cb167-5" aria-hidden="true" tabindex="-1"></a>clust <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(purrr<span class="sc">::</span><span class="fu">reduce</span>(list_tab, left_join, <span class="at">by=</span><span class="st">&#39;IRIS&#39;</span>))</span>
<span id="cb167-6"><a href="15-Clustering-application.html#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(clust)</span></code></pre></div>
<pre><code># A tibble: 6 x 43
  IRIS     nbhab nb_18~1 nb_30~2 nb_40~3 nb_55~4 nb_Mo~5 nb_Pl~6 nb_Ho~7 nb_Fe~8
  &lt;fct&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 7511141~  3145     648     502     577     377     542     500    1543    1602
2 7511141~  2335     650     531     429     240     214     272    1198    1138
3 7511141~  1824     488     354     315     188     269     210     901     923
4 7511141~  1547     447     323     288     136     210     143     773     774
5 7511141~  1932     426     377     375     202     272     279     957     974
6 7511141~  2622     575     480     595     227     402     342    1332    1289
# ... with 33 more variables: nbCS_2 &lt;dbl&gt;, nbCS_3 &lt;dbl&gt;, nbCS_4 &lt;dbl&gt;,
#   nbCS_5 &lt;dbl&gt;, nbCS_6 &lt;dbl&gt;, nbCS_7 &lt;dbl&gt;, nbCS_8 &lt;dbl&gt;, nbCS_1 &lt;dbl&gt;,
#   nb_Bac &lt;dbl&gt;, nb_Bacplus2 &lt;dbl&gt;, nb_Bacplus3ou4 &lt;dbl&gt;,
#   nb_Bacplus5ouplus &lt;dbl&gt;, nb_Moins14ans &lt;dbl&gt;, nb_Peu_pas.diplomés &lt;dbl&gt;,
#   Nbactivite_actifs_occ &lt;dbl&gt;, Nbactivite_chômeurs &lt;dbl&gt;,
#   Nbactivite_eleves_etudiants &lt;dbl&gt;, Nbactivite_inactifs &lt;dbl&gt;,
#   NbStatuconj_1et2 &lt;dbl&gt;, NbStatuconj_3 &lt;dbl&gt;, NbStatuconj_4 &lt;dbl&gt;, ...
# i Use `colnames()` to see all variable names</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="15-Clustering-application.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On supprime les tables intermédiaires pour ne pas surchager notre environnement</span></span>
<span id="cb169-2"><a href="15-Clustering-application.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(Nbhab, Age, Sexe, CS, Dipl, activite, statu_conj, ann_em, lieu_naiss, Immi)</span></code></pre></div>
<p>On va rajouter le nom des IRIS pour cette commune et l’inclure comme identifiant dans le tableau, c’est-à-dire dans le nom de la 1ère colonne (avec la fonction <code>row.names()</code>), cela peut être conseillé pour la procédure de clustering, afin que chaque IRIS soit bien identifié par son nom (label) ; on verra toutefois dans notre exemple que cela devient illisible si on a trop d’IRIS/individus. Pour cela, on va récupérer le nom des IRIS dans le fichier de métadonnées “meta”, en changeant l’encodage avec la fonction <code>parse_character()</code> et en supprimant l’information entre parenthèses avec la fonction <code>str_replace()</code> pour n’avoir que le numéro de l’IRIS :</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="15-Clustering-application.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On récupère les noms des IRIS dans le fichier de métadonnées &quot;meta&quot;</span></span>
<span id="cb170-2"><a href="15-Clustering-application.html#cb170-2" aria-hidden="true" tabindex="-1"></a>list_nom_IRIS <span class="ot">&lt;-</span> meta <span class="sc">%&gt;%</span> </span>
<span id="cb170-3"><a href="15-Clustering-application.html#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">COM =</span> <span class="fu">substr</span>(COD_MOD, <span class="dv">1</span>, <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb170-4"><a href="15-Clustering-application.html#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(COD_VAR, COD_MOD, LIB_MOD, COM) <span class="sc">%&gt;%</span> </span>
<span id="cb170-5"><a href="15-Clustering-application.html#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COD_VAR <span class="sc">==</span> <span class="st">&quot;IRIS&quot;</span> <span class="sc">&amp;</span> COM <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;75111&quot;</span>, <span class="st">&quot;75112&quot;</span>, <span class="st">&quot;75120&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb170-6"><a href="15-Clustering-application.html#cb170-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">IRIS =</span> COD_MOD) <span class="sc">%&gt;%</span> </span>
<span id="cb170-7"><a href="15-Clustering-application.html#cb170-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(LIB_MOD, IRIS) </span>
<span id="cb170-8"><a href="15-Clustering-application.html#cb170-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-9"><a href="15-Clustering-application.html#cb170-9" aria-hidden="true" tabindex="-1"></a><span class="co"># On indique le bon encodage pour que R reconnaisse les accents</span></span>
<span id="cb170-10"><a href="15-Clustering-application.html#cb170-10" aria-hidden="true" tabindex="-1"></a>list_nom_IRIS<span class="sc">$</span>LIB_MOD <span class="ot">&lt;-</span> <span class="fu">parse_character</span>(list_nom_IRIS<span class="sc">$</span>LIB_MOD, </span>
<span id="cb170-11"><a href="15-Clustering-application.html#cb170-11" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>))</span>
<span id="cb170-12"><a href="15-Clustering-application.html#cb170-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-13"><a href="15-Clustering-application.html#cb170-13" aria-hidden="true" tabindex="-1"></a><span class="co"># On supprime la fin du nom qui est entre parenthèse gràce à une expression régulière</span></span>
<span id="cb170-14"><a href="15-Clustering-application.html#cb170-14" aria-hidden="true" tabindex="-1"></a>list_nom_IRIS<span class="sc">$</span>LIB_MOD <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(list_nom_IRIS<span class="sc">$</span>LIB_MOD, <span class="st">&quot; </span><span class="sc">\\</span><span class="st">s*</span><span class="sc">\\</span><span class="st">([^</span><span class="sc">\\</span><span class="st">)]+</span><span class="sc">\\</span><span class="st">)&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb170-15"><a href="15-Clustering-application.html#cb170-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-16"><a href="15-Clustering-application.html#cb170-16" aria-hidden="true" tabindex="-1"></a>clust <span class="ot">&lt;-</span> <span class="fu">left_join</span>(clust, list_nom_IRIS, <span class="at">by=</span><span class="st">&quot;IRIS&quot;</span>)</span>
<span id="cb170-17"><a href="15-Clustering-application.html#cb170-17" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(clust) <span class="ot">&lt;-</span> clust<span class="sc">$</span>LIB_MOD</span>
<span id="cb170-18"><a href="15-Clustering-application.html#cb170-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(clust)</span></code></pre></div>
<pre><code># A tibble: 6 x 44
  IRIS     nbhab nb_18~1 nb_30~2 nb_40~3 nb_55~4 nb_Mo~5 nb_Pl~6 nb_Ho~7 nb_Fe~8
  &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 7511141~  3145     648     502     577     377     542     500    1543    1602
2 7511141~  2335     650     531     429     240     214     272    1198    1138
3 7511141~  1824     488     354     315     188     269     210     901     923
4 7511141~  1547     447     323     288     136     210     143     773     774
5 7511141~  1932     426     377     375     202     272     279     957     974
6 7511141~  2622     575     480     595     227     402     342    1332    1289
# ... with 34 more variables: nbCS_2 &lt;dbl&gt;, nbCS_3 &lt;dbl&gt;, nbCS_4 &lt;dbl&gt;,
#   nbCS_5 &lt;dbl&gt;, nbCS_6 &lt;dbl&gt;, nbCS_7 &lt;dbl&gt;, nbCS_8 &lt;dbl&gt;, nbCS_1 &lt;dbl&gt;,
#   nb_Bac &lt;dbl&gt;, nb_Bacplus2 &lt;dbl&gt;, nb_Bacplus3ou4 &lt;dbl&gt;,
#   nb_Bacplus5ouplus &lt;dbl&gt;, nb_Moins14ans &lt;dbl&gt;, nb_Peu_pas.diplomés &lt;dbl&gt;,
#   Nbactivite_actifs_occ &lt;dbl&gt;, Nbactivite_chômeurs &lt;dbl&gt;,
#   Nbactivite_eleves_etudiants &lt;dbl&gt;, Nbactivite_inactifs &lt;dbl&gt;,
#   NbStatuconj_1et2 &lt;dbl&gt;, NbStatuconj_3 &lt;dbl&gt;, NbStatuconj_4 &lt;dbl&gt;, ...
# i Use `colnames()` to see all variable names</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="15-Clustering-application.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(clust)</span></code></pre></div>
<pre><code># A tibble: 6 x 44
  IRIS     nbhab nb_18~1 nb_30~2 nb_40~3 nb_55~4 nb_Mo~5 nb_Pl~6 nb_Ho~7 nb_Fe~8
  &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 7512080~  1751     229     183     312     178     262     588     728    1023
2 7512080~  2119     314     297     439     287     473     310     965    1155
3 7512080~  3191     535     423     692     351     651     538    1461    1730
4 7512080~  2862     517     504     665     314     639     225    1382    1480
5 7512080~  1843     351     343     360     261     197     331     939     904
6 75120XX~     5       0       0       2       1       2       0       3       2
# ... with 34 more variables: nbCS_2 &lt;dbl&gt;, nbCS_3 &lt;dbl&gt;, nbCS_4 &lt;dbl&gt;,
#   nbCS_5 &lt;dbl&gt;, nbCS_6 &lt;dbl&gt;, nbCS_7 &lt;dbl&gt;, nbCS_8 &lt;dbl&gt;, nbCS_1 &lt;dbl&gt;,
#   nb_Bac &lt;dbl&gt;, nb_Bacplus2 &lt;dbl&gt;, nb_Bacplus3ou4 &lt;dbl&gt;,
#   nb_Bacplus5ouplus &lt;dbl&gt;, nb_Moins14ans &lt;dbl&gt;, nb_Peu_pas.diplomés &lt;dbl&gt;,
#   Nbactivite_actifs_occ &lt;dbl&gt;, Nbactivite_chômeurs &lt;dbl&gt;,
#   Nbactivite_eleves_etudiants &lt;dbl&gt;, Nbactivite_inactifs &lt;dbl&gt;,
#   NbStatuconj_1et2 &lt;dbl&gt;, NbStatuconj_3 &lt;dbl&gt;, NbStatuconj_4 &lt;dbl&gt;, ...
# i Use `colnames()` to see all variable names</code></pre>
<p>On remarque que la dernière ligne représente une IRIS qui compte moins de 200 habitants, on va la supprimer. Par ailleurs, on va également supprimer les deux IRIS correspondant au bois de Vincennes, même s’il y a des habitants, ces 2 IRIS sont bien trop particuliers pour être pris en compte dans notre analyse de clustering. Il y aura donc des données manquantes pour ces 2 quartiers dans la carte finale qu’on réalisera avec la répartition des IRIS selon les clusters obtenus…</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="15-Clustering-application.html#cb174-1" aria-hidden="true" tabindex="-1"></a>clust <span class="ot">&lt;-</span> clust <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>IRIS <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;75120XXXX&quot;</span>, <span class="st">&quot;751124677&quot;</span>, <span class="st">&quot;751124577&quot;</span>))</span>
<span id="cb174-2"><a href="15-Clustering-application.html#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="co"># à voir aussi : Bercy 7 (751124707) et Quinze-Vingts 13 (751124813), voire Père Lachaise 5 (751207905)</span></span></code></pre></div>
</div>
<div id="choix-des-variables-actives-dans-le-clustering" class="section level3 hasAnchor" number="15.1.4">
<h3><span class="header-section-number">15.1.4</span> choix des variables actives dans le clustering<a href="15-Clustering-application.html#choix-des-variables-actives-dans-le-clustering" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il nous reste, en dernière étape, de choisir les variables à inclure dans le clustering et vérifier si certaines d’entre elles ne sont pas corrélées, c’est-à-dire ne donnent pas la même information. Cela est important car sinon dans la procédure de clustering, cela s’apparente à donner un poids supérieur à une information si on la met en double voire en triple par exemple. C’est typiquement le cas pour la variable de CS “Retraités” et la variable d’activité “Retraités ou préretraites” : si on les laisse toutes les deux, la même information va peser 2 fois dans l’analyse.</p>
<p>Pour simplifier la procédure et surtout l’interprétation des résultats, on va réaliser un clustering avec quelques variables socio-professionnelles.</p>
<p>On peut vérifier la corrélation à l’aide d’une fonction comme <code>cor()</code> combinées avec la fonction <code>symnum()</code>, ou <code>rcorr()</code> du package <code>Hmisc</code>, ou <code>corrplot()</code> du package du même nom, ou encore <code>pairs()</code>. Attention toutefois, ces fonctions ne s’appliquent que sur des variables numériques, il nous faut donc sélectionner les colonnes sans la première (code IRIS), ni la dernière (libellé IRIS), ou en sélectionnant les seules variables qui nous intéressent. On ne va utiliser ici que <code>cor()</code> et <code>corrplot()</code> qui permettent toutes deux des visualisations assez jolies en ajoutant quelques options. Attention bis (!) : comme ici nous avons beaucoup de variables, il vaut mieux sélectionner des variables par groupe de 10 ou 15 par exemple car sinon cela peut-être illisible selon les fonctions !</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="15-Clustering-application.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour le clustering sur les variables socio-professionnelles : </span></span>
<span id="cb175-2"><a href="15-Clustering-application.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - catégorie socio-professionnelle (`CS1`) ; - diplôme le plus élevé (`Dipl`) ; </span></span>
<span id="cb175-3"><a href="15-Clustering-application.html#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - type d&#39;activités (`TACT`) ; - situation quant à l&#39;immigration (`IMMI`) ;</span></span>
<span id="cb175-4"><a href="15-Clustering-application.html#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - sexe (`SEXE`).</span></span>
<span id="cb175-5"><a href="15-Clustering-application.html#cb175-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-6"><a href="15-Clustering-application.html#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(clust[ , <span class="fu">c</span>(<span class="st">&quot;nbCS_1&quot;</span>, <span class="st">&quot;nbCS_2&quot;</span>, <span class="st">&quot;nbCS_3&quot;</span>, <span class="st">&quot;nbCS_4&quot;</span>, <span class="st">&quot;nbCS_5&quot;</span>,  <span class="st">&quot;nbCS_6&quot;</span>, <span class="st">&quot;nbCS_7&quot;</span>,</span>
<span id="cb175-7"><a href="15-Clustering-application.html#cb175-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;nbCS_8&quot;</span>, <span class="st">&quot;Nbactivite_actifs_occ&quot;</span>, <span class="st">&quot;Nbactivite_chômeurs&quot;</span>,</span>
<span id="cb175-8"><a href="15-Clustering-application.html#cb175-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Nbactivite_eleves_etudiants&quot;</span>, <span class="st">&quot;Nbactivite_inactifs&quot;</span>,</span>
<span id="cb175-9"><a href="15-Clustering-application.html#cb175-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;nb_Bac&quot;</span>, <span class="st">&quot;nb_Bacplus2&quot;</span>, <span class="st">&quot;nb_Bacplus3ou4&quot;</span>,<span class="st">&quot;nb_Bacplus5ouplus&quot;</span>,</span>
<span id="cb175-10"><a href="15-Clustering-application.html#cb175-10" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;nb_Moins14ans&quot;</span>, <span class="st">&quot;nb_Peu_pas.diplomés&quot;</span>, <span class="st">&quot;nbimmi&quot;</span>, <span class="st">&quot;nb_Femme&quot;</span>)])</span></code></pre></div>
<pre><code>                                  nbCS_1     nbCS_2       nbCS_3       nbCS_4
nbCS_1                       1.000000000 0.06913325  0.108685116 -0.008965482
nbCS_2                       0.069133254 1.00000000  0.626901951  0.637284571
nbCS_3                       0.108685116 0.62690195  1.000000000  0.670160776
nbCS_4                      -0.008965482 0.63728457  0.670160776  1.000000000
nbCS_5                      -0.039492923 0.28455999 -0.003294028  0.558951911
nbCS_6                      -0.002830240 0.19636249 -0.154828264  0.403130103
nbCS_7                      -0.041982333 0.33141774  0.412510409  0.536582081
nbCS_8                       0.040575995 0.38333527  0.179518672  0.593562489
Nbactivite_actifs_occ        0.070741956 0.72150143  0.837689732  0.922600642
Nbactivite_chômeurs         -0.052816797 0.43824731  0.180259876  0.644377699
Nbactivite_eleves_etudiants  0.028452507 0.44452185  0.340624024  0.614209703
Nbactivite_inactifs          0.006610515 0.37921070  0.288687550  0.620360776
nb_Bac                      -0.047894793 0.46905678  0.332125488  0.739370825
nb_Bacplus2                  0.014476055 0.54524403  0.570130991  0.839901494
nb_Bacplus3ou4               0.075125803 0.66262686  0.828316296  0.857109044
nb_Bacplus5ouplus            0.092948904 0.62869585  0.982335398  0.652482454
nb_Moins14ans                0.055284559 0.36531900  0.212406380  0.587886856
nb_Peu_pas.diplomés         -0.034273370 0.22202191 -0.104132977  0.456737498
nbimmi                      -0.025463692 0.36681469  0.033221328  0.517048062
nb_Femme                     0.027458059 0.59244321  0.585826538  0.853281045
                                  nbCS_5      nbCS_6      nbCS_7     nbCS_8
nbCS_1                      -0.039492923 -0.00283024 -0.04198233 0.04057599
nbCS_2                       0.284559989  0.19636249  0.33141774 0.38333527
nbCS_3                      -0.003294028 -0.15482826  0.41251041 0.17951867
nbCS_4                       0.558951911  0.40313010  0.53658208 0.59356249
nbCS_5                       1.000000000  0.84445497  0.44614717 0.84694505
nbCS_6                       0.844454970  1.00000000  0.22844112 0.74509062
nbCS_7                       0.446147171  0.22844112  1.00000000 0.51816732
nbCS_8                       0.846945049  0.74509062  0.51816732 1.00000000
Nbactivite_actifs_occ        0.512275639  0.34653810  0.56358020 0.59569304
Nbactivite_chômeurs          0.860710615  0.78637188  0.44210331 0.79316564
Nbactivite_eleves_etudiants  0.688518986  0.61053082  0.41981176 0.88250002
Nbactivite_inactifs          0.752127676  0.56928089  0.85925308 0.86930902
nb_Bac                       0.839438819  0.70225253  0.63361922 0.87030447
nb_Bacplus2                  0.651506338  0.46586711  0.70549762 0.70806976
nb_Bacplus3ou4               0.370480308  0.19414785  0.63611386 0.49758879
nb_Bacplus5ouplus           -0.036199457 -0.19172131  0.39311819 0.14324210
nb_Moins14ans                0.777211723  0.65831113  0.54969794 0.95153288
nb_Peu_pas.diplomés          0.913755391  0.83727463  0.56931854 0.85908507
nbimmi                       0.877968920  0.84956644  0.43416092 0.82122697
nb_Femme                     0.733461744  0.53760529  0.76647778 0.83718765
                            Nbactivite_actifs_occ Nbactivite_chômeurs
nbCS_1                                 0.07074196          -0.0528168
nbCS_2                                 0.72150143           0.4382473
nbCS_3                                 0.83768973           0.1802599
nbCS_4                                 0.92260064           0.6443777
nbCS_5                                 0.51227564           0.8607106
nbCS_6                                 0.34653810           0.7863719
nbCS_7                                 0.56358020           0.4421033
nbCS_8                                 0.59569304           0.7931656
Nbactivite_actifs_occ                  1.00000000           0.5879678
Nbactivite_chômeurs                    0.58796777           1.0000000
Nbactivite_eleves_etudiants            0.65579644           0.6709845
Nbactivite_inactifs                    0.62656821           0.7077251
nb_Bac                                 0.73006988           0.8023773
nb_Bacplus2                            0.84247508           0.6627568
nb_Bacplus3ou4                         0.91504552           0.4826665
nb_Bacplus5ouplus                      0.80872811           0.1523240
nb_Moins14ans                          0.58682865           0.7320770
nb_Peu_pas.diplomés                    0.39294034           0.8009845
nbimmi                                 0.49222054           0.8500333
nb_Femme                               0.88326898           0.7602899
                            Nbactivite_eleves_etudiants Nbactivite_inactifs
nbCS_1                                       0.02845251         0.006610515
nbCS_2                                       0.44452185         0.379210698
nbCS_3                                       0.34062402         0.288687550
nbCS_4                                       0.61420970         0.620360776
nbCS_5                                       0.68851899         0.752127676
nbCS_6                                       0.61053082         0.569280888
nbCS_7                                       0.41981176         0.859253082
nbCS_8                                       0.88250002         0.869309017
Nbactivite_actifs_occ                        0.65579644         0.626568206
Nbactivite_chômeurs                          0.67098451         0.707725129
Nbactivite_eleves_etudiants                  1.00000000         0.688588835
Nbactivite_inactifs                          0.68858883         1.000000000
nb_Bac                                       0.81813052         0.842875236
nb_Bacplus2                                  0.65301706         0.795123681
nb_Bacplus3ou4                               0.58646714         0.604416352
nb_Bacplus5ouplus                            0.32662754         0.251476958
nb_Moins14ans                                0.77649671         0.876637069
nb_Peu_pas.diplomés                          0.65288734         0.837879230
nbimmi                                       0.69219733         0.721561557
nb_Femme                                     0.78756255         0.898089245
                                 nb_Bac nb_Bacplus2 nb_Bacplus3ou4
nbCS_1                      -0.04789479  0.01447606      0.0751258
nbCS_2                       0.46905678  0.54524403      0.6626269
nbCS_3                       0.33212549  0.57013099      0.8283163
nbCS_4                       0.73937082  0.83990149      0.8571090
nbCS_5                       0.83943882  0.65150634      0.3704803
nbCS_6                       0.70225253  0.46586711      0.1941478
nbCS_7                       0.63361922  0.70549762      0.6361139
nbCS_8                       0.87030447  0.70806976      0.4975888
Nbactivite_actifs_occ        0.73006988  0.84247508      0.9150455
Nbactivite_chômeurs          0.80237728  0.66275683      0.4826665
Nbactivite_eleves_etudiants  0.81813052  0.65301706      0.5864671
Nbactivite_inactifs          0.84287524  0.79512368      0.6044164
nb_Bac                       1.00000000  0.78822354      0.6300673
nb_Bacplus2                  0.78822354  1.00000000      0.7746082
nb_Bacplus3ou4               0.63006729  0.77460815      1.0000000
nb_Bacplus5ouplus            0.29409493  0.51898821      0.8017520
nb_Moins14ans                0.82068738  0.70949311      0.4929180
nb_Peu_pas.diplomés          0.77835912  0.60176204      0.2859801
nbimmi                       0.77662150  0.56769143      0.3790835
nb_Femme                     0.88987976  0.89271921      0.8250014
                            nb_Bacplus5ouplus nb_Moins14ans nb_Peu_pas.diplomés
nbCS_1                             0.09294890    0.05528456         -0.03427337
nbCS_2                             0.62869585    0.36531900          0.22202191
nbCS_3                             0.98233540    0.21240638         -0.10413298
nbCS_4                             0.65248245    0.58788686          0.45673750
nbCS_5                            -0.03619946    0.77721172          0.91375539
nbCS_6                            -0.19172131    0.65831113          0.83727463
nbCS_7                             0.39311819    0.54969794          0.56931854
nbCS_8                             0.14324210    0.95153288          0.85908507
Nbactivite_actifs_occ              0.80872811    0.58682865          0.39294034
Nbactivite_chômeurs                0.15232401    0.73207697          0.80098445
Nbactivite_eleves_etudiants        0.32662754    0.77649671          0.65288734
Nbactivite_inactifs                0.25147696    0.87663707          0.83787923
nb_Bac                             0.29409493    0.82068738          0.77835912
nb_Bacplus2                        0.51898821    0.70949311          0.60176204
nb_Bacplus3ou4                     0.80175198    0.49291797          0.28598013
nb_Bacplus5ouplus                  1.00000000    0.16517971         -0.14911090
nb_Moins14ans                      0.16517971    1.00000000          0.78697467
nb_Peu_pas.diplomés               -0.14911090    0.78697467          1.00000000
nbimmi                             0.01374279    0.71558091          0.87671473
nb_Femme                           0.55329417    0.82538513          0.70742281
                                 nbimmi   nb_Femme
nbCS_1                      -0.02546369 0.02745806
nbCS_2                       0.36681469 0.59244321
nbCS_3                       0.03322133 0.58582654
nbCS_4                       0.51704806 0.85328105
nbCS_5                       0.87796892 0.73346174
nbCS_6                       0.84956644 0.53760529
nbCS_7                       0.43416092 0.76647778
nbCS_8                       0.82122697 0.83718765
Nbactivite_actifs_occ        0.49222054 0.88326898
Nbactivite_chômeurs          0.85003327 0.76028986
Nbactivite_eleves_etudiants  0.69219733 0.78756255
Nbactivite_inactifs          0.72156156 0.89808925
nb_Bac                       0.77662150 0.88987976
nb_Bacplus2                  0.56769143 0.89271921
nb_Bacplus3ou4               0.37908348 0.82500141
nb_Bacplus5ouplus            0.01374279 0.55329417
nb_Moins14ans                0.71558091 0.82538513
nb_Peu_pas.diplomés          0.87671473 0.70742281
nbimmi                       1.00000000 0.69205032
nb_Femme                     0.69205032 1.00000000</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="15-Clustering-application.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour voir plus rapidement avec des indications les fortes corrélations :</span></span>
<span id="cb177-2"><a href="15-Clustering-application.html#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">symnum</span>(<span class="fu">cor</span>(clust[ , <span class="fu">c</span>(<span class="st">&quot;nbCS_1&quot;</span>, <span class="st">&quot;nbCS_2&quot;</span>, <span class="st">&quot;nbCS_3&quot;</span>, <span class="st">&quot;nbCS_4&quot;</span>, <span class="st">&quot;nbCS_5&quot;</span>,  <span class="st">&quot;nbCS_6&quot;</span>, </span>
<span id="cb177-3"><a href="15-Clustering-application.html#cb177-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;nbCS_7&quot;</span>, <span class="st">&quot;nbCS_8&quot;</span>, <span class="st">&quot;Nbactivite_chômeurs&quot;</span>, </span>
<span id="cb177-4"><a href="15-Clustering-application.html#cb177-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Nbactivite_eleves_etudiants&quot;</span>,  <span class="st">&quot;nbimmi&quot;</span>, <span class="st">&quot;nb_Femme&quot;</span>)]))</span></code></pre></div>
<pre><code>                            nCS_1 nCS_2 nCS_3 nCS_4 nCS_5 nCS_6 nCS_7 nCS_8 Nb_
nbCS_1                      1                                                  
nbCS_2                            1                                            
nbCS_3                            ,     1                                      
nbCS_4                            ,     ,     1                                
nbCS_5                                        .     1                          
nbCS_6                                        .     +     1                    
nbCS_7                            .     .     .     .           1              
nbCS_8                            .           .     +     ,     .     1        
Nbactivite_chômeurs               .           ,     +     ,     .     ,     1  
Nbactivite_eleves_etudiants       .     .     ,     ,     ,     .     +     ,  
nbimmi                            .           .     +     +     .     +     +  
nb_Femme                          .     .     +     ,     .     ,     +     ,  
                            N__ nb n_
nbCS_1                               
nbCS_2                               
nbCS_3                               
nbCS_4                               
nbCS_5                               
nbCS_6                               
nbCS_7                               
nbCS_8                               
Nbactivite_chômeurs                  
Nbactivite_eleves_etudiants 1        
nbimmi                      ,   1    
nb_Femme                    ,   ,  1 
attr(,&quot;legend&quot;)
[1] 0 &#39; &#39; 0.3 &#39;.&#39; 0.6 &#39;,&#39; 0.8 &#39;+&#39; 0.9 &#39;*&#39; 0.95 &#39;B&#39; 1</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="15-Clustering-application.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cor(clust[ , c(&quot;nbCS_1&quot;, &quot;nbCS_2&quot;, &quot;nbCS_3&quot;, &quot;nbCS_4&quot;, &quot;nbCS_5&quot;,  &quot;nbCS_6&quot;, &quot;nbCS_7&quot;,</span></span>
<span id="cb179-2"><a href="15-Clustering-application.html#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                &quot;nbCS_8&quot;, &quot;Nbactivite_chômeurs&quot;, &quot;nbimmi&quot;, &quot;nb_Femme&quot;)])</span></span>
<span id="cb179-3"><a href="15-Clustering-application.html#cb179-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-4"><a href="15-Clustering-application.html#cb179-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour info avec le package `Hmisc`</span></span>
<span id="cb179-5"><a href="15-Clustering-application.html#cb179-5" aria-hidden="true" tabindex="-1"></a><span class="co"># library(Hmisc)</span></span>
<span id="cb179-6"><a href="15-Clustering-application.html#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rcorr(as.matrix(clust[, c(&quot;nbCS_1&quot;, &quot;nbCS_2&quot;, &quot;nbCS_3&quot;, &quot;nbCS_4&quot;, &quot;nbCS_5&quot;, &quot;nbCS_6&quot;, </span></span>
<span id="cb179-7"><a href="15-Clustering-application.html#cb179-7" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;nbCS_7&quot;, &quot;nbCS_8&quot;, &quot;Nbactivite_chômeurs&quot;, &quot;nbimmi&quot;, &quot;nb_Femme&quot;)]))</span></span>
<span id="cb179-8"><a href="15-Clustering-application.html#cb179-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-9"><a href="15-Clustering-application.html#cb179-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Et le package `corrplot`</span></span>
<span id="cb179-10"><a href="15-Clustering-application.html#cb179-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb179-11"><a href="15-Clustering-application.html#cb179-11" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(clust[, <span class="fu">c</span>(<span class="st">&quot;nbCS_1&quot;</span>, <span class="st">&quot;nbCS_2&quot;</span>, <span class="st">&quot;nbCS_3&quot;</span>, <span class="st">&quot;nbCS_4&quot;</span>, <span class="st">&quot;nbCS_5&quot;</span>,  <span class="st">&quot;nbCS_6&quot;</span>, </span>
<span id="cb179-12"><a href="15-Clustering-application.html#cb179-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;nbCS_7&quot;</span>, <span class="st">&quot;nbCS_8&quot;</span>, <span class="st">&quot;Nbactivite_chômeurs&quot;</span>, <span class="st">&quot;nbimmi&quot;</span>, </span>
<span id="cb179-13"><a href="15-Clustering-application.html#cb179-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;nb_Femme&quot;</span>)]), </span>
<span id="cb179-14"><a href="15-Clustering-application.html#cb179-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">type=</span><span class="st">&quot;upper&quot;</span>, <span class="at">method=</span><span class="st">&quot;number&quot;</span>, <span class="at">tl.col=</span><span class="st">&quot;black&quot;</span>, <span class="at">tl.srt=</span><span class="dv">45</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Corr-1.svg" width="672" /></p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="15-Clustering-application.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(clust[, <span class="fu">c</span>(<span class="st">&quot;nbCS_1&quot;</span>, <span class="st">&quot;nbCS_2&quot;</span>, <span class="st">&quot;nbCS_3&quot;</span>, <span class="st">&quot;nbCS_4&quot;</span>, <span class="st">&quot;nbCS_5&quot;</span>, <span class="st">&quot;nbCS_6&quot;</span>, </span>
<span id="cb180-2"><a href="15-Clustering-application.html#cb180-2" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;nbCS_7&quot;</span>, <span class="st">&quot;nbCS_8&quot;</span>, <span class="st">&quot;nb_Bac&quot;</span>,<span class="st">&quot;nb_Bacplus2&quot;</span>, <span class="st">&quot;nb_Bacplus3ou4&quot;</span>,</span>
<span id="cb180-3"><a href="15-Clustering-application.html#cb180-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;nb_Bacplus5ouplus&quot;</span>,  <span class="st">&quot;nb_Moins14ans&quot;</span>, <span class="st">&quot;nb_Peu_pas.diplomés&quot;</span>)]), </span>
<span id="cb180-4"><a href="15-Clustering-application.html#cb180-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">type=</span><span class="st">&quot;upper&quot;</span>, <span class="at">method=</span><span class="st">&quot;number&quot;</span>, <span class="at">tl.col=</span><span class="st">&quot;black&quot;</span>, <span class="at">tl.srt=</span><span class="dv">45</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Corr-2.svg" width="672" /></p>
<p>Pour le dernier graphique, si la couleur est bleu foncé, ou si le coefficient est proche de 1, cela signifie que les variables sont corrélées (la statistique utilisée est le coefficient de corrélation de Pearson qui indique une relation linéaire entre deux variables continues, il varie entre -1 et 1 comme on peut le remarquer sur les premières matrices obtenues avec <code>corrplot()</code>).</p>
<p>On remarque ainsi que les variables de CS et de diplôme sont trop corrélées, on va choisir de garder ici la variable de CS. Par ailleurs, cette dernière variable est aussi assez corrélé avec certaines modalités de la variable du type d’activités, par exemple :“Nbactivite_actifs_occ” et “nbCS_4” ; “Nbactivite_inactifs avec”nbCS_7”, “nbCS_8” (cf. 1er tableau général des corrélations).</p>
<p>On va donc procéder à la suppression de certaines colonnes de notre table finales.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="15-Clustering-application.html#cb181-1" aria-hidden="true" tabindex="-1"></a>clust_socioprof <span class="ot">&lt;-</span> clust[, <span class="fu">c</span>(<span class="st">&quot;nbCS_2&quot;</span>, <span class="st">&quot;nbCS_3&quot;</span>, <span class="st">&quot;nbCS_4&quot;</span>, <span class="st">&quot;nbCS_5&quot;</span>,  <span class="st">&quot;nbCS_6&quot;</span>, </span>
<span id="cb181-2"><a href="15-Clustering-application.html#cb181-2" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;nbCS_7&quot;</span>, <span class="st">&quot;nbCS_8&quot;</span>,  <span class="st">&quot;Nbactivite_chômeurs&quot;</span>, <span class="st">&quot;nbimmi&quot;</span>,</span>
<span id="cb181-3"><a href="15-Clustering-application.html#cb181-3" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;nb_Femme&quot;</span>)]</span></code></pre></div>
<p>Il peut être également plus pertinent de ne pas raisonner en nombre mais plutôt en proportion, pour éviter de capter un effet taille du nombre d’habitants dans un quartier donné. Dans ce cas, on calcule les proportion pour chacune de nos variables finales et on crée un nouvel objet pour cela.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="15-Clustering-application.html#cb182-1" aria-hidden="true" tabindex="-1"></a>clust_socioprof_prop <span class="ot">&lt;-</span> clust <span class="sc">%&gt;%</span> </span>
<span id="cb182-2"><a href="15-Clustering-application.html#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;nbhab&quot;</span>, <span class="st">&quot;nbCS_2&quot;</span>, <span class="st">&quot;nbCS_3&quot;</span>, <span class="st">&quot;nbCS_4&quot;</span>, <span class="st">&quot;nbCS_5&quot;</span>,  <span class="st">&quot;nbCS_6&quot;</span>, <span class="st">&quot;nbCS_7&quot;</span>, <span class="st">&quot;nbCS_8&quot;</span>, </span>
<span id="cb182-3"><a href="15-Clustering-application.html#cb182-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Nbactivite_chômeurs&quot;</span>, <span class="st">&quot;nbimmi&quot;</span>, <span class="st">&quot;nb_Femme&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb182-4"><a href="15-Clustering-application.html#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pctCS_2 =</span> (nbCS_2 <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb182-5"><a href="15-Clustering-application.html#cb182-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctCS_3 =</span> (nbCS_3 <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb182-6"><a href="15-Clustering-application.html#cb182-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctCS_4 =</span> (nbCS_4 <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb182-7"><a href="15-Clustering-application.html#cb182-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctCS_5 =</span> (nbCS_5 <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb182-8"><a href="15-Clustering-application.html#cb182-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctCS_6 =</span> (nbCS_6 <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb182-9"><a href="15-Clustering-application.html#cb182-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctCS_7 =</span> (nbCS_7 <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb182-10"><a href="15-Clustering-application.html#cb182-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctCS_8 =</span> (nbCS_8 <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb182-11"><a href="15-Clustering-application.html#cb182-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctFemme =</span> (nb_Femme <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb182-12"><a href="15-Clustering-application.html#cb182-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctChomeurs =</span> (Nbactivite_chômeurs <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb182-13"><a href="15-Clustering-application.html#cb182-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctImmi =</span> (nbimmi <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb182-14"><a href="15-Clustering-application.html#cb182-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(pctFemme, pctCS_2, pctCS_3, pctCS_4, pctCS_5, pctCS_6,</span>
<span id="cb182-15"><a href="15-Clustering-application.html#cb182-15" aria-hidden="true" tabindex="-1"></a>         pctCS_7, pctCS_8, pctChomeurs, pctImmi)</span></code></pre></div>
</div>
</div>
<div id="la-méthode-de-la-cah-appliquée-à-nos-données" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> La méthode de la CAH appliquée à nos données<a href="15-Clustering-application.html#la-méthode-de-la-cah-appliquée-à-nos-données" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="constitution-des-classes" class="section level3 hasAnchor" number="15.2.1">
<h3><span class="header-section-number">15.2.1</span> Constitution des classes<a href="15-Clustering-application.html#constitution-des-classes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On reprend les étapes de la méthode décrite plus haut, une par une.
Pour la classification réalisée sur le tableau de contingence en effectifs, on utilise la méthode euclidienne pour la matrice des distances ; mais pour la classification réalisée sur le tableau de contingence en pourcentage (pour éviter un effet taille de nos IRIS), il faut utiliser la distance du khi-2. Pour cette dernière, nous avons besoin du package <code>**ade4**</code> (à installer avant de le charger) et de sa fonction <code>dist.dudi</code>. Attention, cette fonction doit être utilisée sur un format particulier c’est pourquoi on l’utilise avec la fonction <code>dudi.coa</code>. Enfin, l’option <code>amongrow=TRUE</code> de la fonction <code>dist.dudi</code> permet de préciser que les distances doivent être calculées entre lignes, c’est-à-dire ici entre nos individus constitués par les IRIS (<code>FALSE</code> si on veut que la distance soit calculée entre colonnes).</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="15-Clustering-application.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Etape 1 : on centre et réduit les variables si on prend la table en nombre</span></span>
<span id="cb183-2"><a href="15-Clustering-application.html#cb183-2" aria-hidden="true" tabindex="-1"></a>clust_socioprof_sc <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(clust_socioprof)) </span>
<span id="cb183-3"><a href="15-Clustering-application.html#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="co"># on n&#39;applique pas cette procédure sur la table en proportion</span></span>
<span id="cb183-4"><a href="15-Clustering-application.html#cb183-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-5"><a href="15-Clustering-application.html#cb183-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-6"><a href="15-Clustering-application.html#cb183-6" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;ade4&quot;)</span></span>
<span id="cb183-7"><a href="15-Clustering-application.html#cb183-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ade4)</span>
<span id="cb183-8"><a href="15-Clustering-application.html#cb183-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Etape 2 : on crée la matrice de distance, en utilisant la distance euclidienne </span></span>
<span id="cb183-9"><a href="15-Clustering-application.html#cb183-9" aria-hidden="true" tabindex="-1"></a><span class="co">#standard pour la table en nombre, et la distance du khi-2 pour la table en %</span></span>
<span id="cb183-10"><a href="15-Clustering-application.html#cb183-10" aria-hidden="true" tabindex="-1"></a>dist_mat_socioprof_n <span class="ot">&lt;-</span> <span class="fu">dist</span>(clust_socioprof_sc, <span class="at">method =</span> <span class="st">&#39;euclidean&#39;</span>)</span>
<span id="cb183-11"><a href="15-Clustering-application.html#cb183-11" aria-hidden="true" tabindex="-1"></a>dist_mat_socioprof_p <span class="ot">&lt;-</span> <span class="fu">dist.dudi</span>(<span class="fu">dudi.coa</span>(clust_socioprof_prop, <span class="at">scannf=</span><span class="cn">FALSE</span>, <span class="at">nf=</span><span class="dv">10</span>),</span>
<span id="cb183-12"><a href="15-Clustering-application.html#cb183-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">amongrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb183-13"><a href="15-Clustering-application.html#cb183-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-14"><a href="15-Clustering-application.html#cb183-14" aria-hidden="true" tabindex="-1"></a><span class="co"># si vous souhaitez voir et comparer les matrices de distances, </span></span>
<span id="cb183-15"><a href="15-Clustering-application.html#cb183-15" aria-hidden="true" tabindex="-1"></a><span class="co"># vous devez les transformer en matrix avec la fonction &#39;as.matrix&#39;, par exemple :</span></span>
<span id="cb183-16"><a href="15-Clustering-application.html#cb183-16" aria-hidden="true" tabindex="-1"></a><span class="co"># as.matrix(dist_mat_socioprof_n)</span></span>
<span id="cb183-17"><a href="15-Clustering-application.html#cb183-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-18"><a href="15-Clustering-application.html#cb183-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-19"><a href="15-Clustering-application.html#cb183-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Etape 3 : on choisit la méthode d&#39;agrégation, ici la plus standard, le critère de Ward</span></span>
<span id="cb183-20"><a href="15-Clustering-application.html#cb183-20" aria-hidden="true" tabindex="-1"></a>classif_socioprof_n <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist_mat_socioprof_n, <span class="at">method =</span> <span class="st">&quot;ward.D2&quot;</span>)</span>
<span id="cb183-21"><a href="15-Clustering-application.html#cb183-21" aria-hidden="true" tabindex="-1"></a>classif_socioprof_p <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist_mat_socioprof_p, <span class="at">method =</span> <span class="st">&quot;ward.D2&quot;</span>)</span>
<span id="cb183-22"><a href="15-Clustering-application.html#cb183-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-23"><a href="15-Clustering-application.html#cb183-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-24"><a href="15-Clustering-application.html#cb183-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Etape 4 : on visualise l&#39;arbre de classification ou dendogramme</span></span>
<span id="cb183-25"><a href="15-Clustering-application.html#cb183-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(classif_socioprof_n, <span class="at">xlab=</span><span class="st">&quot;IRIS&quot;</span>,  <span class="at">main=</span><span class="st">&quot;Dendogramme table effectifs&quot;</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Etapes_CAH-1.svg" width="672" /></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="15-Clustering-application.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(classif_socioprof_p, <span class="at">xlab=</span><span class="st">&quot;IRIS&quot;</span>,  <span class="at">main=</span><span class="st">&quot;Dendogramme table proportion&quot;</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Etapes_CAH-2.svg" width="672" /></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="15-Clustering-application.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(classif_socioprof_n, xlab=&quot;IRIS&quot;,  main=&quot;Dendogramme&quot;, labels=FALSE)</span></span></code></pre></div>
<p>On remarque ici que comme nous avons mis en label (<em>row.names</em>) le nom des IRIS, on peut tout de suite savoir quels IRIS sont proches et vont former des classes. Toutefois, avec 190 IRIS ce n’est absolument pas lisible !! Donc on peut aussi les enlever avec l’option <code>label=FALSE</code> dans la fonction <code>plot()</code>.<br />
Il existe aussi une fonction <em>via</em> <strong><code>ggplot2</code></strong> mais il faut installer avant le package <strong><code>ggdendro</code></strong>.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="15-Clustering-application.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdendro)</span>
<span id="cb186-2"><a href="15-Clustering-application.html#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdendrogram</span>(classif_socioprof_n, <span class="at">labels=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-131-1.svg" width="672" /></p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="15-Clustering-application.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdendrogram</span>(classif_socioprof_p, <span class="at">labels=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-131-2.svg" width="672" /></p>
<p>Il faut maintenant prendre une décision : où coupe-t-on l’arbre pour obtenir une partition de la population (ici nos IRIS), autrement dit combien de classes choisissons-nous ?<br />
On peut d’abord s’appuyer sur la forme du dendogramme : plus une “branche” est haute et plus on perd en distance ou ici (critère de Ward) en inertie interclasse<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>, il faudra donc couper l’arbre au niveau de cette branche. Il faut également prendre en compte ce qui peut être le mieux pour l’analyse : si on aboutit à une classification en 2 classes, cela risque d’être peu intéressant à analyser, mais si on a une classification en 5 classes ou plus, cela va devenir compliqué à interpréter…<br />
Ici, dans les deux cas, il semble que choisir 2 classes soit très pertinent, mais on voit qu’on pourrait aussi choisir 4 classes pour le premier clustering, et 3 ou 4 classes pour le second si l’on veut rentrer un peu plus dans le détail de l’analyse.</p>
<p>On peut également s’aider de représentations des sauts d’inertie du dendrogramme selon le nombre de classes qui peut être retenu, avec la fonction plot et en récupérant l’information sur l’inertie (<code>height</code>). Ci-dessous, trois types de graphes qui représentent exactement la même chose, mais selon des formes différentes : retenez celle que vous préférez et qui vous parle le plus !</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="15-Clustering-application.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co">#on stocke l&#39;attribut `$height` dans l&#39;objet `inertie` en triant les valeurs par ordre décroissant.</span></span>
<span id="cb188-2"><a href="15-Clustering-application.html#cb188-2" aria-hidden="true" tabindex="-1"></a>inertie_socioprof_n <span class="ot">&lt;-</span> <span class="fu">sort</span>(classif_socioprof_n<span class="sc">$</span>height, <span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb188-3"><a href="15-Clustering-application.html#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(inertie_socioprof_n, <span class="at">type=</span><span class="st">&quot;s&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Nombre de classes&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Inertie&quot;</span>, </span>
<span id="cb188-4"><a href="15-Clustering-application.html#cb188-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>), <span class="at">xaxp =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>,<span class="dv">14</span>))</span>
<span id="cb188-5"><a href="15-Clustering-application.html#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>), inertie_socioprof_n[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], </span>
<span id="cb188-6"><a href="15-Clustering-application.html#cb188-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue3&quot;</span>, <span class="st">&quot;brown3&quot;</span>, <span class="st">&quot;chartreuse3&quot;</span>), <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Plot_inertie-1.svg" width="672" /></p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="15-Clustering-application.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(inertie_socioprof_n, <span class="at">type=</span><span class="st">&quot;h&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Nombre de classes&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Inertie&quot;</span>, </span>
<span id="cb189-2"><a href="15-Clustering-application.html#cb189-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>), <span class="at">xaxp =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>,<span class="dv">14</span>))</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Plot_inertie-2.svg" width="672" /></p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="15-Clustering-application.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(inertie_socioprof_n, <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Nombre de classes&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Inertie&quot;</span>, </span>
<span id="cb190-2"><a href="15-Clustering-application.html#cb190-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>), <span class="at">xaxp =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>,<span class="dv">14</span>))</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Plot_inertie-3.svg" width="672" /></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="15-Clustering-application.html#cb191-1" aria-hidden="true" tabindex="-1"></a>inertie_socioprof_p <span class="ot">&lt;-</span> <span class="fu">sort</span>(classif_socioprof_p<span class="sc">$</span>height, <span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb191-2"><a href="15-Clustering-application.html#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(inertie_socioprof_p, <span class="at">type=</span><span class="st">&quot;s&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Nombre de classes&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Inertie&quot;</span>, </span>
<span id="cb191-3"><a href="15-Clustering-application.html#cb191-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>), <span class="at">xaxp =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>,<span class="dv">14</span>))</span>
<span id="cb191-4"><a href="15-Clustering-application.html#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), inertie_socioprof_p[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)], </span>
<span id="cb191-5"><a href="15-Clustering-application.html#cb191-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue3&quot;</span>, <span class="st">&quot;brown3&quot;</span>, <span class="st">&quot;chartreuse3&quot;</span>), <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Plot_inertie-4.svg" width="672" /></p>
<p>Ou encore créer d’autres indicateurs plus rigoureux, comme la part de la perte d’inertie interclasse dans l’inertie totale (on parle aussi de “semi-partial R-squared”).</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="15-Clustering-application.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co">#on crée un indicateur de part en %</span></span>
<span id="cb192-2"><a href="15-Clustering-application.html#cb192-2" aria-hidden="true" tabindex="-1"></a>partinertie_socioprof_n <span class="ot">&lt;-</span> inertie_socioprof_n<span class="sc">/</span><span class="fu">sum</span>(inertie_socioprof_n)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb192-3"><a href="15-Clustering-application.html#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(partinertie_socioprof_n, <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Nombre de classes&quot;</span>, </span>
<span id="cb192-4"><a href="15-Clustering-application.html#cb192-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Part dans l&#39;inertie totale en %&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>), <span class="at">xaxp =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>,<span class="dv">14</span>))</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Plot_inertie_bis-1.svg" width="672" /></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="15-Clustering-application.html#cb193-1" aria-hidden="true" tabindex="-1"></a>partinertie_socioprof_p <span class="ot">&lt;-</span> inertie_socioprof_p<span class="sc">/</span><span class="fu">sum</span>(inertie_socioprof_p)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb193-2"><a href="15-Clustering-application.html#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(partinertie_socioprof_p, <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Nombre de classes&quot;</span>, </span>
<span id="cb193-3"><a href="15-Clustering-application.html#cb193-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Part dans l&#39;inertie totale en %&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>), <span class="at">xaxp =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>,<span class="dv">14</span>))</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Plot_inertie_bis-2.svg" width="672" />
On voit que les graphiques sont assez proche, qu’ils soient construits à partir de la mesure en valeur absolue ou en valeur relative.</p>
<p>Enfin, à savoir que des fonctions existent qui donnent une indication de la “meilleure” partition à choisir, mais attention le choix se fait aussi (et peut-être surtout) en fonction de l’analyse que l’on veut mener et de l’interprétation que l’on pourra faire des classes obtenues ! Pour l’exemple, je vous mets ci-dessous le code de Julien Larmarange pour tester ce type de fonctions ; la “meilleure” partition selon la perte d’inertie relative est représentée par un point noir et la seconde par un point gris. On voit qu’ici il est bien indiqué d’abord 2 classes, puis comme seconde “meilleure” partition 3 classes, ce qui correspond plutôt bien au premier graphique qu’on avait construit.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="15-Clustering-application.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb194-2"><a href="15-Clustering-application.html#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">url</span>(<span class="st">&quot;https://raw.githubusercontent.com/larmarange/JLutils/master/R/clustering.R&quot;</span>))</span>
<span id="cb194-3"><a href="15-Clustering-application.html#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="co">#On a choisit un maximum de 15 classes ici...</span></span>
<span id="cb194-4"><a href="15-Clustering-application.html#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="fu">best.cutree</span>(classif_socioprof_n, <span class="at">min=</span><span class="dv">2</span>, <span class="at">max=</span><span class="dv">15</span>, <span class="at">graph =</span> <span class="cn">TRUE</span>, </span>
<span id="cb194-5"><a href="15-Clustering-application.html#cb194-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab =</span> <span class="st">&quot;Nombre de classes&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Inertie relative&quot;</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Best_cutree-1.svg" width="672" /></p>
<pre><code>[1] 2</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="15-Clustering-application.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">best.cutree</span>(classif_socioprof_p, <span class="at">min=</span><span class="dv">2</span>, <span class="at">max=</span><span class="dv">15</span>, <span class="at">graph =</span> <span class="cn">TRUE</span>, </span>
<span id="cb196-2"><a href="15-Clustering-application.html#cb196-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab =</span> <span class="st">&quot;Nombre de classes&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Inertie relative&quot;</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Best_cutree-2.svg" width="672" /></p>
<pre><code>[1] 2</code></pre>
<p>Finalement, au vu de la forme du dendogramme et des graphes sur l’inertie (et de la fonction d’aide à la décision précédente), on choisit de prendre 4 classes pour une analyse plus fine, mais on va stocker également les résultats pour 2 classes pour les 2 analyses, et pour 3 classes pour la seconde. On peut de nouveau visualiser le dendogramme en matérialisant les différents choix du nombre de classes.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="15-Clustering-application.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb198-2"><a href="15-Clustering-application.html#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(classif_socioprof_n, <span class="at">xlab=</span><span class="st">&quot;IRIS&quot;</span>,  <span class="at">main=</span><span class="st">&quot;Dendogramme&quot;</span>, <span class="at">label=</span><span class="cn">FALSE</span>)</span>
<span id="cb198-3"><a href="15-Clustering-application.html#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(classif_socioprof_n, <span class="at">k=</span><span class="dv">2</span>, <span class="at">border =</span> <span class="st">&#39;blue3&#39;</span>)</span>
<span id="cb198-4"><a href="15-Clustering-application.html#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(classif_socioprof_n, <span class="at">k=</span><span class="dv">4</span>, <span class="at">border =</span> <span class="st">&#39;brown3&#39;</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Choix_cut-1.svg" width="672" /></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="15-Clustering-application.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On peut aussi couper l&#39;arbre vers la hauteur en ajoutant une ligne sur le graphe </span></span>
<span id="cb199-2"><a href="15-Clustering-application.html#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="co"># avec la fonction `abline`  et l&#39;option `h = 21` pour le graphe précédent :</span></span>
<span id="cb199-3"><a href="15-Clustering-application.html#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="co"># abline(h = 21, col = &#39;darkred&#39;)</span></span>
<span id="cb199-4"><a href="15-Clustering-application.html#cb199-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-5"><a href="15-Clustering-application.html#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb199-6"><a href="15-Clustering-application.html#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(classif_socioprof_p, <span class="at">xlab=</span><span class="st">&quot;IRIS&quot;</span>,  <span class="at">main=</span><span class="st">&quot;Dendogramme&quot;</span>, <span class="at">label=</span><span class="cn">FALSE</span>)</span>
<span id="cb199-7"><a href="15-Clustering-application.html#cb199-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(classif_socioprof_p, <span class="at">k=</span><span class="dv">2</span>, <span class="at">border =</span> <span class="st">&#39;blue3&#39;</span>)</span>
<span id="cb199-8"><a href="15-Clustering-application.html#cb199-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(classif_socioprof_p, <span class="at">k=</span><span class="dv">3</span>, <span class="at">border =</span> <span class="st">&#39;brown3&#39;</span>)</span>
<span id="cb199-9"><a href="15-Clustering-application.html#cb199-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(classif_socioprof_p, <span class="at">k=</span><span class="dv">4</span>, <span class="at">border =</span> <span class="st">&#39;chartreuse3&#39;</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Choix_cut-2.svg" width="672" /></p>
<p>On peut également utiliser la fonction <code>color_branches()</code> du package <code>dendextend()</code>, mais il faut appeler de nouveau <code>ggplot2</code> après.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="15-Clustering-application.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On peut encore également utiliser la fonction `color_branches()` du package `dendextend()`</span></span>
<span id="cb200-2"><a href="15-Clustering-application.html#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mais il faut appeler de nouveau `ggplot2` après</span></span>
<span id="cb200-3"><a href="15-Clustering-application.html#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dendextend)</span>
<span id="cb200-4"><a href="15-Clustering-application.html#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb200-5"><a href="15-Clustering-application.html#cb200-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">color_branches</span>(classif_socioprof_p, <span class="at">k =</span> <span class="dv">4</span>), <span class="at">labels =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/dendogramme%20color%C3%83%C2%A9-1.svg" width="672" /></p>
<p>On choisit donc d’abord d’analyser nos deux clustering en 3 ou 4 classes : pour découper l’arbre et obtenir la partition souhaitée, on utilise la fonction <code>cutree()</code>, et on peut ensuite visualiser quelle zone infracommunale IRIS est dans quelle classe et le nombre d’IRIS par classe.<br />
On intègre ensuite la variable au tableau initial “clust” qui contient les variables utilisées (mais on pourra ensuite fusionner la table avec notre table initiale “RP” pour mener des analyses plus approfondies des classes, y compris avec des variables non utilisées dans le clustering).</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="15-Clustering-application.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Découpage en k classes</span></span>
<span id="cb201-2"><a href="15-Clustering-application.html#cb201-2" aria-hidden="true" tabindex="-1"></a>classe4_soprof_n <span class="ot">&lt;-</span> <span class="fu">cutree</span>(classif_socioprof_n, <span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb201-3"><a href="15-Clustering-application.html#cb201-3" aria-hidden="true" tabindex="-1"></a>classe2_soprof_n <span class="ot">&lt;-</span> <span class="fu">cutree</span>(classif_socioprof_n, <span class="at">k=</span><span class="dv">2</span>)</span>
<span id="cb201-4"><a href="15-Clustering-application.html#cb201-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-5"><a href="15-Clustering-application.html#cb201-5" aria-hidden="true" tabindex="-1"></a>classe4_soprof_p <span class="ot">&lt;-</span> <span class="fu">cutree</span>(classif_socioprof_p, <span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb201-6"><a href="15-Clustering-application.html#cb201-6" aria-hidden="true" tabindex="-1"></a>classe3_soprof_p <span class="ot">&lt;-</span> <span class="fu">cutree</span>(classif_socioprof_p, <span class="at">k=</span><span class="dv">3</span>)</span>
<span id="cb201-7"><a href="15-Clustering-application.html#cb201-7" aria-hidden="true" tabindex="-1"></a>classe2_soprof_p <span class="ot">&lt;-</span> <span class="fu">cutree</span>(classif_socioprof_p, <span class="at">k=</span><span class="dv">2</span>)</span>
<span id="cb201-8"><a href="15-Clustering-application.html#cb201-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-9"><a href="15-Clustering-application.html#cb201-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Liste des groupes</span></span>
<span id="cb201-10"><a href="15-Clustering-application.html#cb201-10" aria-hidden="true" tabindex="-1"></a><span class="co">#library(janitor)</span></span>
<span id="cb201-11"><a href="15-Clustering-application.html#cb201-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(classe4_soprof_n) <span class="sc">%&gt;%</span> <span class="fu">adorn_pct_formatting</span>()</span></code></pre></div>
<pre><code># A tibble: 4 x 3
  classe4_soprof_n     n percent
             &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  
1                1    50 26.3%  
2                2    61 32.1%  
3                3    66 34.7%  
4                4    13 6.8%   </code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="15-Clustering-application.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(classe2_soprof_n) <span class="sc">%&gt;%</span> <span class="fu">adorn_pct_formatting</span>()</span></code></pre></div>
<pre><code># A tibble: 2 x 3
  classe2_soprof_n     n percent
             &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  
1                1    63 33.2%  
2                2   127 66.8%  </code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="15-Clustering-application.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(classe4_soprof_p) <span class="sc">%&gt;%</span> <span class="fu">adorn_pct_formatting</span>()</span></code></pre></div>
<pre><code># A tibble: 4 x 3
  classe4_soprof_p     n percent
             &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  
1                1    56 29.5%  
2                2    70 36.8%  
3                3    34 17.9%  
4                4    30 15.8%  </code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="15-Clustering-application.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(classe3_soprof_p) <span class="sc">%&gt;%</span> <span class="fu">adorn_pct_formatting</span>()</span></code></pre></div>
<pre><code># A tibble: 3 x 3
  classe3_soprof_p     n percent
             &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  
1                1    56 29.5%  
2                2   100 52.6%  
3                3    34 17.9%  </code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="15-Clustering-application.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(classe2_soprof_p) <span class="sc">%&gt;%</span> <span class="fu">adorn_pct_formatting</span>()</span></code></pre></div>
<pre><code># A tibble: 2 x 3
  classe2_soprof_p     n percent
             &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  
1                1   156 82.1%  
2                2    34 17.9%  </code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="15-Clustering-application.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(classe4_soprof_p) </span></code></pre></div>
<pre><code>   Folie Méricourt 1    Folie Méricourt 9   Folie Méricourt 10 
                   1                    1                    1 
  Folie Méricourt 13   Folie Méricourt 14     Saint-Ambroise 1 
                   1                    1                    1 
          Roquette 7           Roquette 8          Roquette 15 
                   1                    1                    1 
         Roquette 16          Roquette 20            Bel-Air 3 
                   1                    1                    1 
           Bel-Air 5           Bel-Air 13             Picpus 2 
                   1                    1                    1 
            Picpus 4             Picpus 6            Picpus 13 
                   1                    1                    1 
           Picpus 22              Bercy 1              Bercy 2 
                   1                    1                    1 
             Bercy 3              Bercy 4     Quinze-Vingts 10 
                   1                    1                    1 
    Quinze-Vingts 13         Belleville 1         Belleville 2 
                   1                    1                    1 
        Belleville 7         Belleville 9        Belleville 10 
                   1                    1                    1 
       Belleville 12        Belleville 13        Belleville 14 
                   1                    1                    1 
     Saint-Fargeau 2      Saint-Fargeau 6      Saint-Fargeau 8 
                   1                    1                    1 
     Saint-Fargeau 9     Saint-Fargeau 11     Saint-Fargeau 12 
                   1                    1                    1 
    Saint-Fargeau 15     Saint-Fargeau 16      Père Lachaise 2 
                   1                    1                    1 
     Père Lachaise 5      Père Lachaise 7      Père Lachaise 9 
                   1                    1                    1 
    Père Lachaise 11     Père Lachaise 12     Père Lachaise 16 
                   1                    1                    1 
          Charonne 3          Charonne 13          Charonne 16 
                   1                    1                    1 
         Charonne 17          Charonne 18          Charonne 23 
                   1                    1                    1 
         Charonne 24          Charonne 25    Folie Méricourt 2 
                   1                    1                    2 
   Folie Méricourt 3    Folie Méricourt 4    Folie Méricourt 5 
                   2                    2                    2 
   Folie Méricourt 6    Folie Méricourt 7    Folie Méricourt 8 
                   2                    2                    2 
  Folie Méricourt 15     Saint-Ambroise 2     Saint-Ambroise 3 
                   2                    2                    2 
    Saint-Ambroise 4     Saint-Ambroise 5     Saint-Ambroise 6 
                   2                    2                    2 
    Saint-Ambroise 9    Saint-Ambroise 11    Saint-Ambroise 13 
                   2                    2                    2 
   Saint-Ambroise 14           Roquette 4           Roquette 5 
                   2                    2                    2 
          Roquette 6          Roquette 10          Roquette 11 
                   2                    2                    2 
         Roquette 12          Roquette 13          Roquette 14 
                   2                    2                    2 
         Roquette 17          Roquette 18          Roquette 21 
                   2                    2                    2 
 Sainte-Marguerite 1  Sainte-Marguerite 2  Sainte-Marguerite 3 
                   2                    2                    2 
 Sainte-Marguerite 4  Sainte-Marguerite 5  Sainte-Marguerite 6 
                   2                    2                    2 
 Sainte-Marguerite 7  Sainte-Marguerite 9 Sainte-Marguerite 11 
                   2                    2                    2 
Sainte-Marguerite 13            Bel-Air 2            Bel-Air 4 
                   2                    2                    2 
           Bel-Air 6            Bel-Air 8            Bel-Air 9 
                   2                    2                    2 
            Picpus 1             Picpus 5            Picpus 10 
                   2                    2                    2 
           Picpus 11            Picpus 12            Picpus 17 
                   2                    2                    2 
           Picpus 21      Quinze-Vingts 1      Quinze-Vingts 3 
                   2                    2                    2 
     Quinze-Vingts 4      Quinze-Vingts 5      Quinze-Vingts 6 
                   2                    2                    2 
     Quinze-Vingts 7      Quinze-Vingts 9         Belleville 4 
                   2                    2                    2 
        Belleville 6      Saint-Fargeau 7      Père Lachaise 1 
                   2                    2                    2 
     Père Lachaise 3     Père Lachaise 13     Père Lachaise 14 
                   2                    2                    2 
    Père Lachaise 15           Charonne 2           Charonne 5 
                   2                    2                    2 
         Charonne 14          Charonne 15          Charonne 26 
                   2                    2                    2 
  Folie Méricourt 11   Folie Méricourt 12           Roquette 1 
                   3                    3                    3 
          Roquette 3          Roquette 19            Bel-Air 1 
                   3                    3                    3 
          Bel-Air 10           Bel-Air 11             Picpus 9 
                   3                    3                    3 
             Bercy 5      Quinze-Vingts 2     Quinze-Vingts 12 
                   3                    3                    3 
        Belleville 3         Belleville 5         Belleville 8 
                   3                    3                    3 
       Belleville 11      Saint-Fargeau 1      Saint-Fargeau 3 
                   3                    3                    3 
     Saint-Fargeau 4     Saint-Fargeau 10     Saint-Fargeau 13 
                   3                    3                    3 
     Père Lachaise 6      Père Lachaise 8     Père Lachaise 10 
                   3                    3                    3 
          Charonne 1           Charonne 7           Charonne 8 
                   3                    3                    3 
          Charonne 9          Charonne 10          Charonne 11 
                   3                    3                    3 
         Charonne 12          Charonne 19          Charonne 20 
                   3                    3                    3 
         Charonne 21     Saint-Ambroise 7     Saint-Ambroise 8 
                   3                    4                    4 
   Saint-Ambroise 10    Saint-Ambroise 12           Roquette 2 
                   4                    4                    4 
          Roquette 9  Sainte-Marguerite 8 Sainte-Marguerite 10 
                   4                    4                    4 
Sainte-Marguerite 12            Bel-Air 7           Bel-Air 12 
                   4                    4                    4 
          Bel-Air 14             Picpus 3             Picpus 8 
                   4                    4                    4 
           Picpus 14            Picpus 15            Picpus 16 
                   4                    4                    4 
           Picpus 18            Picpus 19            Picpus 20 
                   4                    4                    4 
           Picpus 23            Picpus 24              Bercy 7 
                   4                    4                    4 
     Quinze-Vingts 8      Saint-Fargeau 5     Saint-Fargeau 14 
                   4                    4                    4 
     Père Lachaise 4           Charonne 4           Charonne 6 
                   4                    4                    4 
         Charonne 22 
                   4 </code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="15-Clustering-application.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ajout des variables de classe dans la table initiale de clustering</span></span>
<span id="cb213-2"><a href="15-Clustering-application.html#cb213-2" aria-hidden="true" tabindex="-1"></a>clust_socioprof_n_cl <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(clust, <span class="at">classe4_soprof_n=</span><span class="fu">as.factor</span>(classe4_soprof_n),</span>
<span id="cb213-3"><a href="15-Clustering-application.html#cb213-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">classe2_soprof_n=</span><span class="fu">as.factor</span>(classe2_soprof_n))</span>
<span id="cb213-4"><a href="15-Clustering-application.html#cb213-4" aria-hidden="true" tabindex="-1"></a>clust_socioprof_p_cl <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(clust, <span class="at">classe4_soprof_p=</span><span class="fu">as.factor</span>(classe4_soprof_p),</span>
<span id="cb213-5"><a href="15-Clustering-application.html#cb213-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">classe3_soprof_p=</span><span class="fu">as.factor</span>(classe3_soprof_p),</span>
<span id="cb213-6"><a href="15-Clustering-application.html#cb213-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">classe2_soprof_p=</span><span class="fu">as.factor</span>(classe2_soprof_p))</span></code></pre></div>
</div>
<div id="visualisation-sur-la-carte-de-la-commune" class="section level3 hasAnchor" number="15.2.2">
<h3><span class="header-section-number">15.2.2</span> Visualisation sur la carte de la commune<a href="15-Clustering-application.html#visualisation-sur-la-carte-de-la-commune" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Enfin, on peut visualiser sur la carte de la commune - ici 3 arrondissement de Paris - les trois classes construites et choisies.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="15-Clustering-application.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geojsonsf)</span>
<span id="cb214-2"><a href="15-Clustering-application.html#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb214-3"><a href="15-Clustering-application.html#cb214-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapsf)</span>
<span id="cb214-4"><a href="15-Clustering-application.html#cb214-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-5"><a href="15-Clustering-application.html#cb214-5" aria-hidden="true" tabindex="-1"></a>map_iris <span class="ot">&lt;-</span> <span class="fu">geojson_sf</span>(<span class="st">&quot;data/iris.geojson&quot;</span>) <span class="co"># on charge le fonds de carte des IRIS</span></span>
<span id="cb214-6"><a href="15-Clustering-application.html#cb214-6" aria-hidden="true" tabindex="-1"></a>map_arrdt <span class="ot">&lt;-</span> <span class="fu">geojson_sf</span>(<span class="st">&quot;data/arrondissements.geojson&quot;</span>) <span class="co"># on charge le fonds de carte des arrdts de Paris</span></span>
<span id="cb214-7"><a href="15-Clustering-application.html#cb214-7" aria-hidden="true" tabindex="-1"></a>map_iris <span class="ot">&lt;-</span> map_iris <span class="sc">%&gt;%</span> </span>
<span id="cb214-8"><a href="15-Clustering-application.html#cb214-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(insee_com <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;75111&quot;</span>, <span class="st">&quot;75112&quot;</span>, <span class="st">&quot;75120&quot;</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb214-9"><a href="15-Clustering-application.html#cb214-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">code_iris =</span> <span class="fu">as.character</span>(code_iris)) <span class="sc">%&gt;%</span> </span>
<span id="cb214-10"><a href="15-Clustering-application.html#cb214-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">IRIS =</span> code_iris) <span class="sc">%&gt;%</span></span>
<span id="cb214-11"><a href="15-Clustering-application.html#cb214-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(IRIS, nom_iris, typ_iris, nom_com, geometry)</span>
<span id="cb214-12"><a href="15-Clustering-application.html#cb214-12" aria-hidden="true" tabindex="-1"></a>map_arrdt <span class="ot">&lt;-</span> map_arrdt <span class="sc">%&gt;%</span> </span>
<span id="cb214-13"><a href="15-Clustering-application.html#cb214-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(c_arinsee <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;75111&quot;</span>, <span class="st">&quot;75112&quot;</span>, <span class="st">&quot;75120&quot;</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb214-14"><a href="15-Clustering-application.html#cb214-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c_arinsee =</span> <span class="fu">as.character</span>(c_arinsee)) <span class="sc">%&gt;%</span> </span>
<span id="cb214-15"><a href="15-Clustering-application.html#cb214-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(c_arinsee, geometry)</span>
<span id="cb214-16"><a href="15-Clustering-application.html#cb214-16" aria-hidden="true" tabindex="-1"></a>coord <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(map_iris))</span>
<span id="cb214-17"><a href="15-Clustering-application.html#cb214-17" aria-hidden="true" tabindex="-1"></a>map_iris <span class="ot">&lt;-</span> <span class="fu">cbind</span>(map_iris, coord)</span>
<span id="cb214-18"><a href="15-Clustering-application.html#cb214-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-19"><a href="15-Clustering-application.html#cb214-19" aria-hidden="true" tabindex="-1"></a>clust_map_socioprof_n <span class="ot">&lt;-</span> clust_socioprof_n_cl <span class="sc">%&gt;%</span></span>
<span id="cb214-20"><a href="15-Clustering-application.html#cb214-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(IRIS, classe4_soprof_n) <span class="sc">%&gt;%</span></span>
<span id="cb214-21"><a href="15-Clustering-application.html#cb214-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(map_iris)</span>
<span id="cb214-22"><a href="15-Clustering-application.html#cb214-22" aria-hidden="true" tabindex="-1"></a>clust_map_socioprof_n <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(clust_map_socioprof_n)</span>
<span id="cb214-23"><a href="15-Clustering-application.html#cb214-23" aria-hidden="true" tabindex="-1"></a><span class="fu">mf_theme</span>(<span class="st">&quot;agolalight&quot;</span>)</span>
<span id="cb214-24"><a href="15-Clustering-application.html#cb214-24" aria-hidden="true" tabindex="-1"></a><span class="fu">mf_map</span>(clust_map_socioprof_n, <span class="at">type=</span><span class="st">&quot;typo&quot;</span>, <span class="at">var=</span><span class="st">&quot;classe4_soprof_n&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightyellow&quot;</span>, </span>
<span id="cb214-25"><a href="15-Clustering-application.html#cb214-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">border=</span><span class="st">&quot;gray80&quot;</span>, <span class="at">lwd=</span><span class="fl">0.4</span>, <span class="at">pal =</span> <span class="fu">c</span>(<span class="st">&quot;aquamarine3&quot;</span>, <span class="st">&quot;coral&quot;</span>, <span class="st">&quot;skyblue3&quot;</span>, <span class="st">&quot;hotpink3&quot;</span>),</span>
<span id="cb214-26"><a href="15-Clustering-application.html#cb214-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">leg_pos =</span> <span class="st">&quot;bottomleft&quot;</span>, <span class="at">leg_title=</span><span class="st">&quot;Cluster&quot;</span>)</span>
<span id="cb214-27"><a href="15-Clustering-application.html#cb214-27" aria-hidden="true" tabindex="-1"></a><span class="fu">mf_map</span>(map_arrdt,  <span class="at">type =</span> <span class="st">&quot;base&quot;</span>, <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">border=</span><span class="st">&quot;gray41&quot;</span>,<span class="at">lwd=</span><span class="dv">1</span>,</span>
<span id="cb214-28"><a href="15-Clustering-application.html#cb214-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb214-29"><a href="15-Clustering-application.html#cb214-29" aria-hidden="true" tabindex="-1"></a><span class="fu">mf_layout</span>(<span class="at">title =</span> <span class="st">&quot;Quartiers de l&#39;Est parisien découpés selon le cluster obtenu&quot;</span>, </span>
<span id="cb214-30"><a href="15-Clustering-application.html#cb214-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">credits=</span><span class="st">&quot; &quot;</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/carto_clust-1.svg" width="672" /></p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="15-Clustering-application.html#cb215-1" aria-hidden="true" tabindex="-1"></a>clust_map_socioprof_p <span class="ot">&lt;-</span> clust_socioprof_p_cl <span class="sc">%&gt;%</span></span>
<span id="cb215-2"><a href="15-Clustering-application.html#cb215-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(IRIS, classe4_soprof_p) <span class="sc">%&gt;%</span></span>
<span id="cb215-3"><a href="15-Clustering-application.html#cb215-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(map_iris)</span>
<span id="cb215-4"><a href="15-Clustering-application.html#cb215-4" aria-hidden="true" tabindex="-1"></a>clust_map_socioprof_p <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(clust_map_socioprof_p)</span>
<span id="cb215-5"><a href="15-Clustering-application.html#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mf_theme</span>(<span class="st">&quot;agolalight&quot;</span>)</span>
<span id="cb215-6"><a href="15-Clustering-application.html#cb215-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mf_map</span>(clust_map_socioprof_p, <span class="at">type=</span><span class="st">&quot;typo&quot;</span>, <span class="at">var=</span><span class="st">&quot;classe4_soprof_p&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightyellow&quot;</span>, </span>
<span id="cb215-7"><a href="15-Clustering-application.html#cb215-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">border=</span><span class="st">&quot;gray80&quot;</span>, <span class="at">lwd=</span><span class="fl">0.4</span>, <span class="at">pal =</span> <span class="fu">c</span>(<span class="st">&quot;aquamarine3&quot;</span>, <span class="st">&quot;coral&quot;</span>, <span class="st">&quot;skyblue3&quot;</span>, <span class="st">&quot;hotpink3&quot;</span>),</span>
<span id="cb215-8"><a href="15-Clustering-application.html#cb215-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">leg_pos =</span> <span class="st">&quot;bottomleft&quot;</span>, <span class="at">leg_title=</span><span class="st">&quot;Cluster&quot;</span>)</span>
<span id="cb215-9"><a href="15-Clustering-application.html#cb215-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mf_map</span>(map_arrdt,  <span class="at">type =</span> <span class="st">&quot;base&quot;</span>, <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">border=</span><span class="st">&quot;gray41&quot;</span>,<span class="at">lwd=</span><span class="dv">1</span>,</span>
<span id="cb215-10"><a href="15-Clustering-application.html#cb215-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb215-11"><a href="15-Clustering-application.html#cb215-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mf_layout</span>(<span class="at">title =</span> <span class="st">&quot;Quartiers de l&#39;Est parisien découpés selon le cluster obtenu&quot;</span>, </span>
<span id="cb215-12"><a href="15-Clustering-application.html#cb215-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">credits=</span><span class="st">&quot; &quot;</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/carto_clust-2.svg" width="672" />
On voit d’ores et déjà que les 2 cartes diffèrent pas mal, le 2nd clustering semble rassembler des quartiers proches géographiquement ce qui peut aider à l’interprétation ensuite, alors que pour le 1er clustering rien n’apparaît “comme ça”, ce qui peut confirmer un effet “nombre” d’habitants avant toute autre chose ; mais il nous reste à comprendre les classes, c’est-à-dire à les interpréter, à partir des variables mises en <em>input</em> dans un premier temps.</p>
</div>
<div id="interprétation" class="section level3 hasAnchor" number="15.2.3">
<h3><span class="header-section-number">15.2.3</span> Interprétation<a href="15-Clustering-application.html#interprétation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il faut maintenant comprendre la partition obtenue et interpréter nos 4 classes en les décrivant d’abord à partir des variables utilisées dans le clustering. On peut pour cela utiliser le package <code>FactoMiner</code> qui permet avec la fonction <code>catdes</code> de sortir des résultats sur, d’une part, les liens les plus significatifs entre les variables actives de la CAH et la variable globale de cluster/classes, et, d’autre part de manière plus précise, sur les liens les plus significatifs entre les variables et chacune des classes.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="15-Clustering-application.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb216-2"><a href="15-Clustering-application.html#cb216-2" aria-hidden="true" tabindex="-1"></a>desc_cl_soprof_n <span class="ot">&lt;-</span> <span class="fu">catdes</span>(clust_socioprof_n_cl[, <span class="fu">c</span>(<span class="st">&quot;nbCS_1&quot;</span>, <span class="st">&quot;nbCS_2&quot;</span>, <span class="st">&quot;nbCS_3&quot;</span>,</span>
<span id="cb216-3"><a href="15-Clustering-application.html#cb216-3" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;nbCS_4&quot;</span>, <span class="st">&quot;nbCS_5&quot;</span>,  <span class="st">&quot;nbCS_6&quot;</span>,</span>
<span id="cb216-4"><a href="15-Clustering-application.html#cb216-4" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;nbCS_7&quot;</span>, <span class="st">&quot;nbCS_8&quot;</span>,</span>
<span id="cb216-5"><a href="15-Clustering-application.html#cb216-5" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;Nbactivite_chômeurs&quot;</span>, <span class="st">&quot;nbimmi&quot;</span>,</span>
<span id="cb216-6"><a href="15-Clustering-application.html#cb216-6" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;nb_Femme&quot;</span>, <span class="st">&quot;classe4_soprof_n&quot;</span>)], </span>
<span id="cb216-7"><a href="15-Clustering-application.html#cb216-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">num.var =</span> <span class="dv">12</span>)</span>
<span id="cb216-8"><a href="15-Clustering-application.html#cb216-8" aria-hidden="true" tabindex="-1"></a>desc_cl_soprof_n</span></code></pre></div>
<pre><code>
Link between the cluster variable and the quantitative variables
================================================================
                         Eta2      P-value
nbCS_6              0.6960796 7.201720e-48
nbCS_5              0.6886940 6.682408e-47
nbimmi              0.6774716 1.785674e-45
Nbactivite_chômeurs 0.6683361 2.382425e-44
nb_Femme            0.6426751 2.391105e-41
nbCS_8              0.5800621 7.551910e-35
nbCS_4              0.5594484 6.394892e-33
nbCS_3              0.4089195 4.080394e-21
nbCS_2              0.3680380 1.947864e-18
nbCS_7              0.3494926 2.798078e-17

Description of each cluster by quantitative variables
=====================================================
$`1`
                      v.test Mean in category Overall mean sd in category
nbCS_4              8.511019           479.34    356.04211       83.06205
nbCS_3              8.333854           893.20    632.62105      189.58871
nb_Femme            8.129340          1744.76   1332.15789      313.35798
nbCS_2              7.874702            91.74     65.95789       19.47286
nbCS_7              7.303216           555.80    401.92632      185.55689
Nbactivite_chômeurs 4.739070           218.76    176.06842       50.23288
nbimmi              4.035185           579.76    481.73158      116.19631
nbCS_8              3.793813           808.48    679.51579      205.19115
nbCS_5              3.303554           336.14    284.07368       75.92760
                    Overall sd      p.value
nbCS_4               119.02166 1.724121e-17
nbCS_3               256.88888 7.825225e-17
nb_Femme             416.99232 4.316354e-16
nbCS_2                26.89900 3.415547e-15
nbCS_7               173.10199 2.809687e-13
Nbactivite_chômeurs   74.01181 2.147018e-06
nbimmi               199.59078 5.455937e-05
nbCS_8               279.28342 1.483513e-04
nbCS_5               129.48735 9.546762e-04

$`2`
            v.test Mean in category Overall mean sd in category Overall sd
nbCS_6    2.448080        120.65574    104.54737       37.96370   62.20522
nbCS_7   -2.619208        353.96721    401.92632      112.75317  173.10199
nb_Femme -2.643464       1215.55738   1332.15789      193.30470  416.99232
nbCS_4   -2.836719        320.32787    356.04211       74.64094  119.02166
nbCS_2   -3.442098         56.16393     65.95789       19.73694   26.89900
nbCS_3   -5.894673        472.44262    632.62105      196.78894  256.88888
              p.value
nbCS_6   1.436196e-02
nbCS_7   8.813426e-03
nb_Femme 8.206251e-03
nbCS_4   4.557970e-03
nbCS_2   5.772217e-04
nbCS_3   3.754251e-09

$`3`
                       v.test Mean in category Overall mean sd in category
nbCS_2              -4.639509         53.51515     65.95789       23.45676
nbCS_7              -5.275433        310.87879    401.92632      115.24092
nbCS_4              -7.126802        271.46970    356.04211       62.94038
nb_Femme            -7.832590       1006.51515   1332.15789      195.15202
nbCS_6              -8.125685         54.15152    104.54737       22.21264
nbCS_8              -8.331202        447.53030    679.51579      103.97963
nbCS_5              -8.423953        175.31818    284.07368       50.98192
nbimmi              -8.756972        307.46970    481.73158       78.74955
Nbactivite_chômeurs -8.836300        110.86364    176.06842       29.29158
                    Overall sd      p.value
nbCS_2                26.89900 3.492373e-06
nbCS_7               173.10199 1.324429e-07
nbCS_4               119.02166 1.027275e-12
nb_Femme             416.99232 4.779222e-15
nbCS_6                62.20522 4.448435e-16
nbCS_8               279.28342 8.002534e-17
nbCS_5               129.48735 3.639908e-17
nbimmi               199.59078 2.005660e-18
Nbactivite_chômeurs   74.01181 9.894055e-19

$`4`
                      v.test Mean in category Overall mean sd in category
nbCS_6              9.495095         263.0769     104.5474       62.26057
nbCS_5              9.006114         597.0769     284.0737      124.42573
nbimmi              8.402307         931.8462     481.7316      190.32961
Nbactivite_chômeurs 7.942562         333.8462     176.0684       77.55479
nbCS_8              7.561264        1246.3077     679.5158      285.17427
nb_Femme            5.481158        1945.6154    1332.1579      402.16674
nbCS_4              3.841762         478.7692     356.0421      135.73286
nbCS_7              2.054601         497.3846     401.9263      159.29920
                    Overall sd      p.value
nbCS_6                62.20522 2.200100e-21
nbCS_5               129.48735 2.134873e-19
nbimmi               199.59078 4.377919e-17
Nbactivite_chômeurs   74.01181 1.980467e-15
nbCS_8               279.28342 3.991697e-14
nb_Femme             416.99232 4.225497e-08
nbCS_4               119.02166 1.221541e-04
nbCS_7               173.10199 3.991752e-02</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="15-Clustering-application.html#cb218-1" aria-hidden="true" tabindex="-1"></a>clust_socioprof_p_cl <span class="ot">&lt;-</span> clust_socioprof_p_cl <span class="sc">%&gt;%</span> </span>
<span id="cb218-2"><a href="15-Clustering-application.html#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pctCS_2 =</span> (nbCS_2 <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb218-3"><a href="15-Clustering-application.html#cb218-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctCS_3 =</span> (nbCS_3 <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb218-4"><a href="15-Clustering-application.html#cb218-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctCS_4 =</span> (nbCS_4 <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb218-5"><a href="15-Clustering-application.html#cb218-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctCS_5 =</span> (nbCS_5 <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb218-6"><a href="15-Clustering-application.html#cb218-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctCS_6 =</span> (nbCS_6 <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb218-7"><a href="15-Clustering-application.html#cb218-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctCS_7 =</span> (nbCS_7 <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb218-8"><a href="15-Clustering-application.html#cb218-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctCS_8 =</span> (nbCS_8 <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb218-9"><a href="15-Clustering-application.html#cb218-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctFemme =</span> (nb_Femme <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb218-10"><a href="15-Clustering-application.html#cb218-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctChomeurs =</span> (Nbactivite_chômeurs <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb218-11"><a href="15-Clustering-application.html#cb218-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">pctImmi =</span> (nbimmi <span class="sc">/</span> nbhab)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb218-12"><a href="15-Clustering-application.html#cb218-12" aria-hidden="true" tabindex="-1"></a>desc_cl_soprof_p <span class="ot">&lt;-</span> <span class="fu">catdes</span>(clust_socioprof_p_cl[, <span class="fu">c</span>(<span class="st">&quot;pctFemme&quot;</span>, <span class="st">&quot;pctCS_2&quot;</span>, <span class="st">&quot;pctCS_3&quot;</span>,</span>
<span id="cb218-13"><a href="15-Clustering-application.html#cb218-13" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;pctCS_4&quot;</span>, <span class="st">&quot;pctCS_5&quot;</span>, <span class="st">&quot;pctCS_6&quot;</span>,</span>
<span id="cb218-14"><a href="15-Clustering-application.html#cb218-14" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;pctCS_7&quot;</span>, <span class="st">&quot;pctCS_8&quot;</span>, <span class="st">&quot;pctChomeurs&quot;</span>,</span>
<span id="cb218-15"><a href="15-Clustering-application.html#cb218-15" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;pctImmi&quot;</span>, <span class="st">&quot;classe4_soprof_p&quot;</span>)], </span>
<span id="cb218-16"><a href="15-Clustering-application.html#cb218-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">num.var =</span> <span class="dv">11</span>)</span>
<span id="cb218-17"><a href="15-Clustering-application.html#cb218-17" aria-hidden="true" tabindex="-1"></a>desc_cl_soprof_p</span></code></pre></div>
<pre><code>
Link between the cluster variable and the quantitative variables
================================================================
                 Eta2      P-value
pctCS_3     0.7647355 3.432889e-58
pctCS_5     0.6607962 1.916490e-43
pctCS_8     0.5887787 1.081556e-35
pctImmi     0.5727208 3.761147e-34
pctCS_6     0.5583309 8.085891e-33
pctChomeurs 0.4315332 1.113099e-22
pctCS_7     0.3936732 4.278129e-20
pctCS_4     0.2795122 3.363215e-13
pctCS_2     0.2157313 7.921359e-10

Description of each cluster by quantitative variables
=====================================================
$`1`
           v.test Mean in category Overall mean sd in category Overall sd
pctCS_8  3.496347        28.843887    26.559051       4.020296   5.807818
pctCS_6  2.372088         4.666205     4.118972       1.658351   2.050281
pctCS_3 -2.217340        23.388311    25.467226       3.799921   8.332533
pctCS_7 -2.802379        14.380390    15.907889       4.234965   4.844249
             p.value
pctCS_8 0.0004716745
pctCS_6 0.0176878689
pctCS_3 0.0265998823
pctCS_7 0.0050727308

$`2`
               v.test Mean in category Overall mean sd in category Overall sd
pctCS_3      8.370577        32.109903    25.467226      3.6436221  8.3325328
pctCS_4      5.697422        15.454414    14.148069      2.1100299  2.4075139
pctCS_2      4.347652         2.987978     2.632583      0.9175264  0.8583154
pctChomeurs -2.100574         6.550817     6.921285      1.3378948  1.8518333
pctCS_7     -4.073130        14.028722    15.907889      2.4593982  4.8442486
pctCS_5     -5.494399         9.401907    11.161953      1.9254399  3.3635133
pctCS_6     -5.571645         3.031026     4.118972      1.0087489  2.0502815
pctImmi     -5.575297        16.110896    19.106201      2.7449134  5.6410816
pctCS_8     -6.485206        22.971918    26.559051      2.9131675  5.8078180
                 p.value
pctCS_3     5.733678e-17
pctCS_4     1.216325e-08
pctCS_2     1.376026e-05
pctChomeurs 3.567839e-02
pctCS_7     4.638549e-05
pctCS_5     3.920434e-08
pctCS_6     2.523452e-08
pctImmi     2.471081e-08
pctCS_8     8.861046e-11

$`3`
                v.test Mean in category Overall mean sd in category Overall sd
pctCS_5      10.228696        16.522454    11.161953      2.5021858  3.3635133
pctImmi       9.322733        27.300231    19.106201      4.1472642  5.6410816
pctCS_6       8.738647         6.910549     4.118972      1.7033525  2.0502815
pctCS_8       8.407635        34.167196    26.559051      5.1512533  5.8078180
pctChomeurs   8.022925         9.236155     6.921285      1.5341143  1.8518333
pctCS_4      -4.705981        12.382800    14.148069      2.5052311  2.4075139
pctCS_2      -5.812283         1.855288     2.632583      0.5870463  0.8583154
pctCS_3     -10.499413        11.836029    25.467226      4.8492740  8.3325328
                 p.value
pctCS_5     1.474919e-24
pctImmi     1.133817e-20
pctCS_6     2.359195e-18
pctCS_8     4.183605e-17
pctChomeurs 1.032567e-15
pctCS_4     2.526481e-06
pctCS_2     6.162671e-09
pctCS_3     8.691878e-26

$`4`
               v.test Mean in category Overall mean sd in category Overall sd
pctCS_7      8.308714        22.669165    15.907889      4.1154615   4.844249
pctCS_3      2.736057        29.296978    25.467226      4.3441065   8.332533
pctFemme     2.052770        53.481634    52.675916      2.1180857   2.336547
pctCS_4     -3.971486        12.541903    14.148069      1.2997615   2.407514
pctImmi     -4.310565        15.021456    19.106201      3.0213388   5.641082
pctCS_8     -4.630498        22.041437    26.559051      2.7932936   5.807818
pctCS_5     -4.771516         8.465965    11.161953      1.8611696   3.363513
pctCS_6     -4.781284         2.472227     4.118972      0.9810427   2.050281
pctChomeurs -5.547852         5.195466     6.921285      1.1820873   1.851833
                 p.value
pctCS_7     9.674498e-17
pctCS_3     6.218021e-03
pctFemme    4.009490e-02
pctCS_4     7.142578e-05
pctImmi     1.628381e-05
pctCS_8     3.647872e-06
pctCS_5     1.828449e-06
pctCS_6     1.741795e-06
pctChomeurs 2.892003e-08</code></pre>
<p>Pour le 1er clustering, on peut voir que la 1ère classe est marquée par une surreprésentation du nombre de professions intermédiaires et de cadres, ainsi que de femmes, d’artisans/commerçants/chefs d’entreprises, de retraités, mais aussi dans une moindre mesure de chômeurs, d’immigrés, d’autres inactifs et d’employés. Au contraire, la 2ème classe se caractérise par une surreprésentation des ouvriers, et ensuite une sous-représentation des retraités, des femmes, des employés, des artisans/commerçants/chefs d’entreprises et des cadres. La 3ème classe est particulière car elle est marquée par une sous-représentation de l’ensemble ou presque des variables. Et enfin, la classe 4 est marquée par une surreprésentation du nombre d’ouvriers et d’employés, ainsi que d’immigrés et de chômeurs, puis d’autres inactifs, de femmes, de professions intermédiaires et de retraités.</p>
<p>Pour la 2ème typo, la 1ère classe est caractérisée par une surreprésentation des CS d’autres inactifs et d’ouvriers et une sous-représentation des cadres et retraités ; sur la carte elle correspond à des quartiers particuliers car on retrouve le cimetière du Père Lachaise, le parc de Bercy - il aurait fallu peut-être retirer ces quartiers également en plus du Bois de Vincennes…, sinon ce sont d’autres quartiers principalement du 20ème et dans une moindre mesure du 12ème. Quant à la 2ème classe, elle est marquée par une surreprésentation des CS de cadres, professions intermédiaires et artisans/commerçants/chefs d’entreprises, et au contraire par une sous-représentation des chômeurs, immigrés et des autres CS ; elle correspond par ailleurs principalement aux quartiers du 11ème et du nord-est du 12ème arrondissement. Ensuite, la classe 3 est caractérisée par une surreprésentation des employés, immigrés, ouvriers, autres inactifs et chômeurs, et une sous-représentation des autres CS ; et on a vu sur la carte qu’elle correspondait à des quartiers situés plutôt sur les boulevards périphériques intérieurs ou dans le nord du 20ème arrondissement. Enfin, la classe 4 est caractérisée par une surreprésentation des retraités, des cadres et des femmes, ses principaux IRIS se situent dans le 12ème.<br />
Cette typologie semble ainsi plus claire, la classe 2 correspond plutôt aux quartiers des catégories sociales supérieures ou moyennes-supérieures (professions intermédiaires), la classe 4 aux quartiers plutôt avec des retraités mais aussi des cadres ou encore des femmes, ces deux classes s’opposent semble-t-il à la 3ème classe qui correspond plutôt aux quartiers plus modestes socialement ; la classe 1 peut rassembler les quartiers constitués des autres inactifs, comme les étudiants, et des ouvriers. Il nous faudrait nénmoins d’autres variables pour arriver à davantage les caractériser.</p>
<p>On peut recupérer les statistiques de la moyenne de ces variables pour les visualiser sur un graphique comparant les 4 classes, ainsi que l’ensemble des IRIS.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="15-Clustering-application.html#cb220-1" aria-hidden="true" tabindex="-1"></a>stats_var_CAH <span class="ot">&lt;-</span> desc_cl_soprof_p<span class="sc">$</span>call<span class="sc">$</span>X</span>
<span id="cb220-2"><a href="15-Clustering-application.html#cb220-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-3"><a href="15-Clustering-application.html#cb220-3" aria-hidden="true" tabindex="-1"></a>mean_var_CAH_a <span class="ot">&lt;-</span> stats_var_CAH <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(classe4_soprof_p) <span class="sc">%&gt;%</span> <span class="fu">summarise_all</span>(mean)</span>
<span id="cb220-4"><a href="15-Clustering-application.html#cb220-4" aria-hidden="true" tabindex="-1"></a>mean_var_CAH_b <span class="ot">&lt;-</span> stats_var_CAH <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>classe4_soprof_p) <span class="sc">%&gt;%</span> </span>
<span id="cb220-5"><a href="15-Clustering-application.html#cb220-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(mean) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">classe4_soprof_p=</span><span class="st">&quot;Ensemble&quot;</span>)</span>
<span id="cb220-6"><a href="15-Clustering-application.html#cb220-6" aria-hidden="true" tabindex="-1"></a>mean_var_CAH <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mean_var_CAH_a, mean_var_CAH_b)</span>
<span id="cb220-7"><a href="15-Clustering-application.html#cb220-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(mean_var_CAH_a, mean_var_CAH_b)</span>
<span id="cb220-8"><a href="15-Clustering-application.html#cb220-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-9"><a href="15-Clustering-application.html#cb220-9" aria-hidden="true" tabindex="-1"></a>mean_var_CAH <span class="sc">%&gt;%</span>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>classe4_soprof_p,  <span class="at">names_to=</span><span class="st">&quot;Variable&quot;</span>,</span>
<span id="cb220-10"><a href="15-Clustering-application.html#cb220-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">values_to=</span><span class="st">&quot;Value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb220-11"><a href="15-Clustering-application.html#cb220-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value=</span><span class="fu">round</span>(Value, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb220-12"><a href="15-Clustering-application.html#cb220-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span>Variable, <span class="at">y=</span>Value, <span class="at">fill=</span>classe4_soprof_p) <span class="sc">+</span> </span>
<span id="cb220-13"><a href="15-Clustering-application.html#cb220-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>classe4_soprof_p) <span class="sc">+</span>  </span>
<span id="cb220-14"><a href="15-Clustering-application.html#cb220-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb220-15"><a href="15-Clustering-application.html#cb220-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Value), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb220-16"><a href="15-Clustering-application.html#cb220-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">color=</span><span class="st">&quot;gray35&quot;</span>, <span class="at">size=</span><span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb220-17"><a href="15-Clustering-application.html#cb220-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_grey</span>() <span class="sc">+</span> </span>
<span id="cb220-18"><a href="15-Clustering-application.html#cb220-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Moyenne des variables actives selon les classes et pour l&#39;ensemble&quot;</span>, </span>
<span id="cb220-19"><a href="15-Clustering-application.html#cb220-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot; &quot;</span>, <span class="at">y=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb220-20"><a href="15-Clustering-application.html#cb220-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;% de chômeurs&quot;</span>,<span class="st">&quot;% d&#39;artisans, ...&quot;</span>, <span class="st">&quot;% de cadres&quot;</span>,</span>
<span id="cb220-21"><a href="15-Clustering-application.html#cb220-21" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;% de professions intermédiaires&quot;</span>,</span>
<span id="cb220-22"><a href="15-Clustering-application.html#cb220-22" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;% d&#39;employés&quot;</span>,<span class="st">&quot;% d&#39;ouvriers&quot;</span>,<span class="st">&quot;% de retraités&quot;</span>, </span>
<span id="cb220-23"><a href="15-Clustering-application.html#cb220-23" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;% d&#39;autres inactifs&quot;</span>,<span class="st">&quot;% de femmes&quot;</span>,<span class="st">&quot;% d&#39;immigrés&quot;</span>)) <span class="sc">+</span></span>
<span id="cb220-24"><a href="15-Clustering-application.html#cb220-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb220-25"><a href="15-Clustering-application.html#cb220-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">80</span>, <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">7</span>))</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/Compar_mean_bis-1.svg" width="672" /></p>
<p>On peut aussi construire d’autres graphiques plus généraux et sur d’autres variables.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="15-Clustering-application.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb221-2"><a href="15-Clustering-application.html#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la variable d&#39;âge : </span></span>
<span id="cb221-3"><a href="15-Clustering-application.html#cb221-3" aria-hidden="true" tabindex="-1"></a>tab_age_ens <span class="ot">&lt;-</span> clust_socioprof_p_cl <span class="sc">%&gt;%</span> </span>
<span id="cb221-4"><a href="15-Clustering-application.html#cb221-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nb_Moins18ans, nb_18<span class="fl">.29</span>ans, nb_30<span class="fl">.39</span>ans,nb_40<span class="fl">.54</span>ans,nb_55<span class="fl">.64</span>ans,nb_Plus64ans,</span>
<span id="cb221-5"><a href="15-Clustering-application.html#cb221-5" aria-hidden="true" tabindex="-1"></a>         classe4_soprof_p) <span class="sc">%&gt;%</span></span>
<span id="cb221-6"><a href="15-Clustering-application.html#cb221-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">nb_Moins18ans =</span> <span class="fu">sum</span>(nb_Moins18ans), <span class="at">nb_18.29ans=</span><span class="fu">sum</span>(nb_18<span class="fl">.29</span>ans), </span>
<span id="cb221-7"><a href="15-Clustering-application.html#cb221-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">nb_30.39ans=</span><span class="fu">sum</span>(nb_30<span class="fl">.39</span>ans), <span class="at">nb_40.54ans=</span><span class="fu">sum</span>(nb_40<span class="fl">.54</span>ans),</span>
<span id="cb221-8"><a href="15-Clustering-application.html#cb221-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">nb_55.64ans=</span><span class="fu">sum</span>(nb_55<span class="fl">.64</span>ans), <span class="at">nb_Plus64ans=</span><span class="fu">sum</span>(nb_Plus64ans)) <span class="sc">%&gt;%</span> </span>
<span id="cb221-9"><a href="15-Clustering-application.html#cb221-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_Moins18ans =</span> nb_Moins18ans <span class="sc">/</span> (nb_Moins18ans <span class="sc">+</span> nb_18<span class="fl">.29</span>ans <span class="sc">+</span> nb_30<span class="fl">.39</span>ans <span class="sc">+</span></span>
<span id="cb221-10"><a href="15-Clustering-application.html#cb221-10" aria-hidden="true" tabindex="-1"></a>                                             nb_40<span class="fl">.54</span>ans <span class="sc">+</span> nb_55<span class="fl">.64</span>ans <span class="sc">+</span> nb_Plus64ans), </span>
<span id="cb221-11"><a href="15-Clustering-application.html#cb221-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_18.29ans   =</span> nb_18<span class="fl">.29</span>ans <span class="sc">/</span> (nb_Moins18ans <span class="sc">+</span> nb_18<span class="fl">.29</span>ans <span class="sc">+</span> nb_30<span class="fl">.39</span>ans <span class="sc">+</span></span>
<span id="cb221-12"><a href="15-Clustering-application.html#cb221-12" aria-hidden="true" tabindex="-1"></a>                                           nb_40<span class="fl">.54</span>ans <span class="sc">+</span> nb_55<span class="fl">.64</span>ans <span class="sc">+</span> nb_Plus64ans),</span>
<span id="cb221-13"><a href="15-Clustering-application.html#cb221-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_30.39ans   =</span> nb_30<span class="fl">.39</span>ans <span class="sc">/</span> (nb_Moins18ans <span class="sc">+</span> nb_18<span class="fl">.29</span>ans <span class="sc">+</span> nb_30<span class="fl">.39</span>ans <span class="sc">+</span> </span>
<span id="cb221-14"><a href="15-Clustering-application.html#cb221-14" aria-hidden="true" tabindex="-1"></a>                                           nb_40<span class="fl">.54</span>ans <span class="sc">+</span> nb_55<span class="fl">.64</span>ans <span class="sc">+</span> nb_Plus64ans),</span>
<span id="cb221-15"><a href="15-Clustering-application.html#cb221-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_40.54ans   =</span> nb_40<span class="fl">.54</span>ans <span class="sc">/</span> (nb_Moins18ans <span class="sc">+</span> nb_18<span class="fl">.29</span>ans <span class="sc">+</span> nb_30<span class="fl">.39</span>ans <span class="sc">+</span> </span>
<span id="cb221-16"><a href="15-Clustering-application.html#cb221-16" aria-hidden="true" tabindex="-1"></a>                                           nb_40<span class="fl">.54</span>ans <span class="sc">+</span> nb_55<span class="fl">.64</span>ans <span class="sc">+</span> nb_Plus64ans),</span>
<span id="cb221-17"><a href="15-Clustering-application.html#cb221-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_55.64ans   =</span> nb_55<span class="fl">.64</span>ans <span class="sc">/</span> (nb_Moins18ans <span class="sc">+</span> nb_18<span class="fl">.29</span>ans <span class="sc">+</span> nb_30<span class="fl">.39</span>ans <span class="sc">+</span> </span>
<span id="cb221-18"><a href="15-Clustering-application.html#cb221-18" aria-hidden="true" tabindex="-1"></a>                                           nb_40<span class="fl">.54</span>ans <span class="sc">+</span> nb_55<span class="fl">.64</span>ans <span class="sc">+</span> nb_Plus64ans),</span>
<span id="cb221-19"><a href="15-Clustering-application.html#cb221-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_Plus64ans  =</span> nb_Plus64ans <span class="sc">/</span> (nb_Moins18ans <span class="sc">+</span> nb_18<span class="fl">.29</span>ans <span class="sc">+</span> nb_30<span class="fl">.39</span>ans <span class="sc">+</span> </span>
<span id="cb221-20"><a href="15-Clustering-application.html#cb221-20" aria-hidden="true" tabindex="-1"></a>                                            nb_40<span class="fl">.54</span>ans <span class="sc">+</span> nb_55<span class="fl">.64</span>ans <span class="sc">+</span> nb_Plus64ans),</span>
<span id="cb221-21"><a href="15-Clustering-application.html#cb221-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">classe4_soprof_p =</span> <span class="st">&quot;Ensemble&quot;</span>)</span>
<span id="cb221-22"><a href="15-Clustering-application.html#cb221-22" aria-hidden="true" tabindex="-1"></a>clust_socioprof_p_cl <span class="sc">%&gt;%</span> <span class="fu">select</span>(nb_Moins18ans, nb_18<span class="fl">.29</span>ans,nb_30<span class="fl">.39</span>ans,nb_40<span class="fl">.54</span>ans,</span>
<span id="cb221-23"><a href="15-Clustering-application.html#cb221-23" aria-hidden="true" tabindex="-1"></a>                                nb_55<span class="fl">.64</span>ans,nb_Plus64ans, classe4_soprof_p) <span class="sc">%&gt;%</span></span>
<span id="cb221-24"><a href="15-Clustering-application.html#cb221-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(classe4_soprof_p) <span class="sc">%&gt;%</span></span>
<span id="cb221-25"><a href="15-Clustering-application.html#cb221-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">nb_Moins18ans =</span> <span class="fu">sum</span>(nb_Moins18ans), <span class="at">nb_18.29ans=</span><span class="fu">sum</span>(nb_18<span class="fl">.29</span>ans), </span>
<span id="cb221-26"><a href="15-Clustering-application.html#cb221-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">nb_30.39ans=</span><span class="fu">sum</span>(nb_30<span class="fl">.39</span>ans), <span class="at">nb_40.54ans=</span><span class="fu">sum</span>(nb_40<span class="fl">.54</span>ans),</span>
<span id="cb221-27"><a href="15-Clustering-application.html#cb221-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">nb_55.64ans=</span><span class="fu">sum</span>(nb_55<span class="fl">.64</span>ans), <span class="at">nb_Plus64ans=</span><span class="fu">sum</span>(nb_Plus64ans)) <span class="sc">%&gt;%</span> </span>
<span id="cb221-28"><a href="15-Clustering-application.html#cb221-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_Moins18ans =</span> nb_Moins18ans <span class="sc">/</span> (nb_Moins18ans <span class="sc">+</span> nb_18<span class="fl">.29</span>ans <span class="sc">+</span> nb_30<span class="fl">.39</span>ans <span class="sc">+</span></span>
<span id="cb221-29"><a href="15-Clustering-application.html#cb221-29" aria-hidden="true" tabindex="-1"></a>                                             nb_40<span class="fl">.54</span>ans <span class="sc">+</span> nb_55<span class="fl">.64</span>ans <span class="sc">+</span> nb_Plus64ans), </span>
<span id="cb221-30"><a href="15-Clustering-application.html#cb221-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_18.29ans   =</span> nb_18<span class="fl">.29</span>ans <span class="sc">/</span> (nb_Moins18ans <span class="sc">+</span> nb_18<span class="fl">.29</span>ans <span class="sc">+</span> nb_30<span class="fl">.39</span>ans <span class="sc">+</span> </span>
<span id="cb221-31"><a href="15-Clustering-application.html#cb221-31" aria-hidden="true" tabindex="-1"></a>                                           nb_40<span class="fl">.54</span>ans <span class="sc">+</span> nb_55<span class="fl">.64</span>ans <span class="sc">+</span> nb_Plus64ans),</span>
<span id="cb221-32"><a href="15-Clustering-application.html#cb221-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_30.39ans   =</span> nb_30<span class="fl">.39</span>ans <span class="sc">/</span> (nb_Moins18ans <span class="sc">+</span> nb_18<span class="fl">.29</span>ans <span class="sc">+</span> nb_30<span class="fl">.39</span>ans <span class="sc">+</span> </span>
<span id="cb221-33"><a href="15-Clustering-application.html#cb221-33" aria-hidden="true" tabindex="-1"></a>                                           nb_40<span class="fl">.54</span>ans <span class="sc">+</span> nb_55<span class="fl">.64</span>ans <span class="sc">+</span> nb_Plus64ans),</span>
<span id="cb221-34"><a href="15-Clustering-application.html#cb221-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_40.54ans   =</span> nb_40<span class="fl">.54</span>ans <span class="sc">/</span> (nb_Moins18ans <span class="sc">+</span> nb_18<span class="fl">.29</span>ans <span class="sc">+</span> nb_30<span class="fl">.39</span>ans <span class="sc">+</span> </span>
<span id="cb221-35"><a href="15-Clustering-application.html#cb221-35" aria-hidden="true" tabindex="-1"></a>                                           nb_40<span class="fl">.54</span>ans <span class="sc">+</span> nb_55<span class="fl">.64</span>ans <span class="sc">+</span> nb_Plus64ans),</span>
<span id="cb221-36"><a href="15-Clustering-application.html#cb221-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_55.64ans   =</span> nb_55<span class="fl">.64</span>ans <span class="sc">/</span> (nb_Moins18ans <span class="sc">+</span> nb_18<span class="fl">.29</span>ans <span class="sc">+</span> nb_30<span class="fl">.39</span>ans <span class="sc">+</span> </span>
<span id="cb221-37"><a href="15-Clustering-application.html#cb221-37" aria-hidden="true" tabindex="-1"></a>                                           nb_40<span class="fl">.54</span>ans <span class="sc">+</span> nb_55<span class="fl">.64</span>ans <span class="sc">+</span> nb_Plus64ans),</span>
<span id="cb221-38"><a href="15-Clustering-application.html#cb221-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_Plus64ans  =</span> nb_Plus64ans <span class="sc">/</span> (nb_Moins18ans <span class="sc">+</span> nb_18<span class="fl">.29</span>ans <span class="sc">+</span> nb_30<span class="fl">.39</span>ans <span class="sc">+</span> </span>
<span id="cb221-39"><a href="15-Clustering-application.html#cb221-39" aria-hidden="true" tabindex="-1"></a>                                            nb_40<span class="fl">.54</span>ans <span class="sc">+</span> nb_55<span class="fl">.64</span>ans <span class="sc">+</span> nb_Plus64ans)) <span class="sc">%&gt;%</span> </span>
<span id="cb221-40"><a href="15-Clustering-application.html#cb221-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(tab_age_ens) <span class="sc">%&gt;%</span> </span>
<span id="cb221-41"><a href="15-Clustering-application.html#cb221-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span><span class="fu">c</span>(classe4_soprof_p, nb_Moins18ans, nb_18<span class="fl">.29</span>ans, nb_30<span class="fl">.39</span>ans, </span>
<span id="cb221-42"><a href="15-Clustering-application.html#cb221-42" aria-hidden="true" tabindex="-1"></a>                       nb_40<span class="fl">.54</span>ans, nb_55<span class="fl">.64</span>ans, nb_Plus64ans), </span>
<span id="cb221-43"><a href="15-Clustering-application.html#cb221-43" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;age&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;pct&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb221-44"><a href="15-Clustering-application.html#cb221-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> pct, <span class="at">y=</span>age , <span class="at">fill=</span>classe4_soprof_p) <span class="sc">+</span> </span>
<span id="cb221-45"><a href="15-Clustering-application.html#cb221-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">position=</span><span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> </span>
<span id="cb221-46"><a href="15-Clustering-application.html#cb221-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels=</span>percent) <span class="sc">+</span></span>
<span id="cb221-47"><a href="15-Clustering-application.html#cb221-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Moins de 18 ans&quot;</span>, <span class="st">&quot;18-29 ans&quot;</span>, <span class="st">&quot;30-39 ans&quot;</span>, <span class="st">&quot;40-54 ans&quot;</span>,</span>
<span id="cb221-48"><a href="15-Clustering-application.html#cb221-48" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;55-64 ans&quot;</span>, <span class="st">&quot;Plus de 64 ans&quot;</span>)) <span class="sc">+</span></span>
<span id="cb221-49"><a href="15-Clustering-application.html#cb221-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Classes d&#39;âge selon les classes&quot;</span>, <span class="at">x=</span><span class="st">&quot; &quot;</span>, <span class="at">y=</span><span class="st">&quot;&quot;</span>, <span class="at">fill=</span><span class="st">&quot;Classe&quot;</span>) <span class="sc">+</span></span>
<span id="cb221-50"><a href="15-Clustering-application.html#cb221-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb221-51"><a href="15-Clustering-application.html#cb221-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Set2&quot;</span>) </span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-132-1.svg" width="672" /></p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="15-Clustering-application.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour le lieu de naissance</span></span>
<span id="cb222-2"><a href="15-Clustering-application.html#cb222-2" aria-hidden="true" tabindex="-1"></a>tab_lieunaiss_ens <span class="ot">&lt;-</span> clust_socioprof_p_cl <span class="sc">%&gt;%</span> </span>
<span id="cb222-3"><a href="15-Clustering-application.html#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Nblieu_naiss_autre_dept, Nblieu_naiss_autre_region, Nblieu_naiss_étranger, </span>
<span id="cb222-4"><a href="15-Clustering-application.html#cb222-4" aria-hidden="true" tabindex="-1"></a>         Nblieu_naiss_même_dept, classe4_soprof_p) <span class="sc">%&gt;%</span></span>
<span id="cb222-5"><a href="15-Clustering-application.html#cb222-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Nblieu_naiss_autre_dept =</span> <span class="fu">sum</span>(Nblieu_naiss_autre_dept), </span>
<span id="cb222-6"><a href="15-Clustering-application.html#cb222-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">Nblieu_naiss_autre_region=</span><span class="fu">sum</span>(Nblieu_naiss_autre_region),</span>
<span id="cb222-7"><a href="15-Clustering-application.html#cb222-7" aria-hidden="true" tabindex="-1"></a>            Nblieu_naiss_é<span class="at">tranger =</span> <span class="fu">sum</span>(Nblieu_naiss_étranger), </span>
<span id="cb222-8"><a href="15-Clustering-application.html#cb222-8" aria-hidden="true" tabindex="-1"></a>            Nblieu_naiss_même<span class="at">_dept =</span> <span class="fu">sum</span>(Nblieu_naiss_même_dept)) <span class="sc">%&gt;%</span> </span>
<span id="cb222-9"><a href="15-Clustering-application.html#cb222-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_autre_dept =</span> Nblieu_naiss_autre_dept <span class="sc">/</span> (Nblieu_naiss_autre_dept <span class="sc">+</span> Nblieu_naiss_autre_region <span class="sc">+</span> Nblieu_naiss_étranger <span class="sc">+</span> Nblieu_naiss_même_dept),</span>
<span id="cb222-10"><a href="15-Clustering-application.html#cb222-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_autre_region =</span> Nblieu_naiss_autre_region <span class="sc">/</span> (Nblieu_naiss_autre_dept <span class="sc">+</span> Nblieu_naiss_autre_region <span class="sc">+</span> Nblieu_naiss_étranger <span class="sc">+</span></span>
<span id="cb222-11"><a href="15-Clustering-application.html#cb222-11" aria-hidden="true" tabindex="-1"></a>                                                           Nblieu_naiss_même_dept),</span>
<span id="cb222-12"><a href="15-Clustering-application.html#cb222-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_etranger =</span> Nblieu_naiss_étranger <span class="sc">/</span> (Nblieu_naiss_autre_dept <span class="sc">+</span> Nblieu_naiss_autre_region <span class="sc">+</span> Nblieu_naiss_étranger <span class="sc">+</span> Nblieu_naiss_même_dept),</span>
<span id="cb222-13"><a href="15-Clustering-application.html#cb222-13" aria-hidden="true" tabindex="-1"></a>         pct_même<span class="at">_dept =</span> Nblieu_naiss_même_dept <span class="sc">/</span> (Nblieu_naiss_autre_dept <span class="sc">+</span> Nblieu_naiss_autre_region <span class="sc">+</span> Nblieu_naiss_étranger <span class="sc">+</span> Nblieu_naiss_même_dept),</span>
<span id="cb222-14"><a href="15-Clustering-application.html#cb222-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">classe4_soprof_p =</span> <span class="st">&quot;Ensemble&quot;</span>)</span>
<span id="cb222-15"><a href="15-Clustering-application.html#cb222-15" aria-hidden="true" tabindex="-1"></a>clust_socioprof_p_cl <span class="sc">%&gt;%</span> </span>
<span id="cb222-16"><a href="15-Clustering-application.html#cb222-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Nblieu_naiss_autre_dept, Nblieu_naiss_autre_region, Nblieu_naiss_étranger,</span>
<span id="cb222-17"><a href="15-Clustering-application.html#cb222-17" aria-hidden="true" tabindex="-1"></a>         Nblieu_naiss_même_dept, classe4_soprof_p) <span class="sc">%&gt;%</span></span>
<span id="cb222-18"><a href="15-Clustering-application.html#cb222-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(classe4_soprof_p) <span class="sc">%&gt;%</span></span>
<span id="cb222-19"><a href="15-Clustering-application.html#cb222-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Nblieu_naiss_autre_dept =</span> <span class="fu">sum</span>(Nblieu_naiss_autre_dept), </span>
<span id="cb222-20"><a href="15-Clustering-application.html#cb222-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">Nblieu_naiss_autre_region=</span><span class="fu">sum</span>(Nblieu_naiss_autre_region),</span>
<span id="cb222-21"><a href="15-Clustering-application.html#cb222-21" aria-hidden="true" tabindex="-1"></a>            Nblieu_naiss_é<span class="at">tranger =</span> <span class="fu">sum</span>(Nblieu_naiss_étranger), </span>
<span id="cb222-22"><a href="15-Clustering-application.html#cb222-22" aria-hidden="true" tabindex="-1"></a>            Nblieu_naiss_même<span class="at">_dept =</span> <span class="fu">sum</span>(Nblieu_naiss_même_dept)) <span class="sc">%&gt;%</span> </span>
<span id="cb222-23"><a href="15-Clustering-application.html#cb222-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_autre_dept =</span> Nblieu_naiss_autre_dept <span class="sc">/</span> (Nblieu_naiss_autre_dept <span class="sc">+</span> Nblieu_naiss_autre_region <span class="sc">+</span> Nblieu_naiss_étranger <span class="sc">+</span> Nblieu_naiss_même_dept),</span>
<span id="cb222-24"><a href="15-Clustering-application.html#cb222-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_autre_region =</span> Nblieu_naiss_autre_region <span class="sc">/</span> (Nblieu_naiss_autre_dept <span class="sc">+</span> Nblieu_naiss_autre_region <span class="sc">+</span> Nblieu_naiss_étranger <span class="sc">+</span></span>
<span id="cb222-25"><a href="15-Clustering-application.html#cb222-25" aria-hidden="true" tabindex="-1"></a>                                                           Nblieu_naiss_même_dept),</span>
<span id="cb222-26"><a href="15-Clustering-application.html#cb222-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_etranger =</span> Nblieu_naiss_étranger <span class="sc">/</span> (Nblieu_naiss_autre_dept <span class="sc">+</span> Nblieu_naiss_autre_region <span class="sc">+</span> Nblieu_naiss_étranger <span class="sc">+</span> Nblieu_naiss_même_dept),</span>
<span id="cb222-27"><a href="15-Clustering-application.html#cb222-27" aria-hidden="true" tabindex="-1"></a>         pct_même<span class="at">_dept =</span> Nblieu_naiss_même_dept <span class="sc">/</span> (Nblieu_naiss_autre_dept <span class="sc">+</span> Nblieu_naiss_autre_region <span class="sc">+</span> Nblieu_naiss_étranger <span class="sc">+</span> Nblieu_naiss_même_dept)) <span class="sc">%&gt;%</span> </span>
<span id="cb222-28"><a href="15-Clustering-application.html#cb222-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(tab_lieunaiss_ens) <span class="sc">%&gt;%</span> </span>
<span id="cb222-29"><a href="15-Clustering-application.html#cb222-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span><span class="fu">c</span>(classe4_soprof_p,Nblieu_naiss_autre_dept, Nblieu_naiss_autre_region, </span>
<span id="cb222-30"><a href="15-Clustering-application.html#cb222-30" aria-hidden="true" tabindex="-1"></a>                       Nblieu_naiss_étranger, Nblieu_naiss_même_dept), </span>
<span id="cb222-31"><a href="15-Clustering-application.html#cb222-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;lieu_naiss&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;pct&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb222-32"><a href="15-Clustering-application.html#cb222-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lieu_naiss =</span> <span class="fu">fct_relevel</span>(lieu_naiss, <span class="fu">c</span>(<span class="st">&quot;pct_même_dept&quot;</span>, <span class="st">&quot;pct_autre_dept&quot;</span>,</span>
<span id="cb222-33"><a href="15-Clustering-application.html#cb222-33" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">&quot;pct_autre_region&quot;</span>,<span class="st">&quot;pct_etranger&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb222-34"><a href="15-Clustering-application.html#cb222-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> pct, <span class="at">y=</span>lieu_naiss , <span class="at">fill=</span>classe4_soprof_p) <span class="sc">+</span> </span>
<span id="cb222-35"><a href="15-Clustering-application.html#cb222-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">position=</span><span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> </span>
<span id="cb222-36"><a href="15-Clustering-application.html#cb222-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels=</span>percent) <span class="sc">+</span></span>
<span id="cb222-37"><a href="15-Clustering-application.html#cb222-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Dans le même département&quot;</span> , <span class="st">&quot;Dans un autre département&quot;</span>,</span>
<span id="cb222-38"><a href="15-Clustering-application.html#cb222-38" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Dans une autre région&quot;</span>, <span class="st">&quot;A l&#39;étranger&quot;</span>)) <span class="sc">+</span></span>
<span id="cb222-39"><a href="15-Clustering-application.html#cb222-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb222-40"><a href="15-Clustering-application.html#cb222-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Set2&quot;</span>)  <span class="sc">+</span></span>
<span id="cb222-41"><a href="15-Clustering-application.html#cb222-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Lieu de naissance selon les classes&quot;</span>, <span class="at">x=</span><span class="st">&quot; &quot;</span>, <span class="at">y=</span><span class="st">&quot;&quot;</span>, <span class="at">fill=</span><span class="st">&quot;Classe&quot;</span>) <span class="sc">+</span></span>
<span id="cb222-42"><a href="15-Clustering-application.html#cb222-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-132-2.svg" width="672" /></p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="15-Clustering-application.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la variable de diplôme</span></span>
<span id="cb223-2"><a href="15-Clustering-application.html#cb223-2" aria-hidden="true" tabindex="-1"></a>tab_dipl_ens <span class="ot">&lt;-</span> clust_socioprof_p_cl <span class="sc">%&gt;%</span> </span>
<span id="cb223-3"><a href="15-Clustering-application.html#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nb_Bac, nb_Bacplus2, nb_Bacplus3ou4, nb_Bacplus5ouplus, nb_Moins14ans,</span>
<span id="cb223-4"><a href="15-Clustering-application.html#cb223-4" aria-hidden="true" tabindex="-1"></a>         nb_Peu_pas.diplomés,classe4_soprof_p) <span class="sc">%&gt;%</span></span>
<span id="cb223-5"><a href="15-Clustering-application.html#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">nb_Bac =</span> <span class="fu">sum</span>(nb_Bac), <span class="at">nb_Bacplus2=</span><span class="fu">sum</span>(nb_Bacplus2), </span>
<span id="cb223-6"><a href="15-Clustering-application.html#cb223-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">nb_Bacplus3ou4 =</span> <span class="fu">sum</span>(nb_Bacplus3ou4), <span class="at">nb_Bacplus5ouplus =</span> <span class="fu">sum</span>(nb_Bacplus5ouplus),</span>
<span id="cb223-7"><a href="15-Clustering-application.html#cb223-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">nb_Moins14ans =</span> <span class="fu">sum</span>(nb_Moins14ans), nb_Peu_pas.diplomés<span class="ot">=</span><span class="fu">sum</span>(nb_Peu_pas.diplomés)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-8"><a href="15-Clustering-application.html#cb223-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_Bac         =</span> nb_Bac         <span class="sc">/</span> (nb_Bac <span class="sc">+</span> nb_Bacplus2 <span class="sc">+</span> nb_Bacplus3ou4 <span class="sc">+</span> nb_Bacplus5ouplus <span class="sc">+</span> nb_Moins14ans <span class="sc">+</span> nb_Peu_pas.diplomés),</span>
<span id="cb223-9"><a href="15-Clustering-application.html#cb223-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_Bacplus2    =</span> nb_Bacplus2    <span class="sc">/</span> (nb_Bac <span class="sc">+</span> nb_Bacplus2 <span class="sc">+</span> nb_Bacplus3ou4 <span class="sc">+</span> nb_Bacplus5ouplus <span class="sc">+</span> nb_Moins14ans <span class="sc">+</span> nb_Peu_pas.diplomés),</span>
<span id="cb223-10"><a href="15-Clustering-application.html#cb223-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_Bacplus3ou4 =</span> nb_Bacplus3ou4 <span class="sc">/</span> (nb_Bac <span class="sc">+</span> nb_Bacplus2 <span class="sc">+</span> nb_Bacplus3ou4 <span class="sc">+</span> nb_Bacplus5ouplus <span class="sc">+</span> nb_Moins14ans <span class="sc">+</span> nb_Peu_pas.diplomés),</span>
<span id="cb223-11"><a href="15-Clustering-application.html#cb223-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_Bacplus5ouplus =</span> nb_Bacplus5ouplus <span class="sc">/</span> (nb_Bac <span class="sc">+</span> nb_Bacplus2 <span class="sc">+</span> nb_Bacplus3ou4 <span class="sc">+</span> nb_Bacplus5ouplus <span class="sc">+</span> nb_Moins14ans <span class="sc">+</span> nb_Peu_pas.diplomés),</span>
<span id="cb223-12"><a href="15-Clustering-application.html#cb223-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_Moins14ans =</span> nb_Moins14ans <span class="sc">/</span> (nb_Bac <span class="sc">+</span> nb_Bacplus2 <span class="sc">+</span> nb_Bacplus3ou4 <span class="sc">+</span> nb_Bacplus5ouplus <span class="sc">+</span> nb_Moins14ans <span class="sc">+</span> nb_Peu_pas.diplomés),</span>
<span id="cb223-13"><a href="15-Clustering-application.html#cb223-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_Peu_pas.diplomes =</span> nb_Peu_pas.diplomés <span class="sc">/</span> (nb_Bac <span class="sc">+</span> nb_Bacplus2 <span class="sc">+</span> nb_Bacplus3ou4 <span class="sc">+</span> nb_Bacplus5ouplus <span class="sc">+</span> nb_Moins14ans <span class="sc">+</span> nb_Peu_pas.diplomés),</span>
<span id="cb223-14"><a href="15-Clustering-application.html#cb223-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">classe4_soprof_p =</span> <span class="st">&quot;Ensemble&quot;</span>)</span>
<span id="cb223-15"><a href="15-Clustering-application.html#cb223-15" aria-hidden="true" tabindex="-1"></a>clust_socioprof_p_cl <span class="sc">%&gt;%</span> </span>
<span id="cb223-16"><a href="15-Clustering-application.html#cb223-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nb_Bac, nb_Bacplus2, nb_Bacplus3ou4, nb_Bacplus5ouplus, nb_Moins14ans,</span>
<span id="cb223-17"><a href="15-Clustering-application.html#cb223-17" aria-hidden="true" tabindex="-1"></a>         nb_Peu_pas.diplomés,classe4_soprof_p) <span class="sc">%&gt;%</span></span>
<span id="cb223-18"><a href="15-Clustering-application.html#cb223-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(classe4_soprof_p) <span class="sc">%&gt;%</span></span>
<span id="cb223-19"><a href="15-Clustering-application.html#cb223-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">nb_Bac =</span> <span class="fu">sum</span>(nb_Bac), <span class="at">nb_Bacplus2=</span><span class="fu">sum</span>(nb_Bacplus2), </span>
<span id="cb223-20"><a href="15-Clustering-application.html#cb223-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">nb_Bacplus3ou4 =</span> <span class="fu">sum</span>(nb_Bacplus3ou4), <span class="at">nb_Bacplus5ouplus =</span> <span class="fu">sum</span>(nb_Bacplus5ouplus),</span>
<span id="cb223-21"><a href="15-Clustering-application.html#cb223-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">nb_Moins14ans =</span> <span class="fu">sum</span>(nb_Moins14ans), nb_Peu_pas.diplomés<span class="ot">=</span><span class="fu">sum</span>(nb_Peu_pas.diplomés)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-22"><a href="15-Clustering-application.html#cb223-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_Bac         =</span> nb_Bac         <span class="sc">/</span> (nb_Bac <span class="sc">+</span> nb_Bacplus2 <span class="sc">+</span> nb_Bacplus3ou4 <span class="sc">+</span> nb_Bacplus5ouplus <span class="sc">+</span> nb_Moins14ans <span class="sc">+</span> nb_Peu_pas.diplomés),</span>
<span id="cb223-23"><a href="15-Clustering-application.html#cb223-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_Bacplus2    =</span> nb_Bacplus2    <span class="sc">/</span> (nb_Bac <span class="sc">+</span> nb_Bacplus2 <span class="sc">+</span> nb_Bacplus3ou4 <span class="sc">+</span> nb_Bacplus5ouplus <span class="sc">+</span> nb_Moins14ans <span class="sc">+</span> nb_Peu_pas.diplomés),</span>
<span id="cb223-24"><a href="15-Clustering-application.html#cb223-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_Bacplus3ou4 =</span> nb_Bacplus3ou4 <span class="sc">/</span> (nb_Bac <span class="sc">+</span> nb_Bacplus2 <span class="sc">+</span> nb_Bacplus3ou4 <span class="sc">+</span> nb_Bacplus5ouplus <span class="sc">+</span> nb_Moins14ans <span class="sc">+</span> nb_Peu_pas.diplomés),</span>
<span id="cb223-25"><a href="15-Clustering-application.html#cb223-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_Bacplus5ouplus =</span> nb_Bacplus5ouplus <span class="sc">/</span> (nb_Bac <span class="sc">+</span> nb_Bacplus2 <span class="sc">+</span> nb_Bacplus3ou4 <span class="sc">+</span> nb_Bacplus5ouplus <span class="sc">+</span> nb_Moins14ans <span class="sc">+</span> nb_Peu_pas.diplomés),</span>
<span id="cb223-26"><a href="15-Clustering-application.html#cb223-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_Moins14ans =</span> nb_Moins14ans <span class="sc">/</span> (nb_Bac <span class="sc">+</span> nb_Bacplus2 <span class="sc">+</span> nb_Bacplus3ou4 <span class="sc">+</span> nb_Bacplus5ouplus <span class="sc">+</span> nb_Moins14ans <span class="sc">+</span> nb_Peu_pas.diplomés),</span>
<span id="cb223-27"><a href="15-Clustering-application.html#cb223-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_Peu_pas.diplomes =</span> nb_Peu_pas.diplomés <span class="sc">/</span> (nb_Bac <span class="sc">+</span> nb_Bacplus2 <span class="sc">+</span> nb_Bacplus3ou4 <span class="sc">+</span> nb_Bacplus5ouplus <span class="sc">+</span> nb_Moins14ans <span class="sc">+</span> nb_Peu_pas.diplomés)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-28"><a href="15-Clustering-application.html#cb223-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(tab_dipl_ens) <span class="sc">%&gt;%</span> </span>
<span id="cb223-29"><a href="15-Clustering-application.html#cb223-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span><span class="fu">c</span>(classe4_soprof_p,nb_Bac, nb_Bacplus2, nb_Bacplus3ou4, </span>
<span id="cb223-30"><a href="15-Clustering-application.html#cb223-30" aria-hidden="true" tabindex="-1"></a>                       nb_Bacplus5ouplus, nb_Moins14ans,nb_Peu_pas.diplomés), </span>
<span id="cb223-31"><a href="15-Clustering-application.html#cb223-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;dipl&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;pct&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb223-32"><a href="15-Clustering-application.html#cb223-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dipl =</span> <span class="fu">fct_relevel</span>(dipl, <span class="fu">c</span>(<span class="st">&quot;pct_Moins14ans&quot;</span>, <span class="st">&quot;pct_Peu_pas.diplomes&quot;</span>,</span>
<span id="cb223-33"><a href="15-Clustering-application.html#cb223-33" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;pct_Bac&quot;</span>, <span class="st">&quot;pct_Bacplus2&quot;</span>, <span class="st">&quot;pct_Bacplus3ou4&quot;</span>, <span class="st">&quot;pct_Bacplus5ouplus&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb223-34"><a href="15-Clustering-application.html#cb223-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> pct, <span class="at">y=</span>dipl , <span class="at">fill=</span>classe4_soprof_p) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">position=</span><span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> </span>
<span id="cb223-35"><a href="15-Clustering-application.html#cb223-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels=</span>percent) <span class="sc">+</span></span>
<span id="cb223-36"><a href="15-Clustering-application.html#cb223-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Moins de 14 ans&quot;</span>, <span class="st">&quot;Peu ou pas diplomés&quot;</span>,<span class="st">&quot;Bac&quot;</span>, <span class="st">&quot;Bac+2&quot;</span>,</span>
<span id="cb223-37"><a href="15-Clustering-application.html#cb223-37" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Bac+3 ou +4&quot;</span>, <span class="st">&quot;Bac+5 ou plus&quot;</span>)) <span class="sc">+</span></span>
<span id="cb223-38"><a href="15-Clustering-application.html#cb223-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb223-39"><a href="15-Clustering-application.html#cb223-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Set2&quot;</span>)  <span class="sc">+</span></span>
<span id="cb223-40"><a href="15-Clustering-application.html#cb223-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Diplôme selon les classes&quot;</span>, <span class="at">x=</span><span class="st">&quot; &quot;</span>, <span class="at">y=</span><span class="st">&quot;&quot;</span>, <span class="at">fill=</span><span class="st">&quot;Classe&quot;</span>) <span class="sc">+</span></span>
<span id="cb223-41"><a href="15-Clustering-application.html#cb223-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-132-3.svg" width="672" /></p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="15-Clustering-application.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la variable d&#39;activite</span></span>
<span id="cb224-2"><a href="15-Clustering-application.html#cb224-2" aria-hidden="true" tabindex="-1"></a>tab_act_ens<span class="ot">&lt;-</span> clust_socioprof_p_cl <span class="sc">%&gt;%</span> </span>
<span id="cb224-3"><a href="15-Clustering-application.html#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Nbactivite_actifs_occ, Nbactivite_chômeurs,  Nbactivite_eleves_etudiants, </span>
<span id="cb224-4"><a href="15-Clustering-application.html#cb224-4" aria-hidden="true" tabindex="-1"></a>         Nbactivite_inactifs, classe4_soprof_p) <span class="sc">%&gt;%</span></span>
<span id="cb224-5"><a href="15-Clustering-application.html#cb224-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Nbactivite_actifs_occ =</span> <span class="fu">sum</span>(Nbactivite_actifs_occ), </span>
<span id="cb224-6"><a href="15-Clustering-application.html#cb224-6" aria-hidden="true" tabindex="-1"></a>            Nbactivite_chômeurs<span class="ot">=</span><span class="fu">sum</span>(Nbactivite_chômeurs), </span>
<span id="cb224-7"><a href="15-Clustering-application.html#cb224-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">Nbactivite_eleves_etudiants =</span> <span class="fu">sum</span>(Nbactivite_eleves_etudiants), </span>
<span id="cb224-8"><a href="15-Clustering-application.html#cb224-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">Nbactivite_inactifs =</span> <span class="fu">sum</span>(Nbactivite_inactifs)) <span class="sc">%&gt;%</span> </span>
<span id="cb224-9"><a href="15-Clustering-application.html#cb224-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_actifs_occ =</span> Nbactivite_actifs_occ <span class="sc">/</span> (Nbactivite_actifs_occ <span class="sc">+</span> Nbactivite_chômeurs <span class="sc">+</span> Nbactivite_eleves_etudiants <span class="sc">+</span> Nbactivite_inactifs),</span>
<span id="cb224-10"><a href="15-Clustering-application.html#cb224-10" aria-hidden="true" tabindex="-1"></a>         pct_chômeurs    <span class="ot">=</span> Nbactivite_chômeurs    <span class="sc">/</span> (Nbactivite_actifs_occ <span class="sc">+</span> Nbactivite_chômeurs <span class="sc">+</span> Nbactivite_eleves_etudiants <span class="sc">+</span> Nbactivite_inactifs),</span>
<span id="cb224-11"><a href="15-Clustering-application.html#cb224-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_eleves_etudiants =</span> Nbactivite_eleves_etudiants <span class="sc">/</span> (Nbactivite_actifs_occ <span class="sc">+</span> Nbactivite_chômeurs <span class="sc">+</span> Nbactivite_eleves_etudiants <span class="sc">+</span></span>
<span id="cb224-12"><a href="15-Clustering-application.html#cb224-12" aria-hidden="true" tabindex="-1"></a>                                                                 Nbactivite_inactifs),</span>
<span id="cb224-13"><a href="15-Clustering-application.html#cb224-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_inactifs =</span> Nbactivite_inactifs <span class="sc">/</span> (Nbactivite_actifs_occ <span class="sc">+</span> Nbactivite_chômeurs <span class="sc">+</span> Nbactivite_eleves_etudiants <span class="sc">+</span> Nbactivite_inactifs),</span>
<span id="cb224-14"><a href="15-Clustering-application.html#cb224-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">classe4_soprof_p =</span> <span class="st">&quot;Ensemble&quot;</span>)</span>
<span id="cb224-15"><a href="15-Clustering-application.html#cb224-15" aria-hidden="true" tabindex="-1"></a>clust_socioprof_p_cl <span class="sc">%&gt;%</span> <span class="fu">select</span>(Nbactivite_actifs_occ, Nbactivite_chômeurs, </span>
<span id="cb224-16"><a href="15-Clustering-application.html#cb224-16" aria-hidden="true" tabindex="-1"></a>                                Nbactivite_eleves_etudiants, Nbactivite_inactifs, classe4_soprof_p) <span class="sc">%&gt;%</span></span>
<span id="cb224-17"><a href="15-Clustering-application.html#cb224-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(classe4_soprof_p) <span class="sc">%&gt;%</span></span>
<span id="cb224-18"><a href="15-Clustering-application.html#cb224-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Nbactivite_actifs_occ =</span> <span class="fu">sum</span>(Nbactivite_actifs_occ), </span>
<span id="cb224-19"><a href="15-Clustering-application.html#cb224-19" aria-hidden="true" tabindex="-1"></a>            Nbactivite_chômeurs<span class="ot">=</span><span class="fu">sum</span>(Nbactivite_chômeurs), </span>
<span id="cb224-20"><a href="15-Clustering-application.html#cb224-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">Nbactivite_eleves_etudiants =</span> <span class="fu">sum</span>(Nbactivite_eleves_etudiants),</span>
<span id="cb224-21"><a href="15-Clustering-application.html#cb224-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">Nbactivite_inactifs =</span> <span class="fu">sum</span>(Nbactivite_inactifs)) <span class="sc">%&gt;%</span> </span>
<span id="cb224-22"><a href="15-Clustering-application.html#cb224-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_actifs_occ =</span> Nbactivite_actifs_occ <span class="sc">/</span> (Nbactivite_actifs_occ <span class="sc">+</span> Nbactivite_chômeurs <span class="sc">+</span> Nbactivite_eleves_etudiants <span class="sc">+</span> Nbactivite_inactifs),</span>
<span id="cb224-23"><a href="15-Clustering-application.html#cb224-23" aria-hidden="true" tabindex="-1"></a>         pct_chômeurs    <span class="ot">=</span> Nbactivite_chômeurs    <span class="sc">/</span> (Nbactivite_actifs_occ <span class="sc">+</span> Nbactivite_chômeurs <span class="sc">+</span> Nbactivite_eleves_etudiants <span class="sc">+</span> Nbactivite_inactifs),</span>
<span id="cb224-24"><a href="15-Clustering-application.html#cb224-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_eleves_etudiants =</span> Nbactivite_eleves_etudiants <span class="sc">/</span> (Nbactivite_actifs_occ <span class="sc">+</span> Nbactivite_chômeurs <span class="sc">+</span> Nbactivite_eleves_etudiants <span class="sc">+</span></span>
<span id="cb224-25"><a href="15-Clustering-application.html#cb224-25" aria-hidden="true" tabindex="-1"></a>                                                                 Nbactivite_inactifs),</span>
<span id="cb224-26"><a href="15-Clustering-application.html#cb224-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_inactifs =</span> Nbactivite_inactifs <span class="sc">/</span> (Nbactivite_actifs_occ <span class="sc">+</span> Nbactivite_chômeurs <span class="sc">+</span> Nbactivite_eleves_etudiants <span class="sc">+</span> Nbactivite_inactifs)) <span class="sc">%&gt;%</span> </span>
<span id="cb224-27"><a href="15-Clustering-application.html#cb224-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(tab_act_ens) <span class="sc">%&gt;%</span> </span>
<span id="cb224-28"><a href="15-Clustering-application.html#cb224-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span><span class="fu">c</span>(classe4_soprof_p,Nbactivite_actifs_occ, Nbactivite_chômeurs,</span>
<span id="cb224-29"><a href="15-Clustering-application.html#cb224-29" aria-hidden="true" tabindex="-1"></a>                       Nbactivite_eleves_etudiants, Nbactivite_inactifs), </span>
<span id="cb224-30"><a href="15-Clustering-application.html#cb224-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;activite&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;pct&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb224-31"><a href="15-Clustering-application.html#cb224-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> pct, <span class="at">y=</span>activite , <span class="at">fill=</span>classe4_soprof_p) <span class="sc">+</span> </span>
<span id="cb224-32"><a href="15-Clustering-application.html#cb224-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">position=</span><span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> </span>
<span id="cb224-33"><a href="15-Clustering-application.html#cb224-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels=</span>percent) <span class="sc">+</span></span>
<span id="cb224-34"><a href="15-Clustering-application.html#cb224-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Actifs occupés&quot;</span>, <span class="st">&quot;Chômeurs&quot;</span>,<span class="st">&quot;Elèves ou étudiants&quot;</span>, <span class="st">&quot;Autres inactifs&quot;</span>)) <span class="sc">+</span></span>
<span id="cb224-35"><a href="15-Clustering-application.html#cb224-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb224-36"><a href="15-Clustering-application.html#cb224-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Set2&quot;</span>)  <span class="sc">+</span></span>
<span id="cb224-37"><a href="15-Clustering-application.html#cb224-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Statut d&#39;activité selon les classes&quot;</span>, <span class="at">x=</span><span class="st">&quot; &quot;</span>, <span class="at">y=</span><span class="st">&quot;&quot;</span>, <span class="at">fill=</span><span class="st">&quot;Classe&quot;</span>) </span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-132-4.svg" width="672" /></p>
<p>On observe en plus des résultats précédents que les jeunes de moins de 30 ans constituent une part plus importante de la population de la classe 2, alors qu’ils constituent une part se situant dans la moyenne (ensemble) pour la classe 1. Cette dernière classe comptent un peu plus de 30-39 ans dans sa population.Deux autres classes se distinguent : la classe 3 comprend davantage de personnes âgés entre 40 et 64 ans ; alors que la classe 4 comprend beaucoup plus de personnes âgées de plus de 64 ans par rapport à l’ensemble, ce qui paraît logique puisqu’on a vu qu’elle était caractérisée par une surreprésentation des retraités. En revanche, contrairement à ce qu’on pouvait penser, c’est davantage la classe 2 qui rassemble plus de jeunes par rapport à la classe 1 (alors qu’il y avait une surreprésentation des autres inactifs, laissant penser à plus d’étudiants…).<br />
Par rapport au lieu de naissance des habitants de chaque classe, on confirme que la classe 3 comporte une part plus importante de personnes nées à l’étranger (plus de 30%, par rapport à environ 24% dans l’ensemble). Dans le même temps, c’est aussi dans cette classe que l’on note une part de personnées nées dans le même département, donc peu mobiles, plus importante par rapport à l’ensemble. Au contraire, la classe 2, et dans une moins mesure la classe 4, ont des part de personnées nées dans une autre région plus importante : cela est assez cohérent avec le fait que ce sont les 2 classes qui rassemblent une population plus favorisée, traditionnellement plus mobile.<br />
Ensuite, la répartition des habitants selon le diplôme confirme plutôt les résultats précédents notamment par rapport aux PCS. Le classe 3 se caractérise par une forte proportion de personnes peu ou pas diplômés, mais aussi de niveau Bac ou encore de jeunes (moins de 14 ans) ; alors qu’au contraire la classe 2, et dans une moindre mesure 4, rassemble une part plus importante de Bac+5 ou plus. La classe 1 comprend également un peu plus de jeunes de moins de 14 ans, et moins de Bac+5 ou plus.<br />
Enfin, on trouve une part plus importante d’actifs occupés chez les habitants de la classe 2 ; une part plus importante d’autres inactifs chez les habitants de la classe 3, mais également chez ceux de la classe 4 (retraités) ; une part plus importante de chômeurs dans la classe 3 ; et enfin une part un peu plus importante d’élèves ou étudiants dans les classe 1 et 3.</p>
<p>Ainsi, ce 2nd clustering, qui semble plus pertinent que le 1er, a permis de regrouper les quartiers de l’Est parisien en 4 grandes classes selon leurs caractéristiques socio-professionnelles :</p>
<ul>
<li>une 1ère classe rassemblant des habitants de quartiers présents surtout dans le 20ème et le 12ème arrondissement, qui sont un peu plus souvent inactifs hors retraités et ouvriers, et avec un peu plus d’enfants, elle rassemble également des quartiers particuliers avec le cimetière du Père Lachaise ou encore le Par de Bercy ;</li>
<li>une seconde classe qui regrouperait donc des individus de milieux plutôt favorisés, plus jeunes, plus diplômés, dans des quartiers principalement du 11ème arrondissement, et du nord-est du 12ème arrondissement (Roquette, Charonne, Bastille - Sainte-Marguerite et Quinze-vingt) ;</li>
<li>une troisième classe, qui s’oppose à cette 2ème classe ainsi que la dernière, rassemble au contraire desquartiers plus défavorisés qui se situent en majorité sur les boulevards périphériques et davantage dans le 20ème ;</li>
<li>enfin une 4ème classe qui elle aussi rassemble une population plus favorisée avec surtout davantage de retraités dans des quartiers principalement du 12ème arrondissement (Bel-Air, Picpus).</li>
</ul>
<p>Si l’on avait choisi 3 classes, on aurait eu un regroupement de la classe 2 et 4 (les 2 classes à droite du dendogramme ; la classe 3 étant celle le plus à gauche du dendogramme).</p>
<!-- Enfin, on a vu qu'il y avait plusieurs méthodes d'agrégation, ici nous avons utilisé le critère de Ward. Il est possible de tester d'autres méthodes et de comparer les dendogrammes alors obtenus. -->
<!-- On observe donc de fortes différences entre les dendogrammes. Par exemple, la méthode du "lien simple" ou "minimum" va avoir tendance à construire une grosse classe et une autre plus petite, c'est bien ce que l'on voit ici ; alors qu'au contraire, la méthode d'agrégation dite "complete" tend à construire des groupes plutôt de taille égale, en revanche, il faut savoir qu'elle est sensible aux points aberrants (on voit que ce n'est pas le cas ici). Enfin, on voit également que la méthode du "centroïd" (barycentre/centre de gravité des classes) produit un dendogramme particulier et déséquilibré comme le premier graphe (méthode du "lien simple").  C'est bien la méthode de Ward qui est la plus utilisée en pratique.   -->
<!-- ## La méthode des *k-means* appliquée à nos données

On repart de notre table de données centrées et réduites ("clust_sc") et on lui applique la fonction `kmeans` de `R`. Comme décrit précédemment de manière théorique, il faut : i) choisir le nombre de classes que l'on souhaite avoir avec l'option `centers=k`, ici pour pouvoir comparer avec la méthodes précédente de la CAH, on va choisir le même nombre de groupe, soit 3 ; ii) et réitérer toute la procédure plusieurs fois avec des individus pris au départ qui soient différents, avec l'option `nstart=`, ici on choisit 100 essais, et la fonction prendra le meilleur pour l'algorithme.


```r
row.names(clust) <- clust$IRIS

clust_socioprof_prop <- clust %>% 
  select(c("nbhab", "nbCS_2", "nbCS_3", "nbCS_4", "nbCS_5",  "nbCS_6", "nbCS_7", "nbCS_8", 
                      "Nbactivite_chômeurs", "nbimmi", "nb_Femme")) %>% 
  mutate(pctCS_2 = (nbCS_2 / nbhab)*100,
         pctCS_3 = (nbCS_3 / nbhab)*100,
         pctCS_4 = (nbCS_4 / nbhab)*100,
         pctCS_5 = (nbCS_5 / nbhab)*100,
         pctCS_6 = (nbCS_6 / nbhab)*100,
         pctCS_7 = (nbCS_7 / nbhab)*100,
         pctCS_8 = (nbCS_8 / nbhab)*100,
         pctFemme = (nb_Femme / nbhab)*100,
         pctChomeurs = (Nbactivite_chômeurs / nbhab)*100,
         pctImmi = (nbimmi / nbhab)*100) %>% 
  select(pctFemme, pctCS_2, pctCS_3, pctCS_4, pctCS_5, pctCS_6,
         pctCS_7, pctCS_8, pctChomeurs, pctImmi)

clust.kmeans <- kmeans(clust_socioprof_prop, centers=3, nstart=100)

# On affiche ensuite les résultats principaux : effectif des classes, moyenne des variables actives (centrées réduites), groupes d'affectation des individus, proportion d'inertie expliquée par la partition (ici 56,7%)
clust.kmeans
```

```
K-means clustering with 3 clusters of sizes 100, 24, 66

Cluster means:
  pctFemme  pctCS_2   pctCS_3  pctCS_4   pctCS_5  pctCS_6  pctCS_7  pctCS_8
1 52.62862 2.861446 31.686238 14.64645  9.125054 2.896012 16.22567 22.55147
2 52.79495 1.751692  9.984246 11.18704 17.077413 7.314360 16.77963 35.91226
3 52.70429 2.606143 21.674655 14.46968 12.097088 4.809984 15.10940 29.22998
  pctChomeurs  pctImmi
1    6.150702 16.03616
2    9.575820 28.99049
3    7.123551 20.16349

Clustering vector:
751114101 751114102 751114103 751114104 751114105 751114106 751114107 751114108 
        3         1         1         1         1         1         1         1 
751114109 751114110 751114111 751114112 751114113 751114114 751114115 751114201 
        3         3         2         2         1         1         1         3 
751114202 751114203 751114204 751114205 751114206 751114207 751114208 751114209 
        3         1         1         1         1         1         1         1 
751114210 751114211 751114212 751114213 751114214 751114301 751114302 751114303 
        1         1         1         1         1         3         1         3 
751114304 751114305 751114306 751114307 751114308 751114309 751114310 751114311 
        1         1         3         3         3         1         1         1 
751114312 751114313 751114314 751114315 751114316 751114317 751114318 751114319 
        1         1         1         3         1         1         1         3 
751114320 751114321 751114401 751114402 751114403 751114404 751114405 751114406 
        3         1         1         1         1         1         1         1 
751114407 751114408 751114409 751114410 751114411 751114412 751114413 751124501 
        1         1         1         1         1         1         1         3 
751124502 751124503 751124504 751124505 751124506 751124507 751124508 751124509 
        1         3         1         3         1         1         1         1 
751124510 751124511 751124512 751124513 751124514 751124601 751124602 751124603 
        2         2         1         3         1         1         3         3 
751124604 751124605 751124606 751124608 751124609 751124610 751124611 751124612 
        3         1         3         1         2         1         1         1 
751124613 751124614 751124615 751124616 751124617 751124618 751124619 751124620 
        3         1         1         1         1         1         1         1 
751124621 751124622 751124623 751124624 751124701 751124702 751124703 751124704 
        1         3         1         1         3         3         1         3 
751124705 751124707 751124801 751124802 751124803 751124804 751124805 751124806 
        3         1         1         3         1         1         1         1 
751124807 751124808 751124809 751124810 751124812 751124813 751207701 751207702 
        1         1         1         3         2         3         3         3 
751207703 751207704 751207705 751207706 751207707 751207708 751207709 751207710 
        2         1         3         1         3         2         3         3 
751207711 751207712 751207713 751207714 751207801 751207802 751207803 751207804 
        2         3         3         3         2         3         2         2 
751207805 751207806 751207807 751207808 751207809 751207810 751207811 751207812 
        1         3         1         3         3         3         3         3 
751207813 751207814 751207815 751207816 751207901 751207902 751207903 751207904 
        2         1         3         3         1         3         1         1 
751207905 751207906 751207907 751207908 751207909 751207910 751207911 751207912 
        3         3         3         2         3         2         3         3 
751207913 751207914 751207915 751207916 751208001 751208002 751208003 751208004 
        1         1         1         3         2         1         3         1 
751208005 751208006 751208007 751208008 751208009 751208010 751208011 751208012 
        1         1         2         2         2         2         2         3 
751208013 751208014 751208015 751208016 751208017 751208018 751208019 751208020 
        3         1         1         3         3         3         2         2 
751208021 751208022 751208023 751208024 751208025 751208026 
        2         3         3         3         3         1 

Within cluster sum of squares by cluster:
[1] 7029.971 2280.147 6259.132
 (between_SS / total_SS =  56.7 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      
```

On peut comparer avec les classes obtenues précédemment avec la CAH, simplement en croisant les deux variables de classe :

```r
#correspondance avec les groupes de la CAH
table(classe3_soprof_p, clust.kmeans$cluster) 
```

```
                
classe3_soprof_p  1  2  3
               1  2  0 59
               2 98  0  2
               3  0 24  5
```
On voit ainsi que la classe 2 obtenue avec la CAH (2ème ligne du tableau) coïncide quasi-exactement avec la classe 2 de la méthode des *K-means*, de même la classe A de la CAH est la même que la classe 1 des *K-means* à 2 IRIS près, la classe 3 de la CAH est aussi proche de la classe 3 de la méthode des *K-means* même si 5 IRIS sont présents dans la classe 1 des *K-means*. Autrement dit, on conclut à un changement de classes pour quelques communes (9), mais dans l'ensemble la classification est très proche.


```r
clust_kmeans <- clust.kmeans$cluster %>% as.data.frame() %>% rename("classe3_soprof_n"=".") %>% rownames_to_column("IRIS")

kmeans_map_socioprof_n <- clust_kmeans %>%
  left_join(map_iris, by="IRIS")
kmeans_map_socioprof_n <- st_as_sf(kmeans_map_socioprof_n)
mf_theme("agolalight")
mf_map(kmeans_map_socioprof_n, type="typo", var="classe3_soprof_n", col = "lightyellow", 
       border="gray80", lwd=0.4, pal = c("aquamarine3", "skyblue3", "coral"),
       leg_pos = "bottomleft", leg_title="Cluster")
mf_map(map_arrdt,  type = "base", col = NA, border="gray41",lwd=1,
       add = TRUE)
mf_layout(title = "Quartiers de l'Est parisien découpés selon le cluster obtenu", 
          credits=" ")
```

<img src="Data-Mining_files/figure-html/carto%20kmeans-1.svg" width="672" />


On a vu avec la description de la méthode, que ce qui est difficile ici c'est qu'on choisit nous-mêmes le nombre de classes dans une première étape sans savoir parfois pourquoi. Il faut donc souvent faire varier le nombre de classes de départ (`centers=k`), à ne pas confondre avec les individus centres initiaux de classes (ce que l'on a fait précédemment en indiquant l'option `nstart=100`). A partir d'un exemple de code récupéré sur un document de cours externe ([ici](https://eric.univ-lyon2.fr/~ricco/cours/didacticiels/R/cah_kmeans_avec_r.pdf)), on peut créer une boucle pour répéter la procédure en changeant le nombre de classes, et ensuite construire un graphique visualisant l'indicateur de pourcentage d'inertie expliquée. Plus précisément, on fait tourner plusieurs fois la méthode des K-means sur notre base de données centrées-réduites pour un nombre de classes souhaitées variant entre 2 et 6, et on récupère la part de l'inertie expliquée par la partition obtenue (indicateur `between_SS / total_SS` que l'on a vu dans la sortie précédente). Puis, on crée un graphique représentant cette part pour chacune des partitions construites.

```r
#Boucle pour calculer la part de l'inertie expliquée par la partition, selon le nombre de classes souhaitées
inertie.expl <- rep(0,times=6)
for (k in 2:6){
  clus <- kmeans(clust_socioprof_prop, centers=k, nstart=100)  
  inertie.expl[k] <- clus$betweenss/clus$totss}

#Création du graphique
plot(1:6, inertie.expl, type="b", xlab="Nombre de classes choisies", ylab="Pourcentage d'inertie expliquée par la partition")
```

<img src="Data-Mining_files/figure-html/Compar_clK-means-1.svg" width="672" />
On observe sur ce graphique qu'à partir de k=3, autrement dit de 3 classes, la "création" d'une classe supplémentaire ne semble pas augmenter significativement la part d'inertie expliquée par la partition. Pour comprendre ce que revêt ce "significativement", on peut regarder notamment la pente de chaque droite reliant les points d'une partition à une autre : pour la droite reliant le nombre de classes "2" et "3", on voit que sa pente diminue déjà pas mal par rapport à la droite reliant les deux classes précédentes, et cela est encore plus visible pour les pentes suivantes.

Une autre méthode évoquée par le même document de cours, propose d'utiliser le package `fpc` qui propose une fonction `kmeansruns` évaluant les différentes partitions à partir de 2 critères à choisir : l'indice de Calinski Harabasz - option `criterion="ch"`, ou celui de la "average silhouette width" (largeur moyenne de la silhouette) - option `criterion="asw"`. On peut ensuite construire un graphique comme précédemment pour visualiser l'évolution de cet indice selon le nombre de classes de la partition.

```r
# OU utilisation du package fpc et de l'indice de Calinski Harabasz  
library(fpc)
#Evaluation des solutions
eval.kmeans <- kmeansruns(clust_socioprof_prop,
                         krange=2:6,
                         criterion="ch",)

#Graphique
plot(1:6, eval.kmeans$crit,type="b", xlab="Nombre de classes", ylab="Indice de Calinski Harabasz ")
```

<img src="Data-Mining_files/figure-html/Compar_clK-means_bis-1.svg" width="672" />
Pour lire et choisir le "bon" nombre de classes selon ce critère, il faut maximiser l'indice donc trouver le point le plus haut : ici, c'est la partition à 2 classes qui semble la "meilleure" comme on l'avait vu dans la CAH avec le dendogramme, mais une partition en 3 classes semble plus intéressante pour l'interprétation.-->
<!-- permet d'écrire du texte sans qu'il soit affiché, sorte de commentaires dans le script sans qu'il soit publié dans le doc final ! -->

</div>
</div>
</div>








<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>Plus précisément, à chaque étape d’agrégation, la part de l’inertie interclasse passe en inertie intraclasse.<a href="15-Clustering-application.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<script src="js/tidyverse.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="14-Clustering-theorique.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Camille-Sisi/github.io-Data-Mining/master/15-Clustering-application.Rmd",
"text": "Source"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
